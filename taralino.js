var Animation=new function(){var n=10,r=0,t=null;this.init=function(){var t=1e3;0<arguments.length&&("number"==typeof arguments[0].fps&&(t=arguments[0].fps),"string"==typeof arguments[0].autoplay&&"off"==arguments[0].autoplay&&(r=1)),n=Math.max(10,Math.round(1e3/Math.max(t,.001)))},this.start=function(){"function"==typeof animation_loop&&"function"==typeof loop&&(this.stop(),0<r?r--:t=setInterval(animation_loop,n))},this.stop=function(){null!=t&&(clearInterval(t),t=null)}},Autoencoder=new function(){var z=[],u=[],l=!1,s=[],a=[],f=[];function c(){var t=NeuralNetwork.get_data();z=t.weights,u=t.biases}function e(t,n){for(var r,e=t.length,o=u[n].length,i=new Array(o),a=0;a<o;a++)i[a]=u[n][a];for(a=0;a<o;a++)for(var l=0;l<e;l++)i[a]+=t[l]*z[n][a][l];for(a=0;a<o;a++)i[a]=(r=i[a],1/(1+Math.exp(-r)));return i}function o(t){for(var n=t,r=0;r<s.length-1;r++)n=e(n,r);return n}function i(t,n){for(var r=0,e=0;e<t.length;e++){var o=t[e]-n[e];r+=o*o}return r}this.evaluate=function(t){return 1!=l?GlobalFunctions.set_error("Autoencoder","evaluate","Autoencoder not initialized yet."):arguments.length<1?GlobalFunctions.set_error("Autoencoder","evaluate","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Autoencoder","evaluate","Invalid function argument."):t.length!=s[0]?GlobalFunctions.set_error("Autoencoder","evaluate","Improper dimensions."):o(t)},this.encode=function(t){return 1!=l?GlobalFunctions.set_error("Autoencoder","encode","Autoencoder not initialized yet."):arguments.length<1?GlobalFunctions.set_error("Autoencoder","encode","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Autoencoder","encode","Invalid function argument."):t.length!=a[0]?GlobalFunctions.set_error("Autoencoder","encode","Improper dimensions."):function(t){for(var n=t,r=0;r<a.length-1;r++)n=e(n,r);return n}(t)},this.decode=function(t){return 1!=l?GlobalFunctions.set_error("Autoencoder","decode","Autoencoder not initialized yet."):arguments.length<1?GlobalFunctions.set_error("Autoencoder","decode","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Autoencoder","decode","Invalid function argument."):t.length!=f[0]?GlobalFunctions.set_error("Autoencoder","decode","Improper dimensions."):function(t){for(var n=t,r=a.length-1;r<s.length-1;r++)n=e(n,r);return n}(t)},this.deviation=function(t){return arguments.length<1?GlobalFunctions.set_error("Autoencoder","deviation","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Autoencoder","deviation","Invalid function argument."):t.length!=s[0]?GlobalFunctions.set_error("Autoencoder","deviation","Invalid input length."):i(t,o(t))/t.length},this.init=function(t,n){if(l=!1,arguments.length<2)return GlobalFunctions.set_error("Autoencoder","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Autoencoder","init","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("Autoencoder","init","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("Autoencoder","init","Invalid layout definition.");if(n.length<2)return GlobalFunctions.set_error("Autoencoder","init","Invalid layout definition.");if(t[0]!=n[n.length-1])return GlobalFunctions.set_error("Autoencoder","init","Invalid layout definition.");if(t[t.length-1]!=n[0])return GlobalFunctions.set_error("Autoencoder","init","Invalid layout definition.");a=[],f=[],s=[];for(var r=0;r<t.length;r++)a.push(Math.max(1,Math.round(t[r]))),s.push(Math.max(1,Math.round(t[r])));for(r=0;r<n.length;r++)f.push(Math.max(1,Math.round(n[r]))),0<r&&s.push(Math.max(1,Math.round(n[r])));NeuralNetwork.init(s),c(),l=!0},this.train=function(t){if(1!=l)return GlobalFunctions.set_error("Autoencoder","train","Autoencoder not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Autoencoder","train","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Autoencoder","train","Invalid training data.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Autoencoder","train","Invalid training data.");if(t[0].length!=s[0])return GlobalFunctions.set_error("Autoencoder","train","Invalid training data.");var n=1e3,r=100,e=.5;1<arguments.length&&("number"==typeof arguments[1].iterations&&(n=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(r=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(e=Math.abs(arguments[1].learning_rate)));for(var o=[],i=0;i<t.length;i++)o.push({input:t[i],output:t[i]});NeuralNetwork.train(o,{iterations:n,batch_size:r,learning_rate:e}),c()};var h=[],d=[],g=0,v="",m=0;function b(t){var n="";n+='<div style="display:inline-block;background-color:#f4f4f4;width:300px;padding:10px;">',n+='<div style="background-color:#d4d4d4;">',n+='<div style="height:24px;background-color:#005bca;width:'+t.toFixed(0)+'%;">',n+="</div>",n+="</div>",n+="</div>",document.getElementById(v).innerHTML=n}this.progess_loop=function(){g++;var t=h;NeuralNetwork.train(t[0],{iterations:t[1],batch_size:t[2],learning_rate:t[3]}),c(),d.push([g*t[1],function(t){for(var n=0,r=0;r<t.length;r++){var e=o(t[r].input);n+=i(t[r].input,e)}return 100*n/(t.length*t[0].input.length)}(t[0])]),b(g),100==g&&(clearInterval(m),document.getElementById(v).innerHTML="","function"==typeof on_training_done&&on_training_done(d))},this.progress=function(t){if(1!=l)return GlobalFunctions.set_error("Autoencoder","progress","Autoencoder not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Autoencoder","progress","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Autoencoder","progress","Invalid training data.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Autoencoder","progress","Invalid training data.");if(t[0].length!=s[0])return GlobalFunctions.set_error("Autoencoder","progress","Invalid training data.");var n=1e3,r=100,e=.5;1<arguments.length&&("number"==typeof arguments[1].iterations&&(n=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(r=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(e=Math.abs(arguments[1].learning_rate)));for(var o=[],i=0;i<t.length;i++)o.push({input:t[i],output:t[i]});h=[o,Math.max(1,Math.round(n/100)),r,e],d=[],g=0,v="pid"+(1e10*Math.random()).toFixed(0);var a=document.createElement("div");a.setAttribute("id",v),document.body.appendChild(a),document.getElementById(v).style.textAlign="center",b(0),m=setInterval(this.progess_loop,20)},this.set_data=function(t){return l=!1,arguments.length<1?GlobalFunctions.set_error("Autoencoder","set_data","Invalid number of function arguments."):"object"!=typeof t?GlobalFunctions.set_error("Autoencoder","set_data","Invalid function argument."):"object"!=typeof t.layout_encode||"object"!=typeof t.layout_decode||"object"!=typeof t.weights||"object"!=typeof t.biases?GlobalFunctions.set_error("Autoencoder","set_data","Invalid function argument."):(this.init(t.layout_encode,t.layout_decode),t.layout=s,l=!1,NeuralNetwork.set_data(t),c(),void(l=!0))},this.get_data=function(){return 1!=l?GlobalFunctions.set_error("Autoencoder","get_data","Autoencoder not initialized yet."):{layout_encode:a,layout_decode:f,weights:z,biases:u}},this.export_data=function(){if(1!=l)return GlobalFunctions.set_error("Autoencoder","export_data","Autoencoder not initialized yet.");var t="",n=4;0<arguments.length&&("string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),"number"==typeof arguments[0].digits&&(n=Math.max(0,Math.min(Math.round(arguments[0].digits),12))));var r="var T = {\n";r+="layout_encode:[";for(var e=0;e<a.length;e++)r+=a[e].toFixed(0)+(e<a.length-1?",":"");r+="],\n",r+="layout_decode:[";for(e=0;e<f.length;e++)r+=f[e].toFixed(0)+(e<f.length-1?",":"");r+="],\n",r+="weights:[";for(e=0;e<z.length;e++){r+="[";for(var o=0;o<z[e].length;o++){r+="[";for(var i=0;i<z[e][o].length;i++)r+=z[e][o][i].toFixed(n)+(i<z[e][o].length-1?",":"");r+="]"+(o<z[e].length-1?",":"")}r+="]"+(e<z.length-1?",":"")}r+="],\n",r+="biases:[";for(e=0;e<u.length;e++){r+="[";for(o=0;o<u[e].length;o++)r+=u[e][o].toFixed(n)+(o<u[e].length-1?",":"");r+="]"+(e<u.length-1?",":"")}r+="]\n",r+="};\n",""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(r):document.getElementById(t).value=r}},Autoregression=new function(){var f=!1,c=[],d=[],g=[],l=3;function z(t,n){for(var r=[],e=0;e<t;e++)r.push(e==n?1:0);return r}function u(t){return Math.max(0,Math.min(Math.floor(l*t),l-1))}function s(t,n){for(var r=[],e=0;e<t.length;e++){for(var o=[],i=0;i<n;i++)o.push(t[e][i]);var a=u(t[e][n]);r.push({input:o,output:z(l,a)})}return r}function o(t,n){for(var r=0,e=[],o=0;o<t.length;o++)h=Math.exp(t[o]/n),e.push(h),r+=h;for(o=0;o<t.length;o++)e[o]=e[o]/r;return e}function i(t){for(var n=Math.random(),r=t[0],e=0;r<n&&e<t.length-1;)r+=t[++e];return e/(t.length-1)}this.random=function(){if(1!=f)return GlobalFunctions.set_error("Autoregression","random","Autoregression not initialized yet.");if(d.length!=c[0]-1)return GlobalFunctions.set_error("Autoregression","random","Autoregression not trained yet.");var t=.2;0<arguments.length&&"number"==typeof arguments[0].temperature&&(t=Math.max(1e-6,Math.min(arguments[0].temperature,1e6)));for(var n=[i(g)],r=0;r<d.length;r++){NeuralNetwork.set_data(d[r]);var e=i(o(NeuralNetwork.evaluate(n),t));n.push(e)}return n},this.init=function(t){if(f=!1,arguments.length<1)return GlobalFunctions.set_error("Autoregression","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Autoregression","init","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("Autoregression","init","Length of input vector must be at least 2.");c=[],d=[],g=[];for(var n=0;n<t.length;n++)c.push(Math.max(2,Math.round(t[n])));l=c[t.length-1],f=!0},this.train=function(t){if(1!=f)return GlobalFunctions.set_error("Autoregression","train","Autoregression not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Autoregression","train","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Autoregression","train","Invalid training data.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Autoregression","train","Invalid training data.");if(t[0].length!=c[0])return GlobalFunctions.set_error("Autoregression","train","Invalid training data.");var n=1e3,r=100,e=5;1<arguments.length&&("number"==typeof arguments[1].iterations&&(n=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(r=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(e=Math.abs(arguments[1].learning_rate))),g=function(t){for(var n=[],r=0;r<l;r++)n.push(0);for(var e=0;e<t.length;e++)n[u(t[e][0])]++;for(r=0;r<n.length;r++)n[r]/=t.length;return n}(t);for(var o=[],i=0;i<c.length;i++)o.push(c[i]);d=[];for(i=1;i<t[0].length;i++){var a=s(t,i);o[0]=i,NeuralNetwork.init(o),NeuralNetwork.train(a,{iterations:n,batch_size:r,learning_rate:e}),d.push(NeuralNetwork.get_data())}},this.set_data=function(t){if(f=!1,c=[],d=[],g=[],l=3,arguments.length<1)return GlobalFunctions.set_error("Autoregression","set_data","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Autoregression","set_data","Invalid function argument.");g=(d=t)[0].first,l=t[0].first.length,c=[t.length+1];for(var n=1;n<t[0].layout.length;n++)c.push(t[0].layout[n]);f=!0},this.export_data=function(){if(1!=f)return GlobalFunctions.set_error("Autoregression","export_data","Autoregression not initialized yet.");if(d.length!=c[0]-1)return GlobalFunctions.set_error("Autoregression","export_data","Autoregression not trained yet.");var t="",n=4;0<arguments.length&&("string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),"number"==typeof arguments[0].digits&&(n=Math.max(0,Math.min(Math.round(arguments[0].digits),12))));for(var r="first:[",e=0;e<g.length;e++)r+=(0<e?",":"")+g[e].toFixed(4);r+="],";for(var o="var T = [",i=0;i<d.length;i++){var a=d[i].layout,l=d[i].weights,z=d[i].biases;o+="{\n",0==i&&(o+=r+"\n"),o+="layout:[";for(var u=0;u<a.length;u++)o+=a[u].toFixed(0)+(u<a.length-1?",":"");o+="],\n",o+="weights:[";for(u=0;u<l.length;u++){o+="[";for(e=0;e<l[u].length;e++){o+="[";for(var s=0;s<l[u][e].length;s++)o+=l[u][e][s].toFixed(n)+(s<l[u][e].length-1?",":"");o+="]"+(e<l[u].length-1?",":"")}o+="]"+(u<l.length-1?",":"")}o+="],\n",o+="biases:[";for(u=0;u<z.length;u++){o+="[";for(e=0;e<z[u].length;e++)o+=z[u][e].toFixed(n)+(e<z[u].length-1?",":"");o+="]"+(u<z.length-1?",":"")}o+="]\n",o+="}"+(i<d.length-1?",":"];")}""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(o):document.getElementById(t).value=o}},Button=new function(){var i="";this.add=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Button","add","Invalid number of function arguments.");if(1!=GlobalFunctions.is_string(t)||1!=GlobalFunctions.is_string(n))return GlobalFunctions.set_error("Button","add","Invalid function argument.");if(""==t||""==n)return GlobalFunctions.set_error("Button","add","Invalid function argument.");if(""==i){var r=document.createElement("div");i="button"+(1e10*Math.random()).toFixed(0),r.setAttribute("id",i),document.body.appendChild(r);var e="";e+="#"+i+" { text-align:center; }",e+="#"+i+" a { display:inline-block; text-decoration:none; font-size:14px; font-family:Tahoma,Geneva,sans-serif; background-color:transparent; color:#202020; margin:6px 4px; padding:10px 16px; border-radius:40px; border:2px solid #202020; cursor:pointer; transition:all .2s ease-in-out; -webkit-transition:all .2s ease-in-out; }",e+="#"+i+" a:hover { background-color:#202020; color:#fff; }";var o=document.createElement("style");o.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(o)}document.getElementById(i).innerHTML+="<a href=\"javascript:on_click_event('"+t+"');\">"+n+"</a>"}},Canvas=new function(){var z,y,u=null,s=0,f=0,c=0,h=0,d=0,g=0,v="",M=!1,_=1;function G(t,n){return{x:_*(t-c),y:f-_*(n-d)}}function m(t){return 255==t.rgba[3]?t.hex:"rgba("+t.rgba[0].toFixed(0)+","+t.rgba[1].toFixed(0)+","+t.rgba[2].toFixed(0)+","+t.opacity.toFixed(3)+")"}function l(t){var n=function(t){for(var n=t[0].x,r=t[0].x,e=t[0].y,o=t[0].y,i=1;i<t.length;i++)n=Math.min(n,t[i].x),r=Math.max(r,t[i].x),e=Math.min(e,t[i].y),o=Math.max(o,t[i].y);return{xmin:n,xmax:r,ymin:e,ymax:o}}(t);return{x:(n.xmin+n.xmax)/2,y:(n.ymin+n.ymax)/2}}function b(t){var n=z.getBoundingClientRect(),r=t.clientX-n.left,e=t.clientY-n.top;return{x:c+r/s*(h-c),y:d+(1-e/f)*(g-d)}}function p(){0!=u.opacity&&(y.beginPath(),y.rect(0,0,s,f),y.fillStyle=m(u),y.fill())}function w(t,n){y.save(),y.translate(t.x,t.y),0!=n&&y.rotate(n),y.beginPath()}function I(t,n){0!=t.opacity&&(y.fillStyle=m(t),y.fill()),0!=n.opacity&&(y.strokeStyle=m(n),y.stroke()),y.restore()}this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Canvas","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t)||2!=t.length)return GlobalFunctions.set_error("Canvas","init","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n)||2!=n.length)return GlobalFunctions.set_error("Canvas","init","Invalid function argument.");var r,e=480,o="none",i="on",a="";if(2<arguments.length&&("number"==typeof arguments[2].width&&(e=Math.max(2,Math.round(arguments[2].width))),void 0!==arguments[2].background&&(o=arguments[2].background),"string"==typeof arguments[2].scaling&&(i=arguments[2].scaling),"string"==typeof arguments[2].div&&(a=arguments[2].div)),""==a||1!=GlobalFunctions.is_div(a)){var l=document.createElement("div");""==a&&(a="random-id-"+(1e10*Math.random()).toFixed(0)),l.setAttribute("id",a),document.body.appendChild(l)}v=a,c=Math.min(t[0],t[1]),h=Math.max(t[0],t[1]),d=Math.min(n[0],n[1]),g=Math.max(n[0],n[1]),h<=c&&(h+=1),g<=d&&(g+=1),u=GlobalFunctions.get_color(o),function(t,n){if(s=t,"off"!=n){var r="random-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(v).innerHTML='<div id="'+r+'" style="height:2000px; padding:0; margin:0;"></div>',s=Math.min(t,Math.round(document.getElementById(r).clientWidth))}var e=h-c,o=g-d;f=Math.round(s*(o/e)),_=s/e}(e,i),document.getElementById(v).style.textAlign="center",document.getElementById(v).innerHTML="",r="canvas-id-"+(1e10*Math.random()).toFixed(0),document.getElementById(v).innerHTML='<canvas id="'+r+'" width="'+s+'" height="'+f+'"></canvas>',z=document.getElementById(r),(y=z.getContext("2d")).lineCap="round",y.lineJoin="round",y.lineWidth=2,y.font="14px sans-serif",y.textAlign="center",y.textBaseline="middle",p(),z.addEventListener("mousedown",function(t){if("function"==typeof on_mouse_down){var n=b(t);on_mouse_down(n.x,n.y)}},!1),z.addEventListener("mouseup",function(t){if("function"==typeof on_mouse_up){var n=b(t);on_mouse_up(n.x,n.y)}},!1),z.addEventListener("mousemove",function(t){if("function"==typeof on_mouse_move){var n=b(t);on_mouse_move(n.x,n.y)}},!1),z.addEventListener("mouseenter",function(t){"function"==typeof on_mouse_enter&&on_mouse_enter()},!1),z.addEventListener("mouseleave",function(t){"function"==typeof on_mouse_leave&&on_mouse_leave()},!1),z.addEventListener("touchstart",function(t){if("function"==typeof on_mouse_down){var n=b(t.touches[0]);t.preventDefault(),on_mouse_down(n.x,n.y)}},!1),z.addEventListener("touchend",function(t){if("function"==typeof on_mouse_up){var n=b(t.touches[0]);t.preventDefault(),on_mouse_up(n.x,n.y)}},!1),z.addEventListener("touchmove",function(t){if("function"==typeof on_mouse_move){var n=b(t.touches[0]);t.preventDefault(),on_mouse_move(n.x,n.y)}},!1),M=!0},this.clear=function(){if(1!=M)return GlobalFunctions.set_error("Canvas","clear","Canvas not initialized yet.");y.clearRect(0,0,s,f),p()},this.draw=function(){return GlobalFunctions.set_warning("Canvas","draw","Useless function in Canvas.")},this.is_init_ready=function(){return M},this.circle=function(t,n,r){if(1!=M)return GlobalFunctions.set_error("Canvas","circle","Canvas not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Canvas","circle","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Canvas","circle","Invalid function argument.");var e,o,i,a,l,z,u,s,f,c=GlobalFunctions.get_color("black"),h=GlobalFunctions.get_color("none"),d=0;if(3<arguments.length&&(void 0!==arguments[3].fill&&(c=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(h=GlobalFunctions.get_color(arguments[3].stroke)),"number"==typeof arguments[3].angle&&(d=arguments[3].angle),"string"==typeof arguments[3].sprite&&"object"==typeof Sprites&&"function"==typeof Sprites.get)){var g=Sprites.get(arguments[3].sprite);if("string"!=typeof g)return e=t,o=n,i=r,a=d,z=(l=g).height,u=l.width,s=G(e,o),f=Math.abs(i*_),y.save(),y.translate(s.x,s.y),0!=a&&y.rotate(a),y.drawImage(l,0,0,u,z,-f,-f,2*f,2*f),void y.restore()}if(0!=c.opacity||0!=h.opacity){var v=G(t,n),m=Math.abs(r*_);w(v,d),y.arc(0,0,m,0,2*Math.PI),I(c,h)}},this.dot=function(t,n){if(1!=M)return GlobalFunctions.set_error("Canvas","dot","Canvas not initialized yet.");if(arguments.length<2)return GlobalFunctions.set_error("Canvas","dot","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Canvas","dot","Invalid function argument.");var r=GlobalFunctions.get_color("black"),e=GlobalFunctions.get_color("none");if(2<arguments.length&&(void 0!==arguments[2].fill&&(r=GlobalFunctions.get_color(arguments[2].fill)),void 0!==arguments[2].stroke&&(e=GlobalFunctions.get_color(arguments[2].stroke))),0!=r.opacity||0!=e.opacity){w(G(t,n),0),y.arc(0,0,2.5,0,2*Math.PI),I(r,e)}},this.box=function(t,n,r){if(1!=M)return GlobalFunctions.set_error("Canvas","box","Canvas not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Canvas","box","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Canvas","box","Invalid function argument.");var e,o,i,a,l,z,u,s,f,c=GlobalFunctions.get_color("black"),h=GlobalFunctions.get_color("none"),d=0;if(3<arguments.length&&(void 0!==arguments[3].fill&&(c=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(h=GlobalFunctions.get_color(arguments[3].stroke)),"number"==typeof arguments[3].angle&&(d=arguments[3].angle),"string"==typeof arguments[3].sprite&&"object"==typeof Sprites&&"function"==typeof Sprites.get)){var g=Sprites.get(arguments[3].sprite);if("string"!=typeof g)return e=t,o=n,i=r,a=d,z=(l=g).height,u=l.width,s=G(e,o),f=Math.abs(i*_),y.save(),y.translate(s.x,s.y),0!=a&&y.rotate(a),y.drawImage(l,0,0,u,z,-f/2,-f/2,f,f),void y.restore()}if(0!=c.opacity||0!=h.opacity){var v=G(t,n),m=Math.abs(r*_);w(v,d),y.rect(-m/2,-m/2,m,m),I(c,h)}},this.rect=function(t,n,r,e){if(1!=M)return GlobalFunctions.set_error("Canvas","rect","Canvas not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Canvas","rect","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Canvas","rect","Invalid function argument.");var o,i,a,l,z,u,s,f,c,h,d,g=GlobalFunctions.get_color("black"),v=GlobalFunctions.get_color("none"),m=0;if(4<arguments.length&&(void 0!==arguments[4].fill&&(g=GlobalFunctions.get_color(arguments[4].fill)),void 0!==arguments[4].stroke&&(v=GlobalFunctions.get_color(arguments[4].stroke)),"number"==typeof arguments[4].angle&&(m=arguments[4].angle),"string"==typeof arguments[4].sprite&&"object"==typeof Sprites&&"function"==typeof Sprites.get)){var b=Sprites.get(arguments[4].sprite);if("string"!=typeof b)return o=t,i=n,a=r,l=e,z=m,s=(u=b).height,f=u.width,c=G(o,i),h=Math.abs(a*_),d=Math.abs(l*_),y.save(),y.translate(c.x,c.y),0!=z&&y.rotate(z),y.drawImage(u,0,0,f,s,-h/2,-d/2,h,d),void y.restore()}if(0!=g.opacity||0!=v.opacity){var p=G(t,n),x=Math.abs(r*_),F=Math.abs(e*_);w(p,m),y.rect(-x/2,-F/2,x,F),I(g,v)}},this.line=function(t,n,r,e){if(1!=M)return GlobalFunctions.set_error("Canvas","line","Canvas not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Canvas","line","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Canvas","line","Invalid function argument.");var o=GlobalFunctions.get_color("none"),i=GlobalFunctions.get_color("black");if(4<arguments.length&&void 0!==arguments[4].stroke&&(i=GlobalFunctions.get_color(arguments[4].stroke)),0!=o.opacity||0!=i.opacity){var a=G(t,n),l=G(r,e);w({x:0,y:0},0),y.moveTo(a.x,a.y),y.lineTo(l.x,l.y),I(o,i)}},this.polygon=function(t){if(1!=M)return GlobalFunctions.set_error("Canvas","polygon","Canvas not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Canvas","polygon","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Canvas","polygon","Invalid function argument.");if(t.length<3)return GlobalFunctions.set_error("Canvas","polygon","At least three points required.");if(2!=t[0].length)return GlobalFunctions.set_error("Canvas","polygon","Invalid function argument.");var n=GlobalFunctions.get_color("black"),r=GlobalFunctions.get_color("none"),e=0;if(1<arguments.length&&(void 0!==arguments[1].fill&&(n=GlobalFunctions.get_color(arguments[1].fill)),void 0!==arguments[1].stroke&&(r=GlobalFunctions.get_color(arguments[1].stroke)),"number"==typeof arguments[1].angle&&(e=arguments[1].angle)),0!=n.opacity||0!=r.opacity){for(var o=[],i=0;i<t.length;i++)o.push(G(t[i][0],t[i][1]));var a=l(o);w(a,e),y.moveTo(o[0].x-a.x,o[0].y-a.y);for(i=1;i<t.length;i++)y.lineTo(o[i].x-a.x,o[i].y-a.y);y.closePath(),I(n,r)}},this.polyline=function(t){if(1!=M)return GlobalFunctions.set_error("Canvas","polyline","Canvas not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Canvas","polyline","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Canvas","polyline","Invalid function argument.");if(t.length<3)return GlobalFunctions.set_error("Canvas","polyline","At least three points required.");if(2!=t[0].length)return GlobalFunctions.set_error("Canvas","polyline","Invalid function argument.");var n=GlobalFunctions.get_color("none"),r=GlobalFunctions.get_color("black");if(1<arguments.length&&void 0!==arguments[1].stroke&&(r=GlobalFunctions.get_color(arguments[1].stroke)),0!=n.opacity||0!=r.opacity){w({x:0,y:0},0);var e=G(t[0][0],t[0][1]);y.moveTo(e.x,e.y);for(var o=1;o<t.length;o++)e=G(t[o][0],t[o][1]),y.lineTo(e.x,e.y);I(n,r)}},this.text=function(t,n,r){if(1!=M)return GlobalFunctions.set_error("Canvas","text","Canvas not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Canvas","text","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Canvas","text","Invalid function argument.");if(1!=GlobalFunctions.is_string(r)&&1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Canvas","text","Invalid function argument.");var e=GlobalFunctions.get_color("black"),o=GlobalFunctions.get_color("none"),i=0,a="center";if(3<arguments.length&&(void 0!==arguments[3].fill&&(e=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(o=GlobalFunctions.get_color(arguments[3].stroke)),"number"==typeof arguments[3].angle&&(i=arguments[3].angle),"string"==typeof arguments[3].align&&("left"!=arguments[3].align&&"right"!=arguments[3].align||(a=arguments[3].align))),0!=e.opacity||0!=o.opacity){var l=G(t,n),z=r;1==GlobalFunctions.is_number(r)&&(z=r.toFixed(Math.abs(r-Math.round(r))<1e-8?0:4)),y.save(),y.translate(l.x,l.y),0!=i&&y.rotate(i),y.textAlign=a,0!=e.opacity&&(y.fillStyle=m(e),y.fillText(z,0,0)),0!=o.opacity&&(y.strokeStyle=m(o),y.strokeText(z,0,0)),y.restore()}},this.arrow=function(t,n,r,e){if(1!=M)return GlobalFunctions.set_error("Canvas","arrow","Canvas not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Canvas","arrow","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Canvas","arrow","Invalid function argument.");var o=GlobalFunctions.get_color("none"),i=GlobalFunctions.get_color("black");if(4<arguments.length&&void 0!==arguments[4].stroke&&(i=GlobalFunctions.get_color(arguments[4].stroke)),0!=o.opacity||0!=i.opacity){var a={x:0,y:0},l=G(t,n),z=G(r,e);if(w(a,0),y.moveTo(l.x,l.y),y.lineTo(z.x,z.y),I(o,i),!((z.x-l.x)*(z.x-l.x)+(z.y-l.y)*(z.y-l.y)<1)){var u=Math.atan2(l.y-z.y,z.x-l.x),s=30*Math.cos(u),f=30*Math.sin(u),c=[];c.push({x:z.x+35*Math.cos(u)-s,y:z.y-35*Math.sin(u)+f}),c.push({x:z.x+25*Math.cos(u+.15)-s,y:z.y-25*Math.sin(u+.15)+f}),c.push({x:z.x+28*Math.cos(u)-s,y:z.y-28*Math.sin(u)+f}),c.push({x:z.x+25*Math.cos(u-.15)-s,y:z.y-25*Math.sin(u-.15)+f}),w(a,0),y.moveTo(c[0].x,c[0].y);for(var h=1;h<c.length;h++)y.lineTo(c[h].x,c[h].y);y.closePath(),I(i,i)}}}},Chart=new function(){var z=!1,b=0,p=0,x="",o="",F="",g=null,i="",y=0,M=[];function u(t){for(var n=t[0],r=t[0],e=t[0],o=[t[0]],i=1;i<t.length;i++)n=Math.min(n,t[i]),r=Math.max(r,t[i]),e+=t[i],o.push(t[i]);var a=[];if(0<e)for(i=0;i<t.length;i++)a.push(t[i]/e);var l=[];for(i=0;i<a.length;i++)l.push(a[i]+(0<i?l[i-1]:0));return{min:n,max:r,sum:e,raw:o,rate:a,part:l}}function _(){return 0==g.opacity?"":'<rect x="0" y="0" width="'+b.toFixed(0)+'" height="'+p.toFixed(0)+'" style="fill:'+g.hex+'; stroke:none;" />'}function s(t,n,r,e){var o=b.toFixed(0),i=p.toFixed(0),a='<svg viewBox="0 0 '+o+" "+i+'" style="width:'+o+"px; height:"+i+'px;" xmlns="http://www.w3.org/2000/svg">';a+=_();var l=function(t,n,r){var e=t.min,o=t.max;o<=e&&(e--,o++);var i=(o-e)/n;e-=.25*i,o+=.25*i,r[0]<r[1]&&(e=r[0],o=r[1]),i=(o-e)/n;for(var a=[],l=0;l<=n;l++)a.push(e+l*i);var z=[];for(l=0;l<n;l++)z.push(0);for(var u=0;u<t.raw.length;u++){var s=Math.floor((t.raw[u]-e)/i);0<=s&&s<z.length&&z[s]++}var f=0;for(l=0;l<n;l++)f=Math.max(f,z[l]);return{L:a,T:z,max:f,sum:t.raw.length}}(t,n,r),z=Math.min(40,.2*Math.min(b,p)),u=(b-2*z)/n,s=p-2*z,f=Math.min(1,.1*u);if(0<l.max)for(var c=0;c<n;c++){var h=z+c*u,d=Math.max(1,s*(l.T[c]/l.max));if(a+='<rect x="'+(h+f).toFixed(3)+'" y="'+(p-d-z-6).toFixed(3)+'" width="'+(u-2*f).toFixed(3)+'" height="'+d.toFixed(3)+'" style="fill:'+GlobalFunctions.get_color(M[0]).hex+'; stroke:none;" />',"none"!=e){var g="relative"==e?(l.T[c]/l.sum*100).toFixed(1)+"%":l.T[c].toFixed(0);a+='<text x="'+(h+u/2).toFixed(0)+'" y="'+(p-d-z-12).toFixed(0)+'" style="'+F+' text-anchor:middle;fill:#000000;stroke:none;">'+g+"</text>"}}if("none"!=e){var v=p-z,m=Math.max(1,Math.floor(75/u));a+='<line x1="'+z.toFixed(3)+'" y1="'+(v+2).toFixed(3)+'" x2="'+(b-z).toFixed(3)+'" y2="'+(v+2).toFixed(3)+'" style="stroke:#000000;stroke-width:2.0;stroke-linecap:round;" />';for(c=0;c<l.L.length;c++){h=z+c*u,g=l.L[c].toFixed(y);c%m==0&&(a+='<text x="'+h.toFixed(0)+'" y="'+(v+26).toFixed(0)+'" style="'+F+' text-anchor:middle;fill:#000000;stroke:none;">'+g+"</text>"),a+='<line x1="'+h.toFixed(3)+'" y1="'+(v+2).toFixed(3)+'" x2="'+h.toFixed(3)+'" y2="'+(v+10).toFixed(3)+'" style="stroke:#000000;stroke-width:2.0;stroke-linecap:round;" />'}}x=a+="</svg>"}this.svg=function(){if(1!=z)return GlobalFunctions.set_error("Chart","svg","Chart not initialized yet.");if(""==x)return GlobalFunctions.set_error("Chart","svg","No data defined before.");var t="";0<arguments.length&&"string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(x):document.getElementById(t).value=x},this.draw=function(){return 1!=z?GlobalFunctions.set_error("Chart","draw","Chart not initialized yet."):""==x?GlobalFunctions.set_error("Chart","draw","No data defined before."):void(document.getElementById(o).innerHTML=x)},this.histogram=function(t){if(1!=z)return GlobalFunctions.set_error("Chart","histogram","Chart not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Chart","histogram","Invalid number of function arguments.");var n=[];if(1==GlobalFunctions.is_vector(t))for(var r=0;r<t.length;r++)n.push(t[r]);if(0==n.length)return GlobalFunctions.set_error("Chart","histogram","Invalid function argument.");var e=u(n),o=10,i="absolute",a=[1,0];if(1<arguments.length&&("number"==typeof arguments[1].bins&&(o=Math.max(2,Math.min(Math.round(arguments[1].bins),128))),"string"==typeof arguments[1].label&&(i=arguments[1].label),"object"==typeof arguments[1].range)){var l=arguments[1].range;1==GlobalFunctions.is_vector(l)&&2==l.length&&(a=[Math.min(l[0],l[1]),Math.max(l[0],l[1])])}s(e,o,a,i)},this.pie=function(t){if(1!=z)return GlobalFunctions.set_error("Chart","pie","Chart not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Chart","pie","Invalid number of function arguments.");var n=[];if(1==GlobalFunctions.is_vector(t))for(var r=0;r<t.length;r++)n.push(t[r]);if(0==n.length)return GlobalFunctions.set_error("Chart","pie","Invalid function argument.");var e=u(n);if(e.min<0||e.sum<=0)return GlobalFunctions.set_error("Chart","pie","Negative data not allowed.");var o="circle",i="data";1<arguments.length&&("string"==typeof arguments[1].style&&(o=arguments[1].style),"string"==typeof arguments[1].label&&(i=arguments[1].label)),function(t,n,r){var e=b.toFixed(0),o=p.toFixed(0),i='<svg viewBox="0 0 '+e+" "+o+'" style="width:'+e+"px; height:"+o+'px;" xmlns="http://www.w3.org/2000/svg">';i+=_();for(var a=[b/2,p/2],l=.4*Math.min(b,p),z=0,u=0;u<t.part.length;u++){for(i+='<polygon points="'+a[0].toFixed(3)+","+a[1].toFixed(3)+" ";i+=(a[0]+l*Math.sin(2*Math.PI*z)).toFixed(3)+","+(a[1]-l*Math.cos(2*Math.PI*z)).toFixed(3)+" ",(z+=.01)<t.part[u];);z=t.part[u],i+=(a[0]+l*Math.sin(2*Math.PI*z)).toFixed(3)+","+(a[1]-l*Math.cos(2*Math.PI*z)).toFixed(3)+'"',i+=' style="fill:'+GlobalFunctions.get_color(M[u%M.length]).hex+'; stroke:none;" />'}if("none"!=n){var s=.3*Math.min(b,p);for(u=0;u<t.part.length;u++){var f=t.rate[u]/2+(0<u?t.part[u-1]:0),c=[a[0]+s*Math.sin(2*Math.PI*f),a[1]-s*Math.cos(2*Math.PI*f)],h="rate"==n?(100*t.rate[u]).toFixed(y)+"%":t.raw[u].toFixed(y);i+='<text x="'+c[0].toFixed(0)+'" y="'+c[1].toFixed(0)+'" style="'+F+' text-anchor:middle; fill:#ffffff; stroke:none;">'+h+"</text>"}}if("donut"==r||"doughnut"==r){s=.2*Math.min(b,p);var d=0!=g.opacity?g.hex:"#ffffff";i+='<circle cx="'+a[0].toFixed(3)+'" cy="'+a[1].toFixed(3)+'" r="'+s.toFixed(3)+'" style="fill:'+d+'; stroke:none;" />'}x=i+="</svg>"}(e,i,o)},this.bar=function(t){if(1!=z)return GlobalFunctions.set_error("Chart","bar","Chart not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Chart","bar","Invalid number of function arguments.");var n=[];if(1==GlobalFunctions.is_vector(t))for(var r=0;r<t.length;r++)n.push(t[r]);if(0==n.length)return GlobalFunctions.set_error("Chart","bar","Invalid function argument.");var e=u(n);if(e.min<0||e.sum<=0)return GlobalFunctions.set_error("Chart","bar","Negative data not allowed.");var o="multi",i="data";1<arguments.length&&("string"==typeof arguments[1].style&&(o=arguments[1].style),"string"==typeof arguments[1].label&&(i=arguments[1].label)),"single"==o?function(t,n){var r=b.toFixed(0),e=p.toFixed(0),o='<svg viewBox="0 0 '+r+" "+e+'" style="width:'+r+"px; height:"+e+'px;" xmlns="http://www.w3.org/2000/svg">';o+=_();for(var i=.08*b,a=.84*b,l=.3*p,z=.4*p,u=0;u<t.rate.length;u++){var s=a*t.rate[u];o+='<rect x="'+i.toFixed(3)+'" y="'+l.toFixed(3)+'" width="'+s.toFixed(3)+'" height="'+z.toFixed(3)+'" style="fill:'+GlobalFunctions.get_color(M[u%M.length]).hex+'; stroke:none;" />',i+=s}if("none"!=n)for(i=.08*b,u=0;u<t.rate.length;u++){s=a*t.rate[u];var f="rate"==n?(100*t.rate[u]).toFixed(y)+"%":t.raw[u].toFixed(y);o+='<text x="'+(i+s/2).toFixed(0)+'" y="'+(l+z+20).toFixed(0)+'" style="'+F+' text-anchor:middle; fill:#000000; stroke:none;">'+f+"</text>",i+=s}x=o+="</svg>"}(e,i):function(t,n){var r=b.toFixed(0),e=p.toFixed(0),o='<svg viewBox="0 0 '+r+" "+e+'" style="width:'+r+"px; height:"+e+'px;" xmlns="http://www.w3.org/2000/svg">';o+=_();for(var i=b/(2*t.raw.length+1),a=.76*p,l=.86*p,z=0;z<t.raw.length;z++){var u=(2*z+1)*i,s=t.raw[z]/t.max*a;o+='<rect x="'+u.toFixed(3)+'" y="'+(l-s).toFixed(3)+'" width="'+i.toFixed(3)+'" height="'+s.toFixed(3)+'" style="fill:'+GlobalFunctions.get_color(M[z%M.length]).hex+'; stroke:none;" />'}if("none"!=n)for(z=0;z<t.raw.length;z++){u=(2*z+1.5)*i;var f="rate"==n?(100*t.rate[z]).toFixed(y)+"%":t.raw[z].toFixed(y);o+='<text x="'+u.toFixed(0)+'" y="'+(l+20).toFixed(0)+'" style="'+F+' text-anchor:middle; fill:#000000; stroke:none;">'+f+"</text>"}x=o+="</svg>"}(e,i)},this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Chart","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Chart","init","Invalid function argument.");if(o="",F="font-size:14px; font-family:sans-serif;",g=GlobalFunctions.get_color("#f6f6f6"),i="on",y=1,M=["blue","red","yellow","green","orange"],2<arguments.length&&("string"==typeof arguments[2].div&&(o=arguments[2].div),"string"==typeof arguments[2].font&&(F=arguments[2].font),void 0!==arguments[2].background&&(g=GlobalFunctions.get_color(arguments[2].background)),"string"==typeof arguments[2].scaling&&(i=arguments[2].scaling),"number"==typeof arguments[2].digits&&(y=Math.max(0,Math.min(Math.round(arguments[2].digits),12))),void 0!==arguments[2].color))if("object"==typeof arguments[2].color&&0<arguments[2].color.length){M=[];for(var r=0;r<arguments[2].color.length;r++)M.push(arguments[2].color[r])}else M=[arguments[2].color];if(""==o||1!=GlobalFunctions.is_div(o)){var e=document.createElement("div");""==o&&(o="random-id-"+(1e10*Math.random()).toFixed(0)),e.setAttribute("id",o),document.body.appendChild(e)}document.getElementById(o).style.textAlign="center",document.getElementById(o).innerHTML="",function(t,n){if(b=Math.max(100,Math.round(t)),p=Math.max(100,Math.round(n)),"off"!=i){var r="random-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(o).innerHTML='<div id="'+r+'" style="height:2000px; padding:0; margin:0;"></div>',b=Math.max(100,Math.min(Math.round(t),Math.round(document.getElementById(r).clientWidth))),p=Math.max(100,Math.round(b*(n/Math.max(1,t)))),document.getElementById(o).innerHTML=""}}(t,n),z=!(x="")}},ClassificationData=new function(){var c=["red","green","blue","yellow","orange","magenta","violet","indigo","cyan","pink"];function l(t,n,r,e){return e<=t?0:n<=e?r-1:Math.floor(r*((e-t)/(n-t)))}function i(t,n,r){return l(-3.1416,3.1416,r,Math.atan2(n-.5,t-.5))}function a(t,n,r){return l(0,.68,r,Math.sqrt((t-.5)*(t-.5)+(n-.5)*(n-.5)))}function z(t,n,r){for(var e=[[.1,.6],[.2,.2],[.4,.7],[.5,.2],[.7,.8],[.8,.4]],o=[-5,4,2,-5,-4,3],i=0,a=0;a<e.length;a++)i+=o[a]*Math.exp(-20*(t-e[a][0])*(t-e[a][0])-20*(n-e[a][1])*(n-e[a][1]));return l(-4,3,r,i)}function u(t,n,r,e){for(var o=[],i=0;i<t;i++){for(var a=[Math.random(),Math.random()],l=2*Math.PI*Math.random(),z=.5*r*Math.random(),u=e(a[0]+z*Math.cos(l),a[1]+z*Math.sin(l),n),s=[],f=0;f<n;f++)s.push(0);s[u]=1,o.push({input:a,index:u,output:s,color:c[u]})}return o}this.get=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClassificationData","get","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("ClassificationData","get","Invalid function argument.");var n=Math.max(2,Math.round(t)),r=2,e="linear",o=0;return 1<arguments.length&&("number"==typeof arguments[1].categories&&(r=Math.max(2,Math.min(Math.round(arguments[1].categories),10))),"string"==typeof arguments[1].shape&&(e=arguments[1].shape),"number"==typeof arguments[1].noise&&(o=Math.max(0,Math.min(arguments[1].noise,1))),"number"==typeof arguments[1].output_length&&(r=Math.max(2,Math.min(Math.round(arguments[1].output_length),10)))),u(n,r,o,"mixed"==e?z:"circle"==e?a:i)}},ClusterAnalysis=new function(){var c=[],h=2;function v(t,n){return 1==h?function(t,n){for(var r=0,e=0;e<t.length;e++)r+=Math.abs(c[e]*(t[e]-n[e]));return r}(t,n):-1==h?function(t,n){for(var r=Math.abs(c[0]*(t[0]-n[0])),e=1;e<t.length;e++)r=Math.max(r,Math.abs(c[e]*(t[e]-n[e])));return r}(t,n):-2==h?function(t,n){for(var r=[0,0,0],e=0;e<t.length;e++)r[0]+=c[e]*t[e]*n[e],r[1]+=c[e]*t[e]*t[e],r[2]+=c[e]*n[e]*n[e];return 0==r[1]&&0==r[2]?0:0==r[1]||0==r[2]?1:1-r[0]*r[0]/(r[1]*r[2])}(t,n):function(t,n){for(var r=0,e=0;e<t.length;e++){var o=t[e]-n[e];r+=c[e]*o*o}return Math.sqrt(r)}(t,n)}function d(t){for(var n=t.length,r=t[0].length,e=[],o=[],i=[],a=0;a<r;a++)e.push(t[0][a]),o.push(t[0][a]);for(var l=1;l<n;l++){for(a=0;a<r;a++)e[a]=Math.min(e[a],t[l][a]);for(a=0;a<r;a++)o[a]=Math.max(o[a],t[l][a])}for(a=0;a<r;a++)o[a]-e[a]<1e-12&&(o[a]=1,e[a]=0);for(l=0;l<n;l++){i.push([]);for(a=0;a<r;a++)i[l].push((t[l][a]-e[a])/(o[a]-e[a]))}return i}function m(t){for(var n=function(t){for(var n=[],r=0;r<t;r++){n.push([]);for(var e=0;e<t;e++)n[r].push(0)}return n}(t.length),r=0;r<n.length-1;r++)for(var e=r+1;e<n.length;e++)n[r][e]=v(t[r],t[e]),n[e][r]=n[r][e];return n}function b(t,n){for(var r=[],e=0;e<t.length;e++)r.push(t[e]);for(e=0;e<n.length;e++)r.push(n[e]);r.sort(function(t,n){return t-n});for(var o=r.length-1;0<o;o--)r[o-1]==r[o]&&r.splice(o,1);return r}function p(t,n){for(var r=t.length,e=[],o=0;o<r;o++){for(var i=[],a=0;a<r;a++)i.push(t[o][a]);i.sort(function(t,n){return t-n}),e.push(i[n-1])}return e.sort(function(t,n){return n-t}),e}function g(t,n,r){for(var e=t.length,o=t[0].length,i=[],a=0,l=1,z=[],u=function(t){for(var n=[],r=0;r<t;r++)n.push(r);for(var e=0;e<t;e++){var o=Math.floor(t*Math.random()),i=n[e];n[e]=n[o],n[o]=i}return n}(e),s=0;s<n;s++){z.push([]);for(var f=0;f<o;f++)z[s].push(t[u[s]][f])}for(;a<r&&1e-8<l;){i=[];for(s=0;s<e;s++){for(var c=[],h=0;h<n;h++)c.push([h,v(t[s],z[h])]);c.sort(function(t,n){return t[1]-n[1]}),i.push(c[0][0])}var d=[];for(s=0;s<n;s++){d.push([]);for(f=0;f<o;f++)d[s].push(0)}for(c=[],f=0;f<n;f++)c.push(0);for(s=0;s<e;s++){for(f=0;f<o;f++)d[i[s]][f]+=t[s][f];c[i[s]]++}for(s=0;s<n;s++)for(f=0;f<o;f++)0!=c[s]&&(d[s][f]/=c[s]);for(s=l=0;s<n;s++)l+=v(d[s],z[s]);z=d,a++}var g=0;for(s=0;s<e;s++){for(c=[],h=0;h<n;h++)c.push(v(t[s],z[h]));c.sort(function(t,n){return t-n}),g+=c[0]}return{b:i,wcss:g}}this.kmeans=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("ClusterAnalysis","kmeans","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ClusterAnalysis","kmeans","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("ClusterAnalysis","kmeans","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("ClusterAnalysis","kmeans","Insufficient data. At least two objects needed.");var r=Math.max(1,Math.min(Math.round(n),t.length)),e=10,o=100;h=2,c=[];for(var i=0;i<t[0].length;i++)c.push(1);if(2<arguments.length&&("number"==typeof arguments[2].maximal_iterations&&(o=Math.max(1,Math.round(arguments[2].maximal_iterations))),"number"==typeof arguments[2].runs&&(e=Math.max(1,Math.round(arguments[2].runs))),"string"==typeof arguments[2].metric&&("manhattan"==arguments[2].metric.trim().toLowerCase()&&(h=1),"maximum"==arguments[2].metric.trim().toLowerCase()&&(h=-1),"cosine"==arguments[2].metric.trim().toLowerCase()&&(h=-2)),"object"==typeof arguments[2].weights&&1==GlobalFunctions.is_vector(arguments[2].weights)&&arguments[2].weights.length==c.length))for(i=0;i<c.length;i++)c[i]=Math.abs(arguments[2].weights[i]);t=d(t);for(var a=new Array(t.length),l=1e12,z=0;z<e;z++){var u=g(t,r,o);if(u.wcss<l){l=u.wcss;for(i=0;i<t.length;i++)a[i]=u.b[i]}}return a},this.elbow=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("ClusterAnalysis","elbow","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ClusterAnalysis","elbow","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("ClusterAnalysis","elbow","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("ClusterAnalysis","elbow","Insufficient data. At least two objects needed.");var r=Math.max(1,Math.min(Math.round(n),t.length)),e=10,o=100;h=2,c=[];for(var i=0;i<t[0].length;i++)c.push(1);if(2<arguments.length&&("number"==typeof arguments[2].maximal_iterations&&(o=Math.max(1,Math.round(arguments[2].maximal_iterations))),"number"==typeof arguments[2].runs&&(e=Math.max(1,Math.round(arguments[2].runs))),"string"==typeof arguments[2].metric&&("manhattan"==arguments[2].metric.trim().toLowerCase()&&(h=1),"maximum"==arguments[2].metric.trim().toLowerCase()&&(h=-1),"cosine"==arguments[2].metric.trim().toLowerCase()&&(h=-2)),"object"==typeof arguments[2].weights&&1==GlobalFunctions.is_vector(arguments[2].weights)&&arguments[2].weights.length==c.length))for(i=0;i<c.length;i++)c[i]=Math.abs(arguments[2].weights[i]);t=d(t);var a=[],l=[],z=0;for(n=1;n<=r;n++){for(var u=1e12,s=0;s<e;s++){var f=g(t,n,o);u=Math.min(u,f.wcss)}a.push([n,u]),l.push(u),z=Math.max(z,u)}if(0<z)for(i=0;i<a.length;i++)a[i][1]/=z;return Plot.init(560,320,{axis:["relative WCSS","number of clusters"]}),Plot.list(a,{style:"joined"}),Plot.draw(),l},this.dbscan=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClusterAnalysis","dbscan","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ClusterAnalysis","dbscan","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("ClusterAnalysis","dbscan","Insufficient data. At least two objects needed.");var n=-1,r=5;h=2,c=[];for(var e=0;e<t[0].length;e++)c.push(1);if(1<arguments.length&&("number"==typeof arguments[1].radius&&(n=arguments[1].radius),"number"==typeof arguments[1].samples&&(r=Math.max(2,Math.min(Math.round(arguments[1].samples),t.length))),"string"==typeof arguments[1].metric&&("manhattan"==arguments[1].metric.trim().toLowerCase()&&(h=1),"maximum"==arguments[1].metric.trim().toLowerCase()&&(h=-1),"cosine"==arguments[1].metric.trim().toLowerCase()&&(h=-2)),"object"==typeof arguments[1].weights&&1==GlobalFunctions.is_vector(arguments[1].weights)&&arguments[1].weights.length==c.length))for(e=0;e<c.length;e++)c[e]=Math.abs(arguments[1].weights[e]);return function(t,n,o){var e=m(t),i=t.length,a=n;if(a<=0){var r=p(e,o);a=r[Math.floor(.05*i)]}for(var l=[],z=0;z<i;z++)l.push(-2);var u=-1;function s(t){for(var n=[],r=0;r<i;r++)e[t][r]<a&&n.push(r);return n}function f(t){for(var n=-1,r=0;r<t.length;r++)l[t[r]]<0&&(n=t[r]);return n}function c(t){for(var n=b(t,[]),r=f(n);0<=r;){if(-2==l[r]){var e=s(r);e.length>=o&&(n=b(n,e))}l[r]=u,r=f(n)}}for(z=0;z<i;z++)if(!(-2<l[z])){l[z]=-1;var h=s(z);h.length<o||(u++,l[z]=u,c(h))}if(u<0)for(z=0;z<i;z++)l[z]=0;for(z=0;z<i;z++)if(!(0<=l[z])){for(var d=-1,g=1e12,v=0;v<i;v++)v!=z&&0<=l[v]&&e[z][v]<g&&(d=v,g=e[z][v]);l[z]=l[d]}return l}(t,n,r)},this.radius=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClusterAnalysis","radius","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ClusterAnalysis","radius","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("ClusterAnalysis","radius","Insufficient data. At least two objects needed.");var n=5;h=2,c=[];for(var r=0;r<t[0].length;r++)c.push(1);if(1<arguments.length&&("number"==typeof arguments[1].samples&&(n=Math.max(2,Math.min(Math.round(arguments[1].samples),t.length))),"string"==typeof arguments[1].metric&&("manhattan"==arguments[1].metric.trim().toLowerCase()&&(h=1),"maximum"==arguments[1].metric.trim().toLowerCase()&&(h=-1),"cosine"==arguments[1].metric.trim().toLowerCase()&&(h=-2)),"object"==typeof arguments[1].weights&&1==GlobalFunctions.is_vector(arguments[1].weights)&&arguments[1].weights.length==c.length))for(r=0;r<c.length;r++)c[r]=Math.abs(arguments[1].weights[r]);for(var e=p(m(t),n),o=0;o<e.length;o++)e[o]=[e[o],o];Plot.init(560,320,{axis:["sorted object index","distance of "+n.toFixed(0)+"-nearest neighbor"]}),Plot.list(e,{style:"line"}),Plot.draw()}},ClusteringData=new function(){var m=[[4,6],[7,2.5],[7.5,6.2],[2.5,2.4],[5.6,8.2],[5.5,4.4],[2.1,5.6],[3.5,8.1],[3.5,3.9],[4.9,2.2]],b=[4.5,2.5,3.5,4.2,2.1,5.6,1.8,2,3.1,2.6],p=[.7,-1.2,-1,.3,1.3,-.3,-.6,.5,.6,1.2];this.get=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClusteringData","get","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("ClusteringData","get","Invalid function argument.");var n=Math.max(2,Math.round(t)),r=2,e=1,o=.5;1<arguments.length&&("number"==typeof arguments[1].clusters&&(r=Math.max(2,Math.min(Math.round(arguments[1].clusters),10))),"number"==typeof arguments[1].shape&&(e=Math.max(.1,Math.min(arguments[1].shape,1))),"number"==typeof arguments[1].radius&&(o=Math.max(.1,Math.min(arguments[1].radius,1))));for(var i,a,l,z,u,s,f,c,h,d,g=[],v=0;v<n;v++)g.push((i=Math.floor(Math.random()*r),a=e,l=o,void 0,z=m[i][0],u=m[i][1],s=a,f=p[i],c=Math.pow(Math.random(),2)*b[i]*l,h=2*Math.PI*Math.random(),d=[s*c*Math.cos(h),1*c*Math.sin(h)],[z+Math.cos(f)*d[0]-Math.sin(f)*d[1],u+Math.sin(f)*d[0]+Math.cos(f)*d[1]]));return g},this.circles=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClusteringData","circles","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("ClusteringData","circles","Invalid function argument.");var n=Math.max(2,Math.round(t)),r=0;1<arguments.length&&"number"==typeof arguments[1].noise&&(r=Math.max(0,Math.min(arguments[1].noise,1)));for(var e=[],o=0;o<n;o++){var i=[5,5],a=2*Math.PI*Math.random(),l=(Math.random()<.3?1.4:3.6)+(Math.random()<.5?1:-1)*Math.pow(.05+(.8+.3*r)*Math.random(),2);i[0]+=l*Math.cos(a),i[1]+=l*Math.sin(a),e.push(i)}return e},this.moons=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ClusteringData","moons","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("ClusteringData","moons","Invalid function argument.");var n=Math.max(2,Math.round(t)),r=0;1<arguments.length&&"number"==typeof arguments[1].noise&&(r=Math.max(0,Math.min(arguments[1].noise,1)));for(var e=[],o=0;o<n;o++){var i=[1.5,4.6],a=2*Math.PI*Math.random();i[0]+=1.5*a,i[1]+=4.2*Math.sin(a),a>Math.PI&&(i[0]-=2.4,i[1]+=1);var l=2*Math.PI*Math.random(),z=(.6+1.4*r)*Math.random();i[0]+=z*Math.cos(l),i[1]+=z*Math.sin(l),e.push([i[1],i[0]])}return e}},ComputationalGeometry=new function(){var y=1e-6;function b(t,n){for(var r=t.length,e=[],o=0;o<r;o++)e.push([t[o][0],t[o][1]]);e.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(var i=0;i<r-1;i++)for(var a=i+1;a<r&&Math.abs(e[i][0]-e[a][0])<n;){if(Math.abs(e[i][1]-e[a][1])<n)return!1;a++}return!0}function v(t,n,r,e){var o,i,a,l,z,u,s,f,c=t[n][0],h=t[n][1],d=t[r][0],g=t[r][1],v=t[e][0],m=t[e][1],b=Math.abs(h-g),p=Math.abs(g-m);if(b<y&&p<y)return"Unexpected failure, coincident data points.";i=b<y?(l=-(v-d)/(m-g))*((o=(d+c)/2)-(u=(d+v)/2))+(f=(g+m)/2):p<y?(a=-(d-c)/(g-h))*((o=(v+d)/2)-(z=(c+d)/2))+(s=(h+g)/2):(o=((a=-(d-c)/(g-h))*(z=(c+d)/2)-(l=-(v-d)/(m-g))*(u=(d+v)/2)+(f=(g+m)/2)-(s=(h+g)/2))/(a-l),p<b?a*(o-z)+s:l*(o-u)+f);var x=d-o,F=g-i;return{i:n,j:r,k:e,x:o,y:i,r:x*x+F*F}}function m(t){for(var n=t.length;0<n;)for(var r=t[--n],e=t[--n],o=n;0<o;){var i=t[--o],a=t[--o];if(e==a&&r==i||e==i&&r==a){t.splice(n,2),t.splice(o,2),n-=2;break}}}function p(t){for(var r=function(t){for(var n=[t[0][0],t[0][0]],r=[t[0][1],t[0][1]],e=1;e<t.length;e++)n[0]=Math.min(n[0],t[e][0]),n[1]=Math.max(n[1],t[e][0]),r[0]=Math.min(r[0],t[e][1]),r[1]=Math.max(r[1],t[e][1]);var o=n[1]-n[0],i=r[1]-r[0],a=Math.max(o,i);a<=0&&(a=1);var l=1024/a,z=[];for(e=0;e<t.length;e++)z.push([l*(t[e][0]-n[0]),l*(t[e][1]-r[0])]);return z}(t),n=r.length,e=new Array(n),o=0;o<n;o++)e[o]=o;e.sort(function(t,n){return r[n][0]-r[t][0]}),r.push([-19968,-512]),r.push([512,20992]),r.push([20992,-512]);var i=[v(r,n,n+1,n+2)],a=[];for(o=0;o<n;o++){for(var l=[],z=e[o],u=i.length-1;0<=u;u--){var s=r[z][0]-i[u].x;if(0<s&&s*s>i[u].r)a.push(i[u]),i.splice(u,1);else{var f=r[z][1]-i[u].y;s*s+f*f-i[u].r>y||(l.push(i[u].i,i[u].j,i[u].j,i[u].k,i[u].k,i[u].i),i.splice(u,1))}}m(l);for(u=0;u<l.length;u+=2){var c=l[u],h=l[u+1],d=v(r,h,c,z);if("string"==typeof d)return d;i.push(d)}}for(o=0;o<i.length;o++)a.push(i[o]);var g=[];for(o=0;o<a.length;o++)a[o].i<n&&a[o].j<n&&a[o].k<n&&g.push([a[o].i,a[o].j,a[o].k]);return g}this.random_points=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ComputationalGeometry","random_points","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("ComputationalGeometry","random_points","Invalid function argument.");for(var n=Math.max(3,Math.round(t)),r=[],e=0,o=0;e<n;){var i=4.2*Math.sqrt(o+.5),a=[.1*i*Math.cos(i),.1*i*Math.sin(i)];Math.random()<.2&&(r.push([a[0],a[1]]),e++),o++}return function(t){var n=t[t.length-1],r=Math.sqrt(n[0]*n[0]+n[1]*n[1]);r*=1+Math.max(.1,1/r);for(var e=[],o=0;o<t.length;o++)e.push([100*(t[o][0]+r)/(2*r),100*(t[o][1]+r)/(2*r)]);return e}(r)},this.is_distinct=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ComputationalGeometry","is_distinct","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ComputationalGeometry","is_distinct","Invalid function argument.");if(t.length<2||2!=t[0].length)return GlobalFunctions.set_error("ComputationalGeometry","is_distinct","Invalid function argument.");var n=1e-6;return 1<arguments.length&&"number"==typeof arguments[1].accuracy&&(n=Math.max(1e-12,arguments[1].accuracy)),b(t,n)},this.make_distinct=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ComputationalGeometry","make_distinct","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ComputationalGeometry","make_distinct","Invalid function argument.");if(t.length<2||2!=t[0].length)return GlobalFunctions.set_error("ComputationalGeometry","make_distinct","Invalid function argument.");var n=1e-6;return 1<arguments.length&&"number"==typeof arguments[1].accuracy&&(n=Math.max(1e-12,arguments[1].accuracy)),function(t,n){for(var r=t.length,e=[],o=0;o<r;o++)e.push([t[o][0],t[o][1]]);e.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(var i=r-1;0<i;i--)for(var a=i-1;0<=a&&Math.abs(e[i][0]-e[a][0])<n;)Math.abs(e[i][1]-e[a][1])<n&&(e.splice(a,1),a=0),a--;return e}(t,n)},this.convex_hull=function(t){return arguments.length<1?GlobalFunctions.set_error("ComputationalGeometry","convex_hull","Invalid number of function arguments."):1!=GlobalFunctions.is_matrix(t)?GlobalFunctions.set_error("ComputationalGeometry","convex_hull","Invalid function argument."):2!=t[0].length?GlobalFunctions.set_error("ComputationalGeometry","convex_hull","Invalid function argument."):t.length<3?GlobalFunctions.set_error("ComputationalGeometry","convex_hull","At least three data points required."):function(t){for(var n=t.length,r=[],e=0;e<n;e++)r.push([t[e][0],t[e][1],e]);r.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(var o,i,a,l,z,u=[],s=0;s<2*n;s++){for(var f=s<n?s:2*n-1-s;2<=u.length&&(o=u[u.length-2],i=u[u.length-1],a=r[f],l=(o[0]-i[0])*(a[1]-i[1])-(o[1]-i[1])*(a[0]-i[0]),z=(o[0]-i[0])*(a[0]-i[0])+(o[1]-i[1])*(a[1]-i[1]),l<0||0==l&&z<=0);)u.pop();u.push(r[f])}var c=[];for(e=0;e<u.length;e++)c.push(u[e][2]);return c}(t)},this.delaunay=function(t){if(arguments.length<1)return GlobalFunctions.set_error("ComputationalGeometry","delaunay","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("ComputationalGeometry","delaunay","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("ComputationalGeometry","delaunay","Invalid function argument.");if(t.length<3)return GlobalFunctions.set_error("ComputationalGeometry","delaunay","At least three data points required.");if(1!=b(t,y))return GlobalFunctions.set_error("ComputationalGeometry","delaunay","Set of data points is not distinct.");var n=p(t);return"string"==typeof n?GlobalFunctions.set_error("ComputationalGeometry","delaunay",n):n},this.voronoi=function(r){if(arguments.length<1)return GlobalFunctions.set_error("ComputationalGeometry","voronoi","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(r))return GlobalFunctions.set_error("ComputationalGeometry","voronoi","Invalid function argument.");if(2!=r[0].length)return GlobalFunctions.set_error("ComputationalGeometry","voronoi","Invalid function argument.");if(r.length<3)return GlobalFunctions.set_error("ComputationalGeometry","voronoi","At least three data points required.");if(1!=b(r,y))return GlobalFunctions.set_error("ComputationalGeometry","voronoi","Set of data points is not distinct.");var t=p(r);if("string"==typeof t)return GlobalFunctions.set_error("ComputationalGeometry","voronoi",t);for(var n,e,o,i,a,l,z,u=[],s=0;s<t.length;s++){var f=(n=r[t[s][0]],e=r[t[s][1]],o=r[t[s][2]],void 0,i=n[0]*n[0]+n[1]*n[1],a=e[0]*e[0]+e[1]*e[1],l=o[0]*o[0]+o[1]*o[1],0==(z=2*(n[0]*(e[1]-o[1])+e[0]*(o[1]-n[1])+o[0]*(n[1]-e[1])))?"Unexpected failure.":[(i*(e[1]-o[1])+a*(o[1]-n[1])+l*(n[1]-e[1]))/z,(i*(o[0]-e[0])+a*(n[0]-o[0])+l*(e[0]-n[0]))/z]);if("string"==typeof f)return GlobalFunctions.set_error("ComputationalGeometry","voronoi",f);u.push(f)}var c=[];for(s=0;s<t.length;s++){var h=[t[s][0],t[s][1],t[s][2]];h.sort(function(t,n){return t-n}),c.push([h[0],h[1],s]),c.push([h[1],h[2],s]),c.push([h[0],h[2],s])}c.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(var d=[],g=0;g<c.length-1;g++)c[g][0]==c[g+1][0]&&c[g][1]==c[g+1][1]&&(d.push([c[g][2],c[g+1][2]]),g++);for(var v=[],m=0;m<r.length;m++)v.push([]);for(s=0;s<t.length;s++)v[t[s][0]].push(s),v[t[s][1]].push(s),v[t[s][2]].push(s);for(m=0;m<v.length;m++)v[m].sort(function(t,n){return Math.atan2(u[t][0]-r[m][0],u[t][1]-r[m][1])-Math.atan2(u[n][0]-r[m][0],u[n][1]-r[m][1])});return{V:u,E:d,W:v}}},Console=new function(){var n=4,z="",u=!1;function a(t){return t.trim()}function l(t){return t?"true":"false"}function s(t){return parseFloat(t.toFixed(n)).toFixed(n)}function f(t){return t=s(t)}function c(t){for(var n="",r=0;r<t;)n+=" ",r++;return n}function r(t){document.getElementById(z).value+=t.trim()+"\n\n"}this.init=function(){var t,n,r=300,e=-1,o="";if(0<arguments.length&&("number"==typeof arguments[0].height&&(r=Math.max(32,Math.min(Math.round(arguments[0].height),2048))),"number"==typeof arguments[0].width&&(e=Math.max(32,Math.min(Math.round(arguments[0].width),2048))),"string"==typeof arguments[0].textarea&&(o=arguments[0].textarea)),""==o||1!=GlobalFunctions.is_textarea(o)){var i=document.createElement("div"),a="random-id-"+(1e10*Math.random()).toFixed(0);i.setAttribute("id",a),i.style.textAlign="center",document.body.appendChild(i);var l="random-id-"+(1e10*Math.random()).toFixed(0);-1==e&&(t=a,n="random-id-"+(1e10*Math.random()).toFixed(0),document.getElementById(t).innerHTML='<div id="'+n+'" style="height:300px;"></div>',e=Math.max(240,Math.min(680,Math.round(document.getElementById(n).clientWidth)-16))),document.getElementById(a).innerHTML='<textarea id="'+l+'" style="width:'+e.toFixed(0)+"px; height:"+r.toFixed(0)+'px; background-color:#f6f6f6; padding:6px 8px; resize:none; border:none; outline:none;" spellcheck="false"></textarea>',z=l}else z=o,document.getElementById(z).value="";u=!0},this.print=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Console","print","Invalid number of function arguments.");1!=u&&this.init(),1==GlobalFunctions.is_vector(t)?r(function(t){for(var n="[",r=0;r<t.length;r++)n+=" "+s(t[r])+" ";return n+="]"}(t)):1==GlobalFunctions.is_matrix(t)?r(function(t){for(var n=0,r=new Array(t.length),e=0;e<r.length;e++)r[e]=new Array(t[e].length);for(e=0;e<r.length;e++)for(var o=0;o<r[e].length;o++)r[e][o]=s(t[e][o]),n=Math.max(n,r[e][o].length);var i="";for(e=0;e<t.length;e++){for(i+="[",o=0;o<t[e].length;o++)i+=" "+c(n-r[e][o].length)+r[e][o]+" ";i+="]"+(e<t.length-1?"\n":"")}return i}(t)):1==GlobalFunctions.is_string(t)?r(a(t)):1==GlobalFunctions.is_number(t)?r(f(t)):1==GlobalFunctions.is_boolean(t)?r(l(t)):"object"==typeof t&&"function"==typeof Object&&"function"==typeof Object.keys&&"object"==typeof Object.keys(t)&&1<Object.keys(t).length?r(function t(n){for(var r=Object.keys(n),e="{",o=0;o<r.length;o++){var i="(unknown)";1==GlobalFunctions.is_vector(n[r[o]])?i="("+n[r[o]].length.toFixed(0)+"-vector)":1==GlobalFunctions.is_matrix(n[r[o]])?i="("+n[r[o]].length.toFixed(0)+"x"+n[r[o]][0].length.toFixed(0)+"-matrix)":1==GlobalFunctions.is_string(n[r[o]])?i='"'+a(n[r[o]])+'"':1==GlobalFunctions.is_number(n[r[o]])?i=f(n[r[o]]):1==GlobalFunctions.is_boolean(n[r[o]])?i=l(n[r[o]]):"object"==typeof n[r[o]]&&"object"==typeof Object.keys(n[r[o]])&&1<Object.keys(n[r[o]]).length&&(i=t(n[r[o]])),e+=(0<o?", ":"")+r[o]+":"+i}return e+="}"}(t)):r("Failure: invalid input!")},this.clear=function(){1!=u&&this.init(),document.getElementById(z).value=""},this.digits=function(t){return arguments.length<1?GlobalFunctions.set_error("Console","digits","Invalid number of function arguments."):1!=GlobalFunctions.is_number(t)?GlobalFunctions.set_error("Console","digits","Invalid function argument."):void(n=Math.min(12,Math.max(0,Math.round(t))))}},ConvNet=new function(){var f=!1,c=[],l=[],h=[],a=[{A:[1,1,1],B:[-1,-1,-1]},{A:[1,-1,-1],B:[-1,1,1]},{A:[-1,1,-1],B:[1,-1,1]},{A:[-1,-1,1],B:[1,1,-1]},{A:[1,0,-1],B:[-1,0,1]},{A:[-1,1,0],B:[1,-1,0]},{A:[0,-1,1],B:[0,1,-1]}];function z(t,n,r,e,o){for(var i=[],a=0;a<t;a++){i.push([]);for(var l=(a+1)/(t+1)*Math.PI,z=0;z<t;z++){var u=(z+1)/(t+1)*Math.PI,s=Math.sin(n*u)*Math.sin(r*l);i[a].push([s*(0<s?e[0]:-o[0]),s*(0<s?e[1]:-o[1]),s*(0<s?e[2]:-o[2])])}}return i}function i(t,n,r,e){for(var o=[],i=0;i<t;i++){o.push([]);for(var a=(i+1)/(t+1)*Math.PI,l=0;l<t;l++){var z=(l+1)/(t+1)*Math.PI,u=Math.sin(n*z)*Math.sin(r*a);o[i].push(e*u)}}return o}function d(t,n){var r=[];n>r.length&&r.push(i(t,1,1,1)),n>r.length&&r.push(i(t,1,2,1)),n>r.length&&r.push(i(t,2,1,1)),n>r.length&&r.push(i(t,1,2,-1)),n>r.length&&r.push(i(t,2,1,-1));for(var e=2,o=2;r.length<n;)n>r.length&&r.push(i(t,e,o,1)),n>r.length&&e!=o&&r.push(i(t,o,e,1)),n>r.length&&r.push(i(t,e,o,-1)),n>r.length&&e!=o&&r.push(i(t,o,e,-1)),e<++o&&(e++,o=1);return r}function g(t,n){var r=[];n>r.length&&r.push(z(t,1,1,a[0].A,a[0].B)),n>r.length&&r.push(z(t,1,2,a[0].A,a[0].B)),n>r.length&&r.push(z(t,2,1,a[0].A,a[0].B)),n>r.length&&r.push(z(t,1,2,a[0].B,a[0].A)),n>r.length&&r.push(z(t,2,1,a[0].B,a[0].A));for(var e=1;e<a.length;e++)n>r.length&&r.push(z(t,1,1,a[e].A,a[e].B));for(e=1;e<a.length;e++)n>r.length&&r.push(z(t,1,1,a[e].B,a[e].A));for(e=1;e<a.length;e++)n>r.length&&r.push(z(t,1,2,a[e].A,a[e].B));for(e=1;e<a.length;e++)n>r.length&&r.push(z(t,2,1,a[e].A,a[e].B));for(e=1;e<a.length;e++)n>r.length&&r.push(z(t,1,2,a[e].B,a[e].A));for(e=1;e<a.length;e++)n>r.length&&r.push(z(t,2,1,a[e].B,a[e].A));for(var o=2,i=2;r.length<n;){for(e=0;e<a.length;e++)n>r.length&&r.push(z(t,o,i,a[e].A,a[e].B));if(o!=i)for(e=0;e<a.length;e++)n>r.length&&r.push(z(t,i,o,a[e].A,a[e].B));for(e=0;e<a.length;e++)n>r.length&&r.push(z(t,o,i,a[e].B,a[e].A));if(o!=i)for(e=0;e<a.length;e++)n>r.length&&r.push(z(t,i,o,a[e].B,a[e].A));o<++i&&(o++,i=1)}return r}function v(t){for(var n=[],r=0;r<t[1];r++){n.push([]);for(var e=0;e<t[0];e++)n[r].push(0)}return n}function u(t,n,r){var e=n.length,o=Math.round((e-1)/2),i=function(t,n){var r=t.length,e=0;if(1==n)for(var o=0;o<r;o++)for(var i=0;i<r;i++)e+=Math.max(0,t[o][i]);if(3==n)for(o=0;o<r;o++)for(i=0;i<r;i++)e+=Math.max(0,t[o][i][0])+Math.max(0,t[o][i][1])+Math.max(0,t[o][i][2]);return e}(n,r);i<=0&&(i=1);for(var a,l=v([t[0].length,t.length]),z=0;z<l.length;z++)for(var u=0;u<l[z].length;u++){var s=0;if(1==r)for(var f=0;f<e;f++)for(var c=0;c<e;c++){var h=Math.max(0,Math.min(z+f-o,l.length-1)),d=Math.max(0,Math.min(u+c-o,l[z].length-1));s+=n[f][c]*t[h][d]}if(3==r)for(f=0;f<e;f++)for(c=0;c<e;c++){h=Math.max(0,Math.min(z+f-o,l.length-1)),d=Math.max(0,Math.min(u+c-o,l[z].length-1));s+=n[f][c][0]*t[h][d][0]+n[f][c][1]*t[h][d][1]+n[f][c][2]*t[h][d][2]}l[z][u]=(a=s/i,Math.max(0,a))}return l}function s(t,n){if(1==n)return t;for(var r=v([Math.floor(t[0].length/n),Math.floor(t.length/n)]),e=0;e<r.length;e++)for(var o=0;o<r[e].length;o++)for(var i=r[e][o]=0;i<n;i++)for(var a=0;a<n;a++)r[e][o]=Math.max(r[e][o],t[e*n+i][o*n+a]);return r}function m(t,n,r,e){Sketch.rect(t+1,n,2,1,{stroke:"#000000",fill:"#434343"});var o=1==e?"input image":"feature maps";return Sketch.text(t+1,n+.18-.025,o,{fill:"#ffffff"}),Sketch.text(t+1,n-.18-.025,r[0].toFixed(0)+" x "+r[1].toFixed(0)+(3==r[2]?" x 3":""),{fill:"#ffffff"}),1!=e&&Sketch.text(t+1,n-.9,e.toFixed(0)),2}function b(t,n,r,e){Sketch.rect(t+1,n+.75,1.2,.8,{stroke:"#000000",fill:"#e06666"});var o=r.size.toFixed(0)+" x "+r.size.toFixed(0)+(0==e&&3==c[2]?" x 3":"");return Sketch.text(t+1,n+.9-.025,"conv",{fill:"#000000"}),Sketch.text(t+1,n+.6-.025,o,{fill:"#000000"}),Sketch.arrow(t+.4,n,t+1.6,n),Sketch.circle(t+1.6,n+1.15,.25,{stroke:"#000000",fill:"#ffff00"}),Sketch.text(t+1.6,n+1.15-.025,r.count.toFixed(0)),2}this.compute=function(t){return 1!=f?GlobalFunctions.set_error("ConvNet","compute","ConvNet not initialized yet."):arguments.length<1?GlobalFunctions.set_error("ConvNet","compute","Invalid number of function arguments."):1!=function(t){if(1==c[2]){if(1!=GlobalFunctions.is_matrix(t))return!1;if(t.length!=c[1]||t[0].length!=c[0])return!1}if(3==c[2]){if("number"!=typeof t.length||"number"!=typeof t[0].length)return!1;if(t.length!=c[1]||t[0].length!=c[0])return!1;if(1!=GlobalFunctions.is_vector(t[0][0])||3!=t[0][0].length)return!1}return!0}(t)?GlobalFunctions.set_error("ConvNet","compute","Improper size of input data."):function(t){for(var n=[t],r=[],e=0;e<l.length;e++){r=[];for(var o=0==e?c[2]:1,i=0;i<n.length;i++)for(var a=0;a<l[e].F.length;a++)r.push(s(u(n[i],l[e].F[a],o),l[e].P));n=r}return function(t){for(var n=[],r=0;r<t.length;r++)for(var e=0;e<t[r].length;e++)for(var o=0;o<t[r][e].length;o++)n.push(t[r][e][o]);return n}(n)}(t)},this.init=function(t,n){if(f=!1,arguments.length<2)return GlobalFunctions.set_error("ConvNet","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("ConvNet","init","Invalid function argument.");if("object"!=typeof n)return GlobalFunctions.set_error("ConvNet","init","Invalid function argument.");if(c=[],l=[],h=[],t.length<2||3<t.length)return GlobalFunctions.set_error("ConvNet","init","Invalid input data.");for(var r=0;r<t.length;r++)c.push(Math.max(1,Math.round(t[r])));if(2==c.length&&c.push(1),1!=c[2]&&3!=c[2]&&(c[2]=1),n.length<1)return GlobalFunctions.set_error("ConvNet","init","Invalid input data.");for(r=0;r<n.length;r++)if("number"==typeof n[r].size&&"number"==typeof n[r].count&&"number"==typeof n[r].pooling){var e=[Math.max(3,Math.round(n[r].size)),Math.max(1,Math.round(n[r].count)),Math.max(1,Math.round(n[r].pooling))];e[0]%2==0&&e[0]++,3==c[2]&&0==l.length?l.push({F:g(e[0],e[1]),P:e[2]}):l.push({F:d(e[0],e[1]),P:e[2]})}if(0==l.length)return GlobalFunctions.set_error("ConvNet","init","Invalid filter layer specification.");for(r=0;r<l.length;r++)h.push({size:l[r].F[0].length,count:l[r].F.length,pooling:l[r].P});var o=[c[0],c[1]];for(r=0;r<h.length;r++){var i=h[r];o[0]=Math.floor(o[0]/i.pooling),o[1]=Math.floor(o[1]/i.pooling)}if(o[0]<1||o[1]<1)return GlobalFunctions.set_error("ConvNet","init","Invalid filter layer specification.");f=!0},this.plot_model=function(){if(1!=f)return GlobalFunctions.set_error("ConvNet","plot_model","ConvNet not initialized yet.");var t=.8,n=2*function(){for(var t=1,n=0;n<h.length;n++)t+=2,1<h[n].pooling&&(t+=2);return t+=1}()+2*t;Sketch.init([0,n],[-2.5,2.5],{width:50*n,background:"#f6f6f6",scaling:"off"});var r,e,o,i,a,l,z=[c[0],c[1],1],u=1;t+=m(t,0,c,u);for(var s=0;s<h.length;s++)t+=b(t,0,h[s],s),t+=m(t,0,z,u*=h[s].count),1<h[s].pooling&&(z[0]=Math.floor(z[0]/h[s].pooling),z[1]=Math.floor(z[1]/h[s].pooling),t+=(r=t,e=0,o=h[s],Sketch.rect(r+1,e+.75,1.2,.8,{stroke:"#000000",fill:"#d9d9d9"}),Sketch.text(r+1,e+.9-.025,"pooling",{fill:"#000000"}),Sketch.text(r+1,e+.6-.025,o.pooling.toFixed(0)+" x "+o.pooling.toFixed(0),{fill:"#000000"}),Sketch.arrow(r+.4,e,r+1.6,e),2),t+=m(t,0,z,u));u*=z[0]*z[1],t+=(i=t,a=0,l=u,Sketch.rect(i+1.7,a,.6,2.8,{stroke:"#000000",fill:"#6d9eeb"}),Sketch.arrow(i+.4,a,i+1,a),Sketch.text(i+1.7,a-1.8,l.toFixed(0)),2),Sketch.draw()},this.plot_filter=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("ConvNet","plot_filter","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("ConvNet","plot_filter","Invalid function argument.");var r=Math.max(3,Math.round(t)),e=Math.max(1,Math.round(n));r%2==0&&r++;var o=!1;2<arguments.length&&"boolean"==typeof arguments[2].color&&(o=arguments[2].color),function(t,n,r){var e=r?g(t,n):d(t,n),o=Math.min(e.length,10)*(t+1)+1,i=Math.ceil((e.length-.5)/10)*(t+1)+1;Grid.init(o,i,{style:"canvas",zoom:Math.floor(Math.max(1,80/(t+2))),background:"#f6f6f6"});for(var a=0;a<e.length;a++)for(var l=0;l<t;l++)for(var z=0;z<t;z++){var u=a%10*(t+1)+(z+1),s=i-Math.floor(a/10)*(t+1)-l-2,f=r?[255*(e[a][l][z][0]+1)/2,255*(e[a][l][z][1]+1)/2,255*(e[a][l][z][2]+1)/2]:[255*(e[a][l][z]+1)/2,255*(e[a][l][z]+1)/2,255*(e[a][l][z]+1)/2];Grid.pixel(u,s,f)}Grid.draw()}(r,e,o)},this.train=function(){popup("Warning: Function train is deprecated!")},this.evaluate=function(){popup("Warning: Function evaluate is deprecated!")},this.test=function(){popup("Warning: Function test is deprecated!")},this.progress=function(){popup("Warning: Function progress is deprecated!")},this.confusion_matrix=function(){popup("Warning: Function confusion_matrix is deprecated!")},this.get_data=function(){popup("Warning: Function get_data is deprecated!")},this.export_data=function(){popup("Warning: Function export_data is deprecated!")},this.set_data=function(){popup("Warning: Function set_data is deprecated!")}},CurveFitting=new function(){function i(t,n,r){var e=0,o=1;try{e=t(n,r),1!=isFinite(e)&&(o=e=0)}catch(t){o=e=0}return{value:e,state:o}}this.linear=function(t){if(arguments.length<1)return GlobalFunctions.set_error("CurveFitting","linear","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("CurveFitting","linear","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("CurveFitting","linear","More data points required.");if(2!=t[0].length)return GlobalFunctions.set_error("CurveFitting","linear","Invalid function argument.");for(var n=t.length,r=0,e=0,o=0;o<n;o++)r+=t[o][0];for(o=0;o<n;o++)e+=t[o][1];r/=n,e/=n;var i=0,a=0;for(o=0;o<n;o++){var l=t[o][0]-r;i+=l*(t[o][1]-e),a+=l*l}if(a<=0)return GlobalFunctions.set_error("CurveFitting","linear","All data points lie on a vertical line.");var z=i/a;return[e-z*r,z]},this.polynomial=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("CurveFitting","polynomial","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("CurveFitting","polynomial","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("CurveFitting","polynomial","More data points required.");if(2!=t[0].length)return GlobalFunctions.set_error("CurveFitting","polynomial","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("CurveFitting","polynomial","Invalid function argument.");for(var r=t.length,e=Math.max(1,Math.round(n)),o=Math.min(r-1,e),i=new Array(r),a=0;a<r;a++){i[a]=[];for(var l=1,z=0;z<o;z++)i[a].push(l),l*=t[a][0];i[a].push(l)}var u=LinearAlgebra.qr(i);if("string"==typeof u)return GlobalFunctions.set_error("CurveFitting","polynomial","Unexpected failure.");var s=u.Q,f=u.R,c=[];for(z=0;z<=o;z++){for(l=0,a=0;a<r;a++)l+=s[a][z]*t[a][1];c.push(l)}for(l=1,z=0;z<=o;z++)l=Math.min(l,Math.abs(f[z][z]));if(l<1e-10)return GlobalFunctions.set_error("CurveFitting","polynomial","At least "+(o+1)+" data points should be distinct in their x-values.");var h=LinearAlgebra.solve(f.splice(0,o+1),c);if("string"==typeof h)return GlobalFunctions.set_error("CurveFitting","polynomial","Unexpected failure.");for(z=o;z<e;z++)h.push(0);return h},this.least_squares=function(e,o,t){if(arguments.length<3)return GlobalFunctions.set_error("CurveFitting","least_squares","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(e))return GlobalFunctions.set_error("CurveFitting","least_squares","Invalid function argument.");if(e.length<2)return GlobalFunctions.set_error("CurveFitting","least_squares","More data points required.");if(2!=e[0].length)return GlobalFunctions.set_error("CurveFitting","least_squares","Invalid function argument.");if(1!=GlobalFunctions.is_function(o))return GlobalFunctions.set_error("CurveFitting","least_squares","Invalid function argument.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("CurveFitting","least_squares","Invalid function argument.");if(1!=function(t,n,r){for(var e=!0,o=0;o<t.length;o++)1!=i(n,t[o][0],r).state&&(e=!1);return e}(e,o,t))return GlobalFunctions.set_error("CurveFitting","least_squares","Input data not consistent.");var n=NonlinearProgramming.minimize(function(){for(var t=0,n=0;n<e.length;n++){var r=i(o,e[n][0],arguments).value-e[n][1];t+=r*r}return t},t);return"string"==typeof n?GlobalFunctions.set_error("CurveFitting","least_squares","Unexpected failure."):n}},DecisionTree=new function(){var z=!1,u=0,s=0,i=[];function f(t,n){var r=[255,255,255,0];if(0<n){var e=GlobalFunctions.get_color("blue").rgba;r=[e[0],e[1],e[2],Math.round(200*t/n)]}return r}function c(t){if("object"!=typeof t||t.length<2)return-1;for(var n=0,r=0,e=0;e<t.length;e++){if("object"!=typeof t[e].input||"number"!=typeof t[e].index)return-1;if(1!=GlobalFunctions.is_vector(t[e].input))return-1;if(0==e&&(n=Math.max(1,t[e].input.length)),t[e].input.length!=n)return-1;if(t[e].index<0)return-1;r=Math.max(r,Math.round(t[e].index))}return r+1}function a(t,n,r,e){var d=n,g=r,v=e;for(var m=[],b=t[0].input.length,p=0,o=0;o<t.length;o++)p=Math.max(p,Math.round(t[o].index)+1);var i=[];for(o=0;o<t.length;o++)i.push(o);return function t(n,r,e,o){for(var i=[],a=0;a<p;a++)i.push([0,a]);for(var l=0;l<r.length;l++)i[n[r[l]].index][0]++;i.sort(function(t,n){return n[0]-t[0]});var z=i[0][1];if(i[0][0]!=r.length){if(e==v){for(var u=1;u<i.length&&i[0][0]==i[u][0];)u++;return z=i[Math.floor(u*Math.random())][1],void m.push([-1,z,o])}var s=[],f=Math.floor(b*Math.random());for("periodic"==g&&(f=e%b),l=0;l<r.length;l++)s.push(n[r[l]].input[f]);s.sort(function(t,n){return t-n});var c=function(t){if(2==t.length)return.5*(t[0]+t[1]);if("gini"==d){var n=function(t){for(var n=t.length,r=[],e=0;e<n;e++)r.push(t[e]-t[0]);for(var o=0,i=0,a=0;a<n;a++)o+=(a+1)*r[a],i+=r[a];return 0==i?.5:2*o/(n*i)-(n+1)/n}(t)*t.length;return.5*(t[n=Math.max(0,Math.min(Math.floor(n),t.length-2))]+t[n+1])}if("average"!=d)return"median"==d&&(n=t[Math.floor(.5*t.length)])>t[0]&&n<t[t.length-1]?n:.5*(t[0]+t[t.length-1]);for(var r=n=0;r<t.length;r++)n+=t[r];return n/t.length}(s);m.push([f,c,o]);var h=[[],[]];for(l=0;l<r.length;l++)h[n[r[l]].input[f]<=c?0:1].push(r[l]);0==h[0].length?m.push([-1,z,o+"a"]):t(n,h[0],e+1,o+"a"),0==h[1].length?m.push([-1,z,o+"b"]):t(n,h[1],e+1,o+"b")}else m.push([-1,z,o])}(t,i,0,""),function(t){for(var n=[],r=0;r<t.length;r++)n.push([t[r][0],t[r][1]]);for(r=0;r<n.length;r++)if(-1!=t[r][0]){for(var e=t[r][2]+"a",o=0;t[o][2]!=e;)o++;for(n[r].push(o),e=t[r][2]+"b",o=0;t[o][2]!=e;)o++;n[r].push(o)}else n[r].push(0),n[r].push(0);return n}(m)}function r(t,n){for(var r=-1,e=0;-1==r;)-1==t[e][0]?r=Math.round(t[e][1]):e=n[t[e][0]]<=t[e][1]?t[e][2]:t[e][3];return r}function h(t){return r(i,t)}this.random_decision_tree=function(t,n){return a(t,"median","random",n)},this.init=function(t){if(z=!1,arguments.length<1)return GlobalFunctions.set_error("DecisionTree","init","Invalid number of function arguments.");var n=c(t);if(n<1)return GlobalFunctions.set_error("DecisionTree","init","Invalid function argument.");var r="median",e="random",o=256;1<arguments.length&&("string"==typeof arguments[1].threshold_rule&&(r=arguments[1].threshold_rule),"string"==typeof arguments[1].feature_selection&&(e=arguments[1].feature_selection),"number"==typeof arguments[1].max_depth&&(o=Math.max(1,Math.min(Math.round(arguments[1].max_depth),256)))),u=n,s=t[0].input.length,i=a(t,r,e,o),z=!0},this.get=function(){return 1!=z?GlobalFunctions.set_error("DecisionTree","get","DecisionTree not initialized yet."):i},this.evaluate=function(t){return 1!=z?GlobalFunctions.set_error("DecisionTree","evaluate","DecisionTree not initialized yet."):arguments.length<1?GlobalFunctions.set_error("DecisionTree","evaluate","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("DecisionTree","evaluate","Invalid function argument."):t.length!=s?GlobalFunctions.set_error("DecisionTree","evaluate","Improper dimension of function input data."):h(t)},this.evaluate_tree=function(t,n){return r(t,n)},this.test=function(t){if(1!=z)return GlobalFunctions.set_error("DecisionTree","test","DecisionTree not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DecisionTree","test","Invalid number of function arguments.");var n=c(t);if(n<1||n!=u)return GlobalFunctions.set_error("DecisionTree","test","Invalid function argument.");if(t[0].input.length!=s)return GlobalFunctions.set_error("DecisionTree","test","Invalid function argument.");for(var r=0,e=0;e<t.length;e++)h(t[e].input)==t[e].index&&r++;return r},this.confusion_matrix=function(t){if(1!=z)return GlobalFunctions.set_error("DecisionTree","confusion_matrix","DecisionTree not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DecisionTree","confusion_matrix","Invalid number of function arguments.");var n=c(t);if(n<1||n!=u)return GlobalFunctions.set_error("DecisionTree","confusion_matrix","Invalid function argument.");if(t[0].input.length!=s)return GlobalFunctions.set_error("DecisionTree","confusion_matrix","Invalid function argument.");for(var r=u,e=[],o=0;o<r;o++){e.push([]);for(var i=0;i<r;i++)e[o].push(0)}for(var a=0;a<t.length;a++)e[t[a].index][h(t[a].input)]++;var l="off";return 1<arguments.length&&"string"==typeof arguments[1].display&&(l=arguments[1].display),"on"==l&&function(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.pow(t[e][o],.64));for(Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"}),Sketch.box(n/2,n/2,n,{fill:"#fafafa"}),e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:f(Math.pow(t[e][o],.64),r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(0));Sketch.draw()}(e),e}},DiffusionModel=new function(){var u=!1,s=[],f=32,c=.1;function a(t){function n(){for(var t=0,n=0;0===t;)t=Math.random();for(;0===n;)n=Math.random();return Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*n)*c}for(var r=[],e=0;e<t.length;e++){var o=t[e]+n();o=Math.max(0,Math.min(o,1)),r.push(o)}return r}function i(t){for(var n=[],r=0;r<t.length;r++)for(var e=t[r],o=0;o<f;o++){var i=a(e);n.push({input:i,output:t[r]}),e=i}return n}this.evaluate=function(t){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","evaluate","DiffusionModel not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","evaluate","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("DiffusionModel","evaluate","Invalid function argument.");if(t.length!=s[0])return GlobalFunctions.set_error("DiffusionModel","evaluate","Improper dimensions.");for(var n=t,r=0;r<f;r++)n=NeuralNetwork.evaluate(n);return n},this.random=function(){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","random","DiffusionModel not initialized yet.");for(var t=[],n=0;n<s[0];n++)t.push(Math.random());for(var r=0;r<f;r++)t=NeuralNetwork.evaluate(t);return t},this.init=function(t){if(u=!1,arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("DiffusionModel","init","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("DiffusionModel","init","Length of input vector must be at least 2.");if(t[0]!=t[t.length-1])return GlobalFunctions.set_error("DiffusionModel","init","Invalid layout definition.");s=[];for(var n=0;n<t.length;n++)s.push(Math.max(1,Math.round(t[n])));NeuralNetwork.init(s),f=32,c=.1,1<arguments.length&&("number"==typeof arguments[1].steps&&(f=Math.max(1,Math.min(Math.round(arguments[1].steps),256))),"number"==typeof arguments[1].standard_deviation&&(c=Math.max(0,Math.min(arguments[1].standard_deviation,1)))),u=!0},this.forward_process=function(t){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","forward_process","DiffusionModel not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","forward_process","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("DiffusionModel","forward_process","Invalid function argument.");if(t.length!=s[0])return GlobalFunctions.set_error("DiffusionModel","forward_process","Improper dimensions.");for(var n=[t],r=0;r<f;r++)n.push(a(n[r]));return n},this.backward_process=function(t){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","backward_process","DiffusionModel not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","backward_process","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("DiffusionModel","backward_process","Invalid function argument.");if(t.length!=s[0])return GlobalFunctions.set_error("DiffusionModel","backward_process","Improper dimensions.");for(var n=[t],r=0;r<f;r++)n.push(NeuralNetwork.evaluate(n[r]));return n},this.train=function(t){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","train","DiffusionModel not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","train","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("DiffusionModel","train","Invalid training data.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("DiffusionModel","train","Invalid training data.");if(t[0].length!=s[0])return GlobalFunctions.set_error("DiffusionModel","train","Invalid training data.");var n=1e3,r=100,e=5;1<arguments.length&&("number"==typeof arguments[1].iterations&&(n=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(r=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(e=Math.abs(arguments[1].learning_rate)));var o=i(t);NeuralNetwork.train(o,{iterations:n,batch_size:r,learning_rate:e})},this.progress=function(t){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","progress","DiffusionModel not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("DiffusionModel","progress","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("DiffusionModel","progress","Invalid training data.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("DiffusionModel","progress","Invalid training data.");if(t[0].length!=s[0])return GlobalFunctions.set_error("DiffusionModel","progress","Invalid training data.");var n=1e3,r=100,e=5;1<arguments.length&&("number"==typeof arguments[1].iterations&&(n=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(r=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(e=Math.abs(arguments[1].learning_rate)));var o=i(t);NeuralNetwork.progress(o,[o[0],o[1]],{iterations:n,batch_size:r,learning_rate:e})},this.set_data=function(t){return u=!1,arguments.length<1?GlobalFunctions.set_error("DiffusionModel","set_data","Invalid number of function arguments."):"object"!=typeof t?GlobalFunctions.set_error("DiffusionModel","set_data","Invalid function argument."):"object"!=typeof t.layout||"number"!=typeof t.steps||"number"!=typeof t.standard_deviation||"object"!=typeof t.weights||"object"!=typeof t.biases?GlobalFunctions.set_error("DiffusionModel","set_data","Invalid function argument."):(NeuralNetwork.set_data(t),s=t.layout,f=Math.max(1,Math.min(Math.round(t.steps),256)),c=Math.max(0,Math.min(t.standard_deviation,1)),void(u=!0))},this.get_data=function(){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","get_data","DiffusionModel not initialized yet.");var t=NeuralNetwork.get_data();return{layout:t.layout,steps:f,standard_deviation:c,weights:t.weights,biases:t.biases}},this.export_data=function(){if(1!=u)return GlobalFunctions.set_error("DiffusionModel","export_data","DiffusionModel not initialized yet.");var t="",n=4;0<arguments.length&&("string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),"number"==typeof arguments[0].digits&&(n=Math.max(0,Math.min(Math.round(arguments[0].digits),12))));var r=NeuralNetwork.get_data(),e=r.weights,o=r.biases,i="var T = {\n";i+="layout:[";for(var a=0;a<s.length;a++)i+=s[a].toFixed(0)+(a<s.length-1?",":"");i+="],\n",i+="steps:"+f.toFixed(0)+",\n",i+="standard_deviation:"+c.toFixed(4)+",\n",i+="weights:[";for(a=0;a<e.length;a++){i+="[";for(var l=0;l<e[a].length;l++){i+="[";for(var z=0;z<e[a][l].length;z++)i+=e[a][l][z].toFixed(n)+(z<e[a][l].length-1?",":"");i+="]"+(l<e[a].length-1?",":"")}i+="]"+(a<e.length-1?",":"")}i+="],\n",i+="biases:[";for(a=0;a<o.length;a++){i+="[";for(l=0;l<o[a].length;l++)i+=o[a][l].toFixed(n)+(l<o[a].length-1?",":"");i+="]"+(a<o.length-1?",":"")}i+="]\n",i+="};\n",""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(i):document.getElementById(t).value=i}},DimensionReduction=new function(){var o=2;function i(t,n){return 1==o?function(t,n){for(var r=0,e=0;e<t.length;e++)r+=Math.abs(t[e]-n[e]);return r}(t,n):-1==o?function(t,n){for(var r=Math.abs(t[0]-n[0]),e=1;e<t.length;e++)r=Math.max(r,Math.abs(t[e]-n[e]));return r}(t,n):-2==o?function(t,n){for(var r=[0,0,0],e=0;e<t.length;e++)r[0]+=t[e]*n[e],r[1]+=t[e]*t[e],r[2]+=n[e]*n[e];return 0==r[1]&&0==r[2]?0:0==r[1]||0==r[2]?1:1-r[0]*r[0]/(r[1]*r[2])}(t,n):function(t,n){for(var r=0,e=0;e<t.length;e++){var o=t[e]-n[e];r+=o*o}return Math.sqrt(r)}(t,n)}function F(t){for(var n=[],r=0;r<t;r++){n.push([]);for(var e=0;e<t;e++)n[r].push(0)}return n}function a(t){for(var n=F(t.length),r=0;r<n.length-1;r++)for(var e=r+1;e<n.length;e++)n[r][e]=i(t[r],t[e]),n[e][r]=n[r][e];return n}function l(t,n){for(var r=t.length,e=F(r),o=0;o<r-1;o++)for(var i=o+1;i<r;i++)e[o][i]=-.5*t[o][i]*t[o][i],e[i][o]=e[o][i];var a=[];for(o=0;o<r;o++){var l=0;for(i=0;i<r;i++)l+=e[o][i];a.push(l/r)}for(l=0,o=0;o<r-1;o++)for(i=o+1;i<r;i++)l+=2*e[o][i];var z=l/(r*r),u=F(r);for(o=0;o<r;o++)u[o][o]=e[o][o]-a[o]-a[o]+z;for(o=0;o<r-1;o++)for(i=o+1;i<r;i++)u[o][i]=e[o][i]-a[o]-a[i]+z,u[i][o]=u[o][i];var s=LinearAlgebra.eigenvalues(u),f=[];for(o=0;o<r;o++){for(l=[],i=0;i<n;i++)l.push(s.Q[i][o]);f.push(l)}return f}this.pca=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("DimensionReduction","pca","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("DimensionReduction","pca","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("DimensionReduction","pca","Invalid function argument.");var r=Math.max(1,Math.round(n));return r>=t[0].length?t:PrincipalComponents.compute(t,r).R},this.mds=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("DimensionReduction","mds","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("DimensionReduction","mds","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("DimensionReduction","mds","Invalid function argument.");var r=Math.max(1,Math.round(n));return r>=t[0].length?t:((o=2)<arguments.length&&"string"==typeof arguments[2].metric&&("manhattan"==arguments[2].metric.trim().toLowerCase()&&(o=1),"maximum"==arguments[2].metric.trim().toLowerCase()&&(o=-1),"cosine"==arguments[2].metric.trim().toLowerCase()&&(o=-2)),l(a(t),r))},this.isomap=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("DimensionReduction","isomap","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("DimensionReduction","isomap","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("DimensionReduction","isomap","Invalid function argument.");var r=Math.max(1,Math.round(n));if(r>=t[0].length)return t;var e=5;return(o=2)<arguments.length&&("number"==typeof arguments[2].neighbors&&(e=Math.max(1,Math.min(Math.round(arguments[2].neighbors),t.length-1))),"string"==typeof arguments[2].metric&&("manhattan"==arguments[2].metric.trim().toLowerCase()&&(o=1),"maximum"==arguments[2].metric.trim().toLowerCase()&&(o=-1),"cosine"==arguments[2].metric.trim().toLowerCase()&&(o=-2))),l(function(t,n){for(var r=t.length,e=[],o=0;o<r;o++){for(var i=[],a=0;a<r;a++)a!=o&&i.push([t[o][a],a]);i.sort(function(t,n){return t[0]-n[0]});for(var l=0;l<n;l++)e.push([Math.min(o,i[l][1]),Math.max(o,i[l][1]),i[l][0]])}for(e.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]}),l=e.length-1;0<l;l--)e[l-1][0]==e[l][0]&&e[l-1][1]==e[l][1]&&e.splice(l,1);var z=[],u=[];for(l=0;l<e.length;l++)z.push([e[l][0],e[l][1]]),u.push(e[l][2]);var s=z.length,f=[];for(l=0;l<r;l++)f.push(l);var c=r;for(o=0;o<s;o++)if((i=[f[z[o][0]],f[z[o][1]]])[0]!=i[1]){for(l=0;l<r;l++)f[l]==i[1]&&(f[l]=i[0]);c--}for(l=0;l<r;l++)f[l]=[f[l],l];f.sort(function(t,n){return t[0]-n[0]});var h=f[0][0],d=0;for(l=0;l<r;l++)f[l][0]!=h&&d++,h=f[l][0],f[l].push(d);f.sort(function(t,n){return t[1]-n[1]});for(var g=0;g<c-1;g++)for(var v=g+1;v<c;v++){var m=1e12,b=-1,p=-1;for(o=0;o<r-1;o++)for(a=o+1;a<r;a++)f[o][2]==g&&f[a][2]==v&&t[o][a]<m&&(m=t[o][a],b=o,p=a);z.push([b,p]),u.push(m)}var x=F(r);for(o=0;o<r-1;o++)for(i=Graph.shortest_path_tree(z,o,{weights:u}).distances,a=o+1;a<r;a++)x[o][a]=i[a],x[a][o]=x[o][a];return x}(a(t),e),r)}},Eda=new function(){var T="",O="font-size:14px;font-family:sans-serif;",e="font-size:12px;font-family:sans-serif;",A="stroke-width:2.0;stroke-linejoin:round;stroke-linecap:round;";function c(t){var n=t;if(""==n||1!=GlobalFunctions.is_div(n)){var r=document.createElement("div");""==n&&(n="edaid"+(1e10*Math.random()).toFixed(0)),r.setAttribute("id",n),document.body.appendChild(r)}return document.getElementById(n).style.textAlign="center",n}function E(t,n){if("string"!=typeof t)return"";if("number"!=typeof n)return"";if(""==t)return"";if(n<100)return"";var r='<div style="margin:0 0 20px 0;"><div style="display:inline-block;width:'+n.toFixed(0)+"px;text-align:left;"+e+'">';return r+=t,r+="</div></div>"}function h(t){var n=[];if("object"==typeof t&&0<t.length&&3!=t.length)for(var r=0;r<t.length;r++)n.push(t[r]);else n.push(t);return n}function s(t){return 1==GlobalFunctions.is_vector(t)&&2==t.length&&t[0]<t[1]?[t[0],t[1]]:[1,0]}function k(t,n){if(n<=t)return[n-.1,n,n+.1];for(var r=n-t,e=0;r<10;)r*=10,e--;for(;100<=r;)r/=10,e++;var o=10;r<60&&(o=5),r<24&&(o=2),r<12&&(o=1);for(var i=Math.pow(10,e)*o,a=[Math.floor(t*Math.pow(10,-e)/o)*i];a[a.length-1]<n;)a.push(a[a.length-1]+i);return a}function D(t){for(var n=t[1]-t[0],r=0;n<1-1e-8;)n*=10,r++;return r}function N(t){return Math.abs(t-Math.round(t))<1e-8}function W(t){if(t.opacity<.5)return"#000000";var n=t.rgba;return(n[0]+n[1]+n[2])/3<128?"#ffffff":"#000000"}function f(t){for(var n=t[0],r=t[0],e=1;e<t.length;e++)n=Math.min(n,t[e]),r=Math.max(r,t[e]);return[n,r]}function F(t){for(var n=t[0][0],r=t[0][0],e=0;e<t.length;e++)for(var o=0;o<t[e].length;o++)n=Math.min(n,t[e][o]),r=Math.max(r,t[e][o]);return[n,r]}function u(t){if("object"!=typeof t)return-1;if(t.length<=0)return-1;for(var n=0;n<t.length;n++)if("object"!=typeof t[n])return-1;if(t[0].length<=0)return-1;for(n=1;n<t.length;n++)if(t[n].length!=t[0].length)return-1;return t[0].length}function d(t,n,r){return!(t<0||r<=t)&&("=="==n||"!="==n||"<"==n||">"==n||"<="==n||">="==n)}function g(t,n,r){return"=="==n?t==r:"!="==n?t!=r:"<"==n?t<r:">"==n?r<t:"<="==n?t<=r:">="==n&&r<=t}function w(t,n,r,e){return 40+(r-t)/(n-t)*(e-80)}function X(t,n,r,e){return 40+(r-t)/(n-t)*(e-80)}function v(t,n,r,e,o,i,a){var l=F(t)[1],z=Math.max(200,Math.round(.6*o)),u='<svg viewBox="0 0 '+o.toFixed(0)+" "+z.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+z.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(u+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+z.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var s=W(r),f=[0,l/4,l/2,3*l/4,l],c=D([0,l])+2,h=0;h<f.length;h++){var d=30+h*(z-80)/4;u+='<line x1="60" y1="'+d.toFixed(0)+'" x2="'+(o-30).toFixed(0)+'" y2="'+d.toFixed(0)+'" style="stroke:'+s+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',u+='<line x1="60" y1="'+d.toFixed(0)+'" x2="68" y2="'+d.toFixed(0)+'" style="stroke:'+s+";"+A+'" />',u+='<text x="52" y="'+(d+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+s+';stroke:none;">'+f[4-h].toFixed(c)+"</text>"}var g=(o-100)/((t.length+.8)*t[0].length);if(g=Math.max(2,Math.min(g,100)),"bar"==i)for(h=0;h<t.length;h++)for(var v=e[h%e.length],m=0;m<t[h].length;m++){var b=82+m*(o-112)/t[h].length+g*h;(p=t[h][m]/l*(z-80))<1e-4||(u+='<rect x="'+b.toFixed(3)+'" y="'+(z-50-p).toFixed(0)+'" width="'+g.toFixed(3)+'" height="'+p.toFixed(0)+'" style="fill:'+v.hex+';fill-opacity:0.67;stroke:none;" />')}if("lollipop"==i)for(h=0;h<t.length;h++)for(v=e[h%e.length],m=0;m<t[h].length;m++){b=82+m*(o-112)/t[h].length+g*(h+.5);var p=t[h][m]/l*(z-80);u+='<line x1="'+b.toFixed(3)+'" y1="'+(z-50).toFixed(3)+'" x2="'+b.toFixed(3)+'" y2="'+(z-50-p).toFixed(3)+'" style="stroke:'+v.hex+';stroke-width:2;stroke-linejoin:round;stroke-linecap:round;" />',u+='<circle cx="'+b.toFixed(3)+'" cy="'+(z-50-p).toFixed(3)+'" r="3" style="fill:'+v.hex+';stroke:none;" />'}if(t[0].length<=24)for(m=0;m<t[0].length;m++){u+='<text x="'+((b=82+m*(o-112)/t[0].length)+g*(t.length/2)).toFixed(0)+'" y="'+(z-26).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+s+';stroke:none;">'+m.toFixed(0)+"</text>",1<t.length&&(u+='<rect x="'+b.toFixed(3)+'" y="'+(z-46).toFixed(0)+'" width="'+(g*t.length).toFixed(3)+'" height="2" style="fill:'+s+';stroke:none;" />')}u+="</svg>",document.getElementById(n).innerHTML=u+E(a,o),T=u}function L(t,n,r,e){return 80+(r-t)/(n-t)*(e-120)}function H(t,n,r,e){return e-(r-t)/(n-t)*(e-100)-60}function K(t,n,r,e){var o=r[0]-t[0],i=r[1]-t[1],a=Math.sqrt(o*o+i*i);if(0==a)return-1;var l=(n*n+a*a-e*e)/(2*a),z=n*n-l*l;if(z<=0)return-1;z=Math.sqrt(z);var u=o/a,s=i/a,f=-s,c=u,h=t[0]+l*u,d=t[1]+l*s,g=h-z*f,v=d-z*c;return[[h+=z*f,d+=z*c],[g,v]]}function j(t,n){return Math.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]))}function m(t,n,r,e,o,i,a,l){for(var z=0,u=0,s=0;s<t.length;s++)z+=t[s],u=Math.max(u,t[s]);var f=Math.max(200,Math.round(.6*o)),c='<svg viewBox="0 0 '+o.toFixed(0)+" "+f.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+f.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(c+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+f.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var h=[t[0]],d=1;d<t.length;d++)h.push(h[d-1]+t[d]);for(d=0;d<t.length;d++)h[d]/=z;var g=o/2,v=f/2,m=.4*Math.min(o,f),b=0;for(s=0;s<t.length;s++){var p=e[s%e.length],x=W(p);for(c+='<polygon points="'+g.toFixed(2)+","+v.toFixed(2)+" ";c+=(g+m*Math.sin(2*Math.PI*b)).toFixed(2)+","+(v-m*Math.cos(2*Math.PI*b)).toFixed(2)+" ",(b+=1/360)<h[s];);b=h[s],c+=(g+m*Math.sin(2*Math.PI*b)).toFixed(2)+","+(v-m*Math.cos(2*Math.PI*b)).toFixed(2)+'"',c+=' style="fill:'+p.hex+';fill-opacity:0.9;stroke:none;" />'}var F=D([0,u])+2;for(s=0;s<t.length;s++){x=W(e[s%e.length]);var y="";"index"==i&&(y=s.toFixed(0)),"value"==i&&(y=t[s].toFixed(F)),"percentage"==i&&(y=(100*t[s]/z).toFixed(1)+"%");var M=0<s?h[s-1]+(h[s]-h[s-1])/2:h[0]/2,_=g+.75*m*Math.sin(2*Math.PI*M),G=v-.75*m*Math.cos(2*Math.PI*M);""!=y&&(c+='<text x="'+_.toFixed(0)+'" y="'+(G+5).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+x+';stroke:none;">'+y+"</text>")}"donut"==a&&0!=r.opacity&&(c+='<circle cx="'+g.toFixed(2)+'" cy="'+v.toFixed(2)+'" r="'+(.5*m).toFixed(2)+'" style="fill:'+r.hex+';stroke:none;" />'),c+="</svg>",document.getElementById(n).innerHTML=c+E(l,o),T=c}function _(t,n){var r,e=[255,255,255,0];0<t&&(e=[(r=n[0].rgba)[0],r[1],r[2],Math.round(230*t)]);t<0&&(e=[(r=n[1<n.length?1:0].rgba)[0],r[1],r[2],Math.round(-230*t)]);return GlobalFunctions.get_color(e)}this.svg=function(){if(""==T)return GlobalFunctions.set_error("Eda","svg","No chart calculated yet.");var t="";0<arguments.length&&"string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),""!=t&&1==GlobalFunctions.is_textarea(t)?document.getElementById(t).value=T:Console.print(T)},this.pick=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Eda","pick","Invalid number of function arguments.");var r=u(t);if(r<=0)return GlobalFunctions.set_error("Eda","pick","Invalid function argument.");var e=n;if(1==GlobalFunctions.is_number(e)&&(e=[e]),1!=GlobalFunctions.is_vector(e))return GlobalFunctions.set_error("Eda","pick","Invalid function argument.");for(var o=0;o<e.length;o++)e[o]=Math.round(e[o]);for(o=0;o<e.length;o++)(e[o]<0||e[o]>=r)&&GlobalFunctions.set_error("Eda","pick","Invalid column index.");var i=[];if(2<arguments.length&&("object"==typeof arguments[2].filter&&(3==(z=arguments[2].filter).length&&"number"==typeof z[0]&&"string"==typeof z[1]&&(i=[Math.round(z[0]),z[1],z[2]]),3!=i.length||1!=d(i[0],i[1],r))))return GlobalFunctions.set_error("Eda","pick","Invalid filter definition.");var a=[];if(1==e.length)for(var l=0;l<t.length;l++)3==i.length&&1!=g(t[l][i[0]],i[1],i[2])||a.push(t[l][e[0]]);if(1<e.length)for(l=0;l<t.length;l++)if(3!=i.length||1==g(t[l][i[0]],i[1],i[2])){var z=[];for(o=0;o<e.length;o++)z.push(t[l][e[o]]);a.push(z)}return a},this.count=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","count","Invalid number of function arguments.");var n=u(t);if(n<=0)return GlobalFunctions.set_error("Eda","count","Invalid function argument.");var r=[];if(1<arguments.length&&"object"==typeof arguments[1].filter){var e=arguments[1].filter;if(3==e.length&&"number"==typeof e[0]&&"string"==typeof e[1]&&(r=[Math.round(e[0]),e[1],e[2]]),3!=r.length||1!=d(r[0],r[1],n))return GlobalFunctions.set_error("Eda","count","Invalid filter definition.")}for(var o=0,i=0;i<t.length;i++)3==r.length&&1!=g(t[i][r[0]],r[1],r[2])||o++;return o},this.transpose=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","transpose","Invalid number of function arguments.");var n=u(t);if(n<=0)return GlobalFunctions.set_error("Eda","transpose","Invalid function argument.");for(var r=[],e=0;e<n;e++){for(var o=[],i=0;i<t.length;i++)o.push(t[i][e]);r.push(o)}return r},this.boxplot=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","boxplot","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","boxplot","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(0==n.length)return GlobalFunctions.set_error("Eda","boxplot","Invalid function argument.");for(var r=0;r<n.length;r++){if(1!=GlobalFunctions.is_vector(n[r]))return GlobalFunctions.set_error("Eda","boxplot","Invalid function argument.");if(n[r].length<8)return GlobalFunctions.set_error("Eda","boxplot","At least eight data points required.")}var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600,z=[1,0];1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"object"==typeof arguments[1].range&&(z=s(arguments[1].range))),e=c(e),i=GlobalFunctions.get_color(i);for(r=0;r<a.length;r++)a[r]=GlobalFunctions.get_color(a[r]);!function(t,n,r,e,o,i,a){for(var l=t[0][0],z=t[0][0],u=0;u<t.length;u++)for(var s=0;s<t[u].length;s++)l=Math.min(l,t[u][s]),z=Math.max(z,t[u][s]);i[1]>i[0]&&(l=Math.min(l,i[0]),z=Math.max(z,i[1]));var f=k(l,z);l=Math.min(l,f[0]),z=Math.max(z,f[f.length-1]);var c=80+72*t.length,h='<svg viewBox="0 0 '+o.toFixed(0)+" "+c.toFixed(0)+'" style="width:'+o.toFixed(0)+"px; height:"+c.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(h+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+c.toFixed(0)+'" style="fill:'+r.hex+'; stroke:none;" />');var d=32+72*t.length,g=W(r),v=D(f);for(u=0;u<f.length;u++){var m=w(l,z,f[u],o);h+='<line x1="'+m.toFixed(0)+'" y1="20" x2="'+m.toFixed(0)+'" y2="'+(d+8).toFixed(0)+'" style="stroke:'+g+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',h+='<line x1="'+m.toFixed(0)+'" y1="'+d.toFixed(0)+'" x2="'+m.toFixed(0)+'" y2="'+(d+8).toFixed(0)+'" style="stroke:'+g+";"+A+'" />',h+='<text x="'+m.toFixed(0)+'" y="'+(d+28).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+g+';stroke:none;">'+f[u].toFixed(v)+"</text>"}for(s=0;s<t.length;s++){for(var b=[],p=0;p<t[s].length;p++)b.push(t[s][p]);b.sort(function(t,n){return t-n});var x=b.length,F=u=0,y=[0,0,0];F=.25*x,y[0]=N(F)?.5*(b[Math.round(F)-1]+b[Math.round(F)]):b[Math.floor(F)],F=.5*x,y[1]=N(F)?.5*(b[Math.round(F)-1]+b[Math.round(F)]):b[Math.floor(F)],F=.75*x,y[2]=N(F)?.5*(b[Math.round(F)-1]+b[Math.round(F)]):b[Math.floor(F)];var M=y[2]-y[0],_=[b[0],b[x-1]];for(u=0;_[0]<y[0]-1.5*M;)u++,_[0]=b[u];for(u=x-1;_[1]>y[2]+1.5*M;)u--,_[1]=b[u];d=60+72*s;var G=e[s%e.length];for(y[0]=w(l,z,y[0],o),y[1]=w(l,z,y[1],o),y[2]=w(l,z,y[2],o),w0=w(l,z,_[0],o),w1=w(l,z,_[1],o),h+='<rect x="'+y[0].toFixed(0)+'" y="'+(d-24).toFixed(0)+'" width="'+(y[2]-y[0]).toFixed(0)+'" height="48" style="fill:'+G.hex+";fill-opacity:0.5;stroke:"+G.hex+";"+A+'" />',h+='<line x1="'+y[1].toFixed(0)+'" y1="'+(d-24).toFixed(0)+'" x2="'+y[1].toFixed(0)+'" y2="'+(d+24).toFixed(0)+'" style="fill:none;stroke:'+G.hex+";"+A+'" />',h+='<line x1="'+y[2].toFixed(0)+'" y1="'+d.toFixed(0)+'" x2="'+w1.toFixed(0)+'" y2="'+d.toFixed(0)+'" style="fill:none;stroke:'+G.hex+";"+A+'" />',h+='<line x1="'+w0.toFixed(0)+'" y1="'+d.toFixed(0)+'" x2="'+y[0].toFixed(0)+'" y2="'+d.toFixed(0)+'" style="fill:none;stroke:'+G.hex+";"+A+'" />',h+='<line x1="'+w0.toFixed(0)+'" y1="'+(d-16).toFixed(0)+'" x2="'+w0.toFixed(0)+'" y2="'+(d+16).toFixed(0)+'" style="fill:none;stroke:'+G.hex+";"+A+'" />',h+='<line x1="'+w1.toFixed(0)+'" y1="'+(d-16).toFixed(0)+'" x2="'+w1.toFixed(0)+'" y2="'+(d+16).toFixed(0)+'" style="fill:none;stroke:'+G.hex+";"+A+'" />',p=0;p<b.length;p++)(b[p]<_[0]||b[p]>_[1])&&(h+='<circle cx="'+w(l,z,b[p],o).toFixed(3)+'" cy="'+d.toFixed(0)+'" r="3" style="fill:'+G.hex+';fill-opacity:0.67;stroke:none;" />')}h+="</svg>",document.getElementById(n).innerHTML=h+E(a,o),T=h}(n,e,i,a,l,z,o)},this.density=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","density","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","density","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(0==n.length)return GlobalFunctions.set_error("Eda","density","Invalid function argument.");for(var r=0;r<n.length;r++){if(1!=GlobalFunctions.is_vector(n[r]))return GlobalFunctions.set_error("Eda","density","Invalid function argument.");if(n[r].length<8)return GlobalFunctions.set_error("Eda","density","At least eight data points required.")}var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600,z=[1,0],u=1;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"object"==typeof arguments[1].range&&(z=s(arguments[1].range)),"number"==typeof arguments[1].smoothing&&(u=Math.max(.01,Math.min(Math.abs(arguments[1].smoothing),100)))),e=c(e),i=GlobalFunctions.get_color(i);for(r=0;r<a.length;r++)a[r]=GlobalFunctions.get_color(a[r]);!function(t,n,r,e,o,i,a,l){for(var z=t[0][0],u=t[0][0],s=0;s<t.length;s++)for(var f=0;f<t[s].length;f++)z=Math.min(z,t[s][f]),u=Math.max(u,t[s][f]);u<=z&&(z--,u++),u+=.1*(u-(z-=.1*(u-z))),i[1]>i[0]&&(z=i[0],u=i[1]);var c=[];for(s=0;s<t.length;s++)for(c.push([]),f=0;f<=256;f++)c[s].push(0);for(s=0;s<t.length;s++)for(f=0;f<=256;f++){for(var h=0,d=0;d<t[s].length;d++){var g=(z+f/256*(u-z)-t[s][d])/(z-u);h+=Math.exp(1/a*-400*g*g)}c[s][f]=h}var v=0;for(f=0;f<c.length;f++)for(s=0;s<c[f].length;s++)v=Math.max(v,c[f][s]);var m=Math.max(200,Math.round(.6*o)),b='<svg viewBox="0 0 '+o.toFixed(0)+" "+m.toFixed(0)+'" style="width:'+o.toFixed(0)+"px; height:"+m.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(b+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+m.toFixed(0)+'" style="fill:'+r.hex+'; stroke:none;" />');var p=m-48,x=W(r),F=k(z,u),y=D(F);for(s=0;s<F.length;s++)F[s]<z||F[s]>u||(b+='<line x1="'+(M=X(z,u,F[s],o)).toFixed(0)+'" y1="'+p.toFixed(0)+'" x2="'+M.toFixed(0)+'" y2="'+(p+8).toFixed(0)+'" style="stroke:'+x+";"+A+'" />',b+='<text x="'+M.toFixed(0)+'" y="'+(p+28).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+x+';stroke:none;">'+F[s].toFixed(y)+"</text>");for(s=0;s<4;s++){var M;b+='<line x1="40" y1="'+(M=30+s/4*(m-90)).toFixed(0)+'" x2="'+(o-40).toFixed(0)+'" y2="'+M.toFixed(0)+'" style="stroke:'+x+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />'}for(s=0;s<t.length;s++){var _=e[s%e.length],G='<polyline points="',w='<polyline points="';for(f=0;f<=256;f++){var I=X(z,u,z+f/256*(u-z),o);p=30+(1-c[s][f]/v)*(m-90),w+=(0==f?I.toFixed(2)+","+(m-60).toFixed(2):"")+" "+I.toFixed(2)+","+p.toFixed(2)+(256==f?" "+I.toFixed(2)+","+(m-60).toFixed(2):""),G+=(0==f?"":" ")+I.toFixed(2)+","+p.toFixed(2)}G+='" style="fill:none;stroke:'+_.hex+";"+A+'" />',b+=w+='" style="fill:'+_.hex+';fill-opacity:0.5;stroke:none;" />',b+=G}b+="</svg>",document.getElementById(n).innerHTML=b+E(l,o),T=b}(n,e,i,a,l,z,u,o)},this.histogram=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","histogram","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","histogram","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(0==n.length)return GlobalFunctions.set_error("Eda","histogram","Invalid function argument.");for(var r=0;r<n.length;r++){if(1!=GlobalFunctions.is_vector(n[r]))return GlobalFunctions.set_error("Eda","histogram","Invalid function argument.");if(n[r].length<8)return GlobalFunctions.set_error("Eda","histogram","At least eight data points required.")}var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600,z=[1,0],u=10;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"object"==typeof arguments[1].range&&(z=s(arguments[1].range)),"number"==typeof arguments[1].bins&&(u=Math.max(2,Math.min(Math.round(arguments[1].bins),128)))),e=c(e),i=GlobalFunctions.get_color(i);for(r=0;r<a.length;r++)a[r]=GlobalFunctions.get_color(a[r]);!function(t,n,r,e,o,i,a,l){for(var z=t[0][0],u=t[0][0],s=0;s<t.length;s++)for(var f=0;f<t[s].length;f++)z=Math.min(z,t[s][f]),u=Math.max(u,t[s][f]);u<=z&&(z--,u++);var c=(u-z)/a;z-=.25*c,u+=.25*c,i[0]<i[1]&&(z=i[0],u=i[1]),c=(u-z)/a;var h=[];for(s=0;s<=a;s++)h.push(z+s*c);var d=[];for(f=0;f<t.length;f++){var g=[];for(s=0;s<a;s++)g.push(0);d.push(g)}for(f=0;f<t.length;f++)for(var v=0;v<t[f].length;v++)0<=(x=Math.floor((t[f][v]-z)/c))&&x<d[f].length&&d[f][x]++;var m=0;for(f=0;f<d.length;f++)for(s=0;s<d[f].length;s++)m=Math.max(m,d[f][s]);var b=Math.max(200,Math.round(.6*o)),p='<svg viewBox="0 0 '+o.toFixed(0)+" "+b.toFixed(0)+'" style="width:'+o.toFixed(0)+"px; height:"+b.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(p+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+b.toFixed(0)+'" style="fill:'+r.hex+'; stroke:none;" />');var x=b-48,F=W(r),y=D(h)+1,M=Math.max(1,Math.floor(80/((o-120)/a)));for(s=0;s<h.length;s+=M){var _=80+s*(o-120)/a;p+='<line x1="'+_.toFixed(0)+'" y1="'+x.toFixed(0)+'" x2="'+_.toFixed(0)+'" y2="'+(x+8).toFixed(0)+'" style="stroke:'+F+";"+A+'" />',p+='<text x="'+_.toFixed(0)+'" y="'+(x+28).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+F+';stroke:none;">'+h[s].toFixed(y)+"</text>"}var G=[0,m/4,m/2,3*m/4,m];for(s=0;s<G.length;s++){var w=26+s*(b-86)/4;p+='<line x1="50" y1="'+w.toFixed(0)+'" x2="'+(o-20).toFixed(0)+'" y2="'+w.toFixed(0)+'" style="stroke:'+F+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',p+='<line x1="50" y1="'+w.toFixed(0)+'" x2="58" y2="'+w.toFixed(0)+'" style="stroke:'+F+";"+A+'" />',1==N(G[4-s])&&(p+='<text x="42" y="'+(w+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+F+';stroke:none;">'+G[4-s].toFixed(0)+"</text>")}var I=Math.max(4,(o-120)/a-2);for(s=0;s<d.length;s++){var k=e[s%e.length];for(f=0;f<a;f++){var X=80+f*(o-120)/a;(g=d[s][f]/m*(b-86))<1e-4||(p+='<rect x="'+(X+1).toFixed(3)+'" y="'+(b-60-g).toFixed(0)+'" width="'+I.toFixed(3)+'" height="'+g.toFixed(0)+'" style="fill:'+k.hex+';fill-opacity:0.67;stroke:none;" />')}}p+="</svg>",document.getElementById(n).innerHTML=p+E(l,o),T=p}(n,e,i,a,l,z,u,o)},this.bar=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","bar","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","bar","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","bar","Invalid function argument.");var r=F(n);if(r[0]<0)return GlobalFunctions.set_error("Eda","bar","Negative values not allowed.");if(r[1]<=0)return GlobalFunctions.set_error("Eda","bar","Invalid data.");var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),e=c(e),i=GlobalFunctions.get_color(i);for(var z=0;z<a.length;z++)a[z]=GlobalFunctions.get_color(a[z]);v(n,e,i,a,l,"bar",o)},this.lollipop=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","lollipop","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","lollipop","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","lollipop","Invalid function argument.");var r=F(n);if(r[0]<0)return GlobalFunctions.set_error("Eda","lollipop","Negative values not allowed.");if(r[1]<=0)return GlobalFunctions.set_error("Eda","lollipop","Invalid data.");var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),e=c(e),i=GlobalFunctions.get_color(i);for(var z=0;z<a.length;z++)a[z]=GlobalFunctions.get_color(a[z]);v(n,e,i,a,l,"lollipop",o)},this.area=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","area","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","area","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","area","Invalid function argument.");if(n[0].length<=1)return GlobalFunctions.set_error("Eda","area","Invalid function argument.");var r=F(n);if(r[0]<0)return GlobalFunctions.set_error("Eda","area","Negative values not allowed.");if(r[1]<=0)return GlobalFunctions.set_error("Eda","area","Invalid data.");var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),e=c(e),i=GlobalFunctions.get_color(i);for(var z=0;z<a.length;z++)a[z]=GlobalFunctions.get_color(a[z]);!function(t,n,r,e,o,i){var a=F(t)[1],l=Math.max(200,Math.round(.6*o)),z='<svg viewBox="0 0 '+o.toFixed(0)+" "+l.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+l.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(z+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+l.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var u=W(r),s=[0,a/4,a/2,3*a/4,a],f=D([0,a])+2,c=0;c<s.length;c++){var h=30+c*(l-80)/4;z+='<line x1="60" y1="'+h.toFixed(0)+'" x2="'+(o-30).toFixed(0)+'" y2="'+h.toFixed(0)+'" style="stroke:'+u+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',z+='<line x1="60" y1="'+h.toFixed(0)+'" x2="68" y2="'+h.toFixed(0)+'" style="stroke:'+u+";"+A+'" />',z+='<text x="52" y="'+(h+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+u+';stroke:none;">'+s[4-c].toFixed(f)+"</text>"}var d=(o-120)/(t[0].length-1);for(c=0;c<t.length;c++){for(var g=e[c%e.length],v='<polyline points="',m='<polyline points="',b=0;b<t[c].length;b++){var p=82+b*d,x=t[c][b]/a*(l-80);0==b&&(m+=p.toFixed(2)+","+(l-50).toFixed(2)),m+=" "+p.toFixed(2)+","+(l-50-x).toFixed(2),b==t[c].length-1&&(m+=" "+p.toFixed(2)+","+(l-50).toFixed(2)),v+=(0==b?"":" ")+p.toFixed(2)+","+(l-50-x).toFixed(2)}v+='" style="fill:none;stroke:'+g.hex+";"+A+'" />',z+=m+='" style="fill:'+g.hex+';fill-opacity:0.5;stroke:none;" />',z+=v}if(t[0].length<=24)for(b=0;b<t[0].length;b++)z+='<text x="'+(p=82+b*d).toFixed(0)+'" y="'+(l-26).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+u+';stroke:none;">'+b.toFixed(0)+"</text>";z+="</svg>",document.getElementById(n).innerHTML=z+E(i,o),T=z}(n,e,i,a,l,o)},this.line=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","line","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","line","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","line","Invalid function argument.");if(n[0].length<=1)return GlobalFunctions.set_error("Eda","line","Invalid function argument.");var r="",e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600;1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),r=c(r),o=GlobalFunctions.get_color(o);for(var l=0;l<i.length;l++)i[l]=GlobalFunctions.get_color(i[l]);!function(t,n,r,e,o,i){var a=F(t);a[0]>=a[1]&&(a=[a[1]-.1,a[0]+.1]);var l=Math.max(200,Math.round(.6*o)),z='<svg viewBox="0 0 '+o.toFixed(0)+" "+l.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+l.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(z+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+l.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var u=W(r),s=[a[0],.75*a[0]+.25*a[1],.5*a[0]+.5*a[1],.25*a[0]+.75*a[1],a[1]],f=D(a)+2,c=0;c<s.length;c++){var h=30+c*(l-80)/4;z+='<line x1="60" y1="'+h.toFixed(0)+'" x2="'+(o-30).toFixed(0)+'" y2="'+h.toFixed(0)+'" style="stroke:'+u+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',z+='<line x1="60" y1="'+h.toFixed(0)+'" x2="68" y2="'+h.toFixed(0)+'" style="stroke:'+u+";"+A+'" />',z+='<text x="52" y="'+(h+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+u+';stroke:none;">'+s[4-c].toFixed(f)+"</text>"}var d=(o-120)/(t[0].length-1);for(c=0;c<t.length;c++){for(var g=e[c%e.length],v='<polyline points="',m=0;m<t[c].length;m++){var b=82+m*d,p=(t[c][m]-a[0])/(a[1]-a[0])*(l-80);v+=(0==m?"":" ")+b.toFixed(2)+","+(l-50-p).toFixed(2)}z+=v+='" style="fill:none;stroke:'+g.hex+";"+A+'" />'}if(t[0].length<=24)for(m=0;m<t[0].length;m++)z+='<text x="'+(b=82+m*d).toFixed(0)+'" y="'+(l-26).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+u+';stroke:none;">'+m.toFixed(0)+"</text>";z+="</svg>",document.getElementById(n).innerHTML=z+E(i,o),T=z}(n,r,o,i,a,e)},this.stacked=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","stacked","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","stacked","Invalid function argument.");var n=GlobalFunctions.is_vector(t)?[t]:t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","stacked","Invalid function argument.");var r=F(n);if(r[0]<0)return GlobalFunctions.set_error("Eda","stacked","Negative values not allowed.");if(r[1]<=0)return GlobalFunctions.set_error("Eda","stacked","Invalid data.");var e="",o="",i="#f6f6f6",a=["blue","red","green","yellow","orange"],l=600;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),"string"==typeof arguments[1].caption&&(o=arguments[1].caption),void 0!==arguments[1].background&&(i=arguments[1].background),void 0!==arguments[1].color&&(a=h(arguments[1].color)),"number"==typeof arguments[1].width&&(l=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),e=c(e),i=GlobalFunctions.get_color(i);for(var z=0;z<a.length;z++)a[z]=GlobalFunctions.get_color(a[z]);!function(t,n,r,e,o,i){for(var a=0,l=0;l<t[0].length;l++){for(var z=0,u=0;u<t.length;u++)z+=t[u][l];a=Math.max(a,z)}var s=Math.max(200,Math.round(.6*o)),f='<svg viewBox="0 0 '+o.toFixed(0)+" "+s.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+s.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(f+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+s.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');var c=W(r),h=[0,a/4,a/2,3*a/4,a],d=D([0,a])+2;for(l=0;l<h.length;l++){var g=30+l*(s-80)/4;f+='<line x1="60" y1="'+g.toFixed(0)+'" x2="'+(o-30).toFixed(0)+'" y2="'+g.toFixed(0)+'" style="stroke:'+c+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',f+='<line x1="60" y1="'+g.toFixed(0)+'" x2="68" y2="'+g.toFixed(0)+'" style="stroke:'+c+";"+A+'" />',f+='<text x="52" y="'+(g+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+c+';stroke:none;">'+h[4-l].toFixed(d)+"</text>"}var v=(o-120)/t[0].length,m=[];for(u=0;u<t[0].length;u++)m.push(0);for(l=0;l<t.length;l++){var b=e[l%e.length];for(u=0;u<t[l].length;u++){var p=80+(u+.07)*v;z=t[l][u]/a*(s-80),f+='<rect x="'+p.toFixed(2)+'" y="'+(s-50-z-m[u]).toFixed(2)+'" width="'+(.86*v).toFixed(2)+'" height="'+z.toFixed(2)+'" style="fill:'+b.hex+';fill-opacity:0.67;stroke:none;" />',m[u]+=z}}if(t[0].length<=24)for(u=0;u<t[0].length;u++)f+='<text x="'+(p=80+(u+.5)*v).toFixed(0)+'" y="'+(s-26).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+c+';stroke:none;">'+u.toFixed(0)+"</text>";f+="</svg>",document.getElementById(n).innerHTML=f+E(i,o),T=f}(n,e,i,a,l,o)},this.scatter=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","scatter","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","scatter","Invalid function argument.");var n=GlobalFunctions.is_matrix(t)?[t]:t;if(0==n.length)return GlobalFunctions.set_error("Eda","scatter","Invalid function argument.");for(var r=0;r<n.length;r++){if(1!=GlobalFunctions.is_matrix(n[r]))return GlobalFunctions.set_error("Eda","scatter","Invalid function argument.");if(2!=n[r][0].length)return GlobalFunctions.set_error("Eda","scatter","Invalid function argument.")}var e,o="",i="",a="#f6f6f6",l=["blue","red","green","yellow","orange"],z=600,u=0,s="",f="";1<arguments.length&&("string"==typeof arguments[1].div&&(o=arguments[1].div),"string"==typeof arguments[1].caption&&(i=arguments[1].caption),void 0!==arguments[1].background&&(a=arguments[1].background),void 0!==arguments[1].color&&(l=h(arguments[1].color)),"number"==typeof arguments[1].width&&(z=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"object"==typeof arguments[1].range&&(e=arguments[1].range,u=1==GlobalFunctions.is_matrix(e)&&2==e.length&&2==e[0].length&&e[0][0]<e[0][1]&&e[1][0]<e[1][1]?[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]:0),"string"==typeof arguments[1].labelx&&(s=arguments[1].labelx),"string"==typeof arguments[1].labely&&(f=arguments[1].labely)),o=c(o),a=GlobalFunctions.get_color(a);for(r=0;r<l.length;r++)l[r]=GlobalFunctions.get_color(l[r]);!function(t,n,r,e,o,i,a,l,z){for(var u=t[0][0][0],s=t[0][0][0],f=t[0][0][1],c=t[0][0][1],h=0;h<t.length;h++)for(var d=0;d<t[h].length;d++)u=Math.min(u,t[h][d][0]),s=Math.max(s,t[h][d][0]),f=Math.min(f,t[h][d][1]),c=Math.max(c,t[h][d][1]);s<=u&&(u--,s++),c<=f&&(f--,c++),s+=.02*(s-(u-=.02*(s-u))),c+=.02*(c-(f-=.02*(c-f))),"number"!=typeof i&&(u=i[0][0],s=i[0][1],f=i[1][0],c=i[1][1]);var g=k(u,s),v=k(f,c);"number"==typeof i&&(u=Math.min(u,g[0]),s=Math.max(s,g[g.length-1]),f=Math.min(f,v[0]),c=Math.max(c,v[v.length-1]));var m=.8*o,b='<svg viewBox="0 0 '+o.toFixed(0)+" "+m.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+m.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(b+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+m.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');var p=W(r),x=m-48,F=D(g);for(h=0;h<g.length;h++)g[h]+1e-8<u||g[h]-1e-8>s||(b+='<line x1="'+(M=L(u,s,g[h],o)).toFixed(0)+'" y1="40" x2="'+M.toFixed(0)+'" y2="'+(x+8).toFixed(0)+'" style="stroke:'+p+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',b+='<line x1="'+M.toFixed(0)+'" y1="'+x.toFixed(0)+'" x2="'+M.toFixed(0)+'" y2="'+(x+8).toFixed(0)+'" style="stroke:'+p+";"+A+'" />',b+='<text x="'+M.toFixed(0)+'" y="'+(x+28).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+p+';stroke:none;">'+g[h].toFixed(F)+"</text>");var y=D(v);for(h=0;h<v.length;h++)v[h]+1e-8<f||v[h]-1e-8>c||(b+='<line x1="60" y1="'+(M=H(f,c,v[h],m)).toFixed(0)+'" x2="'+(o-40).toFixed(0)+'" y2="'+M.toFixed(0)+'" style="stroke:'+p+';stroke-width:0.2;stroke-linejoin:round;stroke-linecap:round;" />',b+='<line x1="60" y1="'+M.toFixed(0)+'" x2="68" y2="'+M.toFixed(0)+'" style="stroke:'+p+";"+A+'" />',b+='<text x="52" y="'+(M+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+p+';stroke:none;">'+v[h].toFixed(y)+"</text>");if(""!=a&&(b+='<text x="'+(M=L(u,s,(u+s)/2,o)).toFixed(0)+'" y="30" style="'+O+"text-anchor:middle;fill:"+p+';stroke:none;">'+a+"</text>"),""!=l){var M=H(f,c,(f+c)/2,m);b+='<text x="'+(o-20).toFixed(0)+'" y="'+M.toFixed(0)+'" transform="rotate(270,'+(o-20).toFixed(0)+","+M.toFixed(0)+')" style="'+O+"text-anchor:middle;fill:"+p+';stroke:none;">'+l+"</text>"}var _=Math.max(3,Math.min(o/150,8));for(h=0;h<t.length;h++){var G=e[h%e.length];for(d=0;d<t[h].length;d++)if(!(t[h][d][0]<u||t[h][d][0]>s||t[h][d][1]<f||t[h][d][1]>c)){var w=L(u,s,t[h][d][0],o),I=H(f,c,t[h][d][1],m);b+='<circle cx="'+w.toFixed(3)+'" cy="'+I.toFixed(3)+'" r="'+_.toFixed(1)+'" style="fill:'+G.hex+';fill-opacity:0.8;stroke:none;" />'}}b+="</svg>",document.getElementById(n).innerHTML=b+E(z,o),T=b}(n,o,a,l,z,u,s,f,i)},this.scatter3d=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","scatter3d","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("Eda","scatter3d","Invalid function argument.");var n=GlobalFunctions.is_matrix(t)?[t]:t;if(0==n.length)return GlobalFunctions.set_error("Eda","scatter3d","Invalid function argument.");for(var r=0;r<n.length;r++){if(1!=GlobalFunctions.is_matrix(n[r]))return GlobalFunctions.set_error("Eda","scatter3d","Invalid function argument.");if(3!=n[r][0].length)return GlobalFunctions.set_error("Eda","scatter3d","Invalid function argument.")}var e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600,l=1;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"number"==typeof arguments[1].velocity&&(l=Math.abs(arguments[1].velocity))),e=c(e),o=GlobalFunctions.get_color(o);for(r=0;r<i.length;r++)i[r]=GlobalFunctions.get_color(i[r]);Plot3d.init(a,{background:o.rgba,div:e,velocity:l});for(var z=0;z<n.length;z++){var u=i[z%i.length];Plot3d.list(n[z],{color:u.rgba})}Plot3d.draw()},this.bubble=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","bubble","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Eda","bubble","Invalid function argument.");var n=t;if(f(n)[0]<=0)return GlobalFunctions.set_error("Eda","bubble","All values should be positive.");var r="",e="",o="#f6f6f6",i=["blue"],a=600,l=.05,z="index";1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"number"==typeof arguments[1].margin&&(l=Math.min(1,Math.abs(arguments[1].margin))),"string"==typeof arguments[1].label&&(z=arguments[1].label)),r=c(r),o=GlobalFunctions.get_color(o);for(var u=0;u<i.length;u++)i[u]=GlobalFunctions.get_color(i[u]);!function(t,n,r,e,o,i,a,l){for(var z=[],u=0;u<t.length;u++)z.push([t[u],u]);z.sort(function(t,n){return n[0]-t[0]});var s=z.length,f=[];for(u=0;u<s;u++)f.push(Math.sqrt(z[u][0]));for(u=s-1;0<=u;u--)f[u]=f[u]/f[0];var c=i,h=[[0,0]],d=[];for(1<s&&(h.push([f[0]+f[1]+c/2,0]),d.push([0,1,j(h[0],h[1])])),u=2;u<s;u++){var g=0,v=0,m=0,b=[0,0],p=0;do{g=d[p][0],v=d[p][1],p++;var x=K(h[g],f[g]+f[u]+c,h[v],f[v]+f[u]+c);b=x[0];for(var F=m=0;F<u;F++)j(b,h[F])<f[F]+f[u]+c-1e-8&&m++;if(0<m)for(b=x[1],F=m=0;F<u;F++)j(b,h[F])<f[F]+f[u]+c-1e-8&&m++}while(0<m);h.push([b[0],b[1]]),d.push([g,u,j(h[g],h[u])]),d.push([v,u,j(h[v],h[u])]),d.sort(function(t,n){return n[2]-t[2]})}var y=0,M=0,_=0,G=0;for(u=0;u<s;u++)y=Math.min(y,h[u][0]-f[u]-c),M=Math.max(M,h[u][0]+f[u]+c),_=Math.min(_,h[u][1]-f[u]-c),G=Math.max(G,h[u][1]+f[u]+c);var w=(M+y)/2,I=(G+_)/2,k=0,X=0;for(g=0;g<t.length;g++)k+=t[g],X=Math.max(X,t[g]);var A=D([0,X])+2,N=Math.max(200,Math.round(.6*o)),L=.9*Math.min(o/(M-y),N/(G-_));for(F='<svg viewBox="0 0 '+o.toFixed(0)+" "+N.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+N.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">',0!=r.opacity&&(F+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+N.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />'),g=0;g<s;g++){var H=o/2+(h[g][0]-w)*L,P=N/2+(h[g][1]-I)*L,q=f[g]*L,S=e[z[g][1]%e.length];m=W(S),F+='<circle cx="'+H.toFixed(2)+'" cy="'+P.toFixed(2)+'" r="'+q.toFixed(2)+'" style="fill:'+S.hex+';fill-opacity:0.9;stroke:none;" />';var C="";"index"==a&&(C=z[g][1].toFixed(0)),"value"==a&&(C=t[z[g][1]].toFixed(A)),"percentage"==a&&(C=(100*t[z[g][1]]/k).toFixed(1)+"%"),""!=C&&(F+='<text x="'+H.toFixed(0)+'" y="'+(P+5).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+m+';stroke:none;">'+C+"</text>")}F+="</svg>",document.getElementById(n).innerHTML=F+E(l,o),T=F}(n,r,o,i,a,l,z,e)},this.pie=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","pie","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Eda","pie","Invalid function argument.");var n=t;if(f(n)[0]<=0)return GlobalFunctions.set_error("Eda","pie","All values should be positive.");var r="",e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600,l="index";1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"string"==typeof arguments[1].label&&(l=arguments[1].label)),r=c(r),o=GlobalFunctions.get_color(o);for(var z=0;z<i.length;z++)i[z]=GlobalFunctions.get_color(i[z]);m(n,r,o,i,a,l,"pie",e)},this.donut=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","donut","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Eda","donut","Invalid function argument.");var n=t;if(f(n)[0]<=0)return GlobalFunctions.set_error("Eda","donut","All values should be positive.");var r="",e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600,l="index";1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"string"==typeof arguments[1].label&&(l=arguments[1].label)),r=c(r),o=GlobalFunctions.get_color(o);for(var z=0;z<i.length;z++)i[z]=GlobalFunctions.get_color(i[z]);m(n,r,o,i,a,l,"donut",e)},this.fraction=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","fraction","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Eda","fraction","Invalid function argument.");var n=t;if(f(n)[0]<=0)return GlobalFunctions.set_error("Eda","fraction","All values should be positive.");var r="",e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600,l="index";1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"string"==typeof arguments[1].label&&(l=arguments[1].label)),r=c(r),o=GlobalFunctions.get_color(o);for(var z=0;z<i.length;z++)i[z]=GlobalFunctions.get_color(i[z]);!function(t,n,r,e,o,i,a){for(var l=0,z=0,u=0;u<t.length;u++)l+=t[u],z=Math.max(z,t[u]);var s='<svg viewBox="0 0 '+o.toFixed(0)+" "+120..toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+120..toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(s+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+120..toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var f=[t[0]],c=1;c<t.length;c++)f.push(f[c-1]+t[c]);for(c=0;c<t.length;c++)f[c]/=l;for(u=0;u<t.length;u++){var h=40+(0<u?f[u-1]:0)*(o-80),d=(0<u?f[u]-f[u-1]:f[0])*(o-80),g=e[u%e.length];s+='<rect x="'+h.toFixed(2)+'" y="32" width="'+d.toFixed(2)+'" height="56" style="fill:'+g.hex+';fill-opacity:0.9;stroke:none;" />'}var v=D([0,z])+2;for(u=0;u<t.length;u++){h=40+(0<u?f[u-1]:0)*(o-80),d=(0<u?f[u]-f[u-1]:f[0])*(o-80);var m=W(e[u%e.length]),b="";"index"==i&&(b=u.toFixed(0)),"value"==i&&(b=t[u].toFixed(v)),"percentage"==i&&(b=(100*t[u]/l).toFixed(1)+"%"),""!=b&&(s+='<text x="'+(h+d/2).toFixed(0)+'" y="65" style="'+O+"text-anchor:middle;fill:"+m+';stroke:none;">'+b+"</text>")}s+="</svg>",document.getElementById(n).innerHTML=s+E(a,o),T=s}(n,r,o,i,a,l,e)},this.key=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","key","Invalid number of function arguments.");var n=GlobalFunctions.is_string(t)?[t]:t;if("object"!=typeof n)return GlobalFunctions.set_error("Eda","key","Invalid function argument.");if(n.length<1)return GlobalFunctions.set_error("Eda","key","Invalid function argument.");for(var r=0;r<n.length;r++)if(1!=GlobalFunctions.is_string(n[r]))return GlobalFunctions.set_error("Eda","key","Invalid function argument.");var e="",o="#f6f6f6",i=["blue","red","green","yellow","orange"],a=600;1<arguments.length&&("string"==typeof arguments[1].div&&(e=arguments[1].div),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),e=c(e),o=GlobalFunctions.get_color(o);for(r=0;r<i.length;r++)i[r]=GlobalFunctions.get_color(i[r]);!function(t,n,r,e,o){var i=48+24*(t.length-1),a='<svg viewBox="0 0 '+o.toFixed(0)+" "+i.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+i.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(a+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+i.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var l=W(r),z=0;z<t.length;z++){var u=e[z%e.length];a+='<line x1="40" y1="'+(24+24*z).toFixed(0)+'" x2="60" y2="'+(24+24*z).toFixed(0)+'" style="stroke:'+u.hex+';stroke-width:6.0;stroke-linejoin:round;stroke-linecap:round;" />',a+='<text x="76" y="'+(24+24*z+4).toFixed(0)+'" style="'+O+"fill:"+l+';stroke:none;">'+t[z]+"</text>"}a+="</svg>",document.getElementById(n).innerHTML=a,T=a}(n,e,o,i,a)},this.correlation=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","correlation","Invalid number of function arguments.");var n=t;if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("Eda","correlation","Invalid function argument.");if(n.length<2||n[0].length<2)return GlobalFunctions.set_error("Eda","correlation","Invalid function argument.");var r="",e="",o="#f6f6f6",i=["blue","red"],a=600,l="value",z="circle";1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"string"==typeof arguments[1].caption&&(e=arguments[1].caption),void 0!==arguments[1].background&&(o=arguments[1].background),void 0!==arguments[1].color&&(i=h(arguments[1].color)),"number"==typeof arguments[1].width&&(a=Math.max(200,Math.min(Math.round(arguments[1].width),2e3))),"string"==typeof arguments[1].label&&(l=arguments[1].label),"string"==typeof arguments[1].style&&(z=arguments[1].style)),r=c(r),o=GlobalFunctions.get_color(o);for(var u=0;u<i.length;u++)i[u]=GlobalFunctions.get_color(i[u]);!function(t,n,r,e,o,i,a,l){var z=Statistics.correlation_matrix(t,{display:"off"}),u=z.length,s=Math.max(200,Math.round(.6*o)),f='<svg viewBox="0 0 '+o.toFixed(0)+" "+s.toFixed(0)+'" style="width:'+o.toFixed(0)+"px;height:"+s.toFixed(0)+'px;" xmlns="http://www.w3.org/2000/svg">';0!=r.opacity&&(f+='<rect x="0" y="0" width="'+o.toFixed(0)+'" height="'+s.toFixed(0)+'" style="fill:'+r.hex+';stroke:none;" />');for(var c=o/2,h=s/2,d=Math.min((o-60)/u,(s-60)/u),g=0;g<u;g++)for(var v=0;v<u;v++){var m=c+(v-(u-1)/2)*d,b=h+(g-(u-1)/2)*d,p=_(z[g][v],e);f+="rect"==a?'<rect x="'+(m-d/2).toFixed(2)+'" y="'+(b-d/2).toFixed(2)+'" width="'+d.toFixed(2)+'" height="'+d.toFixed(2)+'" style="fill:'+p.hex+";fill-opacity:"+p.opacity.toFixed(2)+';stroke:none;" />':'<circle cx="'+m.toFixed(2)+'" cy="'+b.toFixed(2)+'" r="'+(.46*d).toFixed(2)+'" style="fill:'+p.hex+";fill-opacity:"+p.opacity.toFixed(2)+';stroke:none;" />';var x=W(p.opacity<.5?r:p),F="";"value"==i&&(F=z[g][v].toFixed(2)),"percentage"==i&&(F=(100*z[g][v]).toFixed(1)+"%"),""!=F&&(f+='<text x="'+m.toFixed(0)+'" y="'+(b+5).toFixed(0)+'" style="'+O+"text-anchor:middle;fill:"+x+';stroke:none;">'+F+"</text>")}var y=(s-60)/25;for(g=0;g<=24;g++)p=_(g/12-1,e),f+='<rect x="'+(c+u/2*d+56).toFixed(2)+'" y="'+(s-30-(g+1)*y).toFixed(2)+'" width="16" height="'+y.toFixed(2)+'" style="fill:'+p.hex+";fill-opacity:"+p.opacity.toFixed(2)+';stroke:none;" />';var M=W(r);f+='<text x="'+(c+u/2*d+50).toFixed(0)+'" y="'+(s-30).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+M+';stroke:none;">-1.00</text>',f+='<text x="'+(c+u/2*d+50).toFixed(0)+'" y="'+(s/2+5).toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+M+';stroke:none;">0.00</text>',f+='<text x="'+(c+u/2*d+50).toFixed(0)+'" y="'+40..toFixed(0)+'" style="'+O+"text-anchor:end;fill:"+M+';stroke:none;">1.00</text>',f+="</svg>",document.getElementById(n).innerHTML=f+E(l,o),T=f}(n,r,o,i,a,l,z,e)},this.headline=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","headline","Invalid number of function arguments.");if(1!=GlobalFunctions.is_string(t))return GlobalFunctions.set_error("Eda","headline","Invalid function argument.");var n="",r=720;1<arguments.length&&("string"==typeof arguments[1].div&&(n=arguments[1].div),"number"==typeof arguments[1].width&&(r=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),n=c(n);var e='<div style="display:inline-block;width:'+r+'px;text-align:left;font-family:sans-serif;line-height:1.2;font-size:20px;font-weight:bold;">'+t+"</div>";document.getElementById(n).style.margin="64px 0 32px 0",document.getElementById(n).innerHTML=e},this.section=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Eda","section","Invalid number of function arguments.");if(1!=GlobalFunctions.is_string(t))return GlobalFunctions.set_error("Eda","section","Invalid function argument.");var n="",r=720;1<arguments.length&&("string"==typeof arguments[1].div&&(n=arguments[1].div),"number"==typeof arguments[1].width&&(r=Math.max(200,Math.min(Math.round(arguments[1].width),2e3)))),n=c(n);var e='<div style="display:inline-block;width:'+r+'px;text-align:left;font-family:sans-serif;line-height:1.4;font-size:16px;">'+t+"</div>";document.getElementById(n).style.margin="32px 0",document.getElementById(n).innerHTML=e}},GeneticAlgorithm=new function(){var f=0,c=0,h=0,d=0,g=[0,0];function v(t,n){var r="x";try{r=t(n),1!=isFinite(r)&&(r="x")}catch(t){r="x"}return"number"==typeof r}function u(t){for(var n=[],r=0;r<t;r++)n.push(r);for(var e=0;e<t;e++){var o=Math.floor(t*Math.random()),i=n[e];n[e]=n[o],n[o]=i}return n}function s(t,n){for(var r=t.length,e=[],o=[],i=0;i<r;i++)e.push(-1);for(i=0;i<r;i++)o.push(-1);var a=[],l=[];for(i=0;i<r;i++)a.push(-1);for(i=0;i<r;i++)l.push(-1);var z=2+Math.floor((r-2)*Math.random()),u=Math.floor(r*Math.random()),s=Math.floor(r*Math.random());for(i=0;i<z;i++)e[(u+i)%r]=n[(s+i)%r],o[(s+i)%r]=t[(u+i)%r],a[n[(s+i)%r]]=(u+i)%r,l[t[(u+i)%r]]=(s+i)%r;for(i=0;i<r;i++)-1==e[i]&&-1==a[t[i]]&&(e[i]=t[i],a[t[i]]=i),-1==o[i]&&-1==l[n[i]]&&(o[i]=n[i],l[n[i]]=i);for(i=0;i<r;i++){if(-1==e[i]){for(var f=t[i];-1!=a[f];)f=t[a[f]];a[e[i]=f]=i}if(-1==o[i]){for(f=n[i];-1!=l[f];)f=n[l[f]];l[o[i]=f]=i}}if(Math.random()<d){u=Math.floor(r*Math.random()),s=Math.floor(r*Math.random()),f=e[u];e[u]=e[s],e[s]=f}if(Math.random()<d){u=Math.floor(r*Math.random()),s=Math.floor(r*Math.random()),f=o[u];o[u]=o[s],o[s]=f}return[e,o]}function m(t){for(var n=[],r=g[1]-g[0],e=0;e<t;e++)n.push(g[0]+r*Math.random());return n}function b(t,n){for(var r=t.length,e=[],o=[],i=0;i<r;i++)e.push(t[i]);for(i=0;i<r;i++)o.push(n[i]);var a=3*Math.random()-1,l=2+Math.floor((r-2)*Math.random()),z=Math.floor(r*Math.random()),u=Math.floor(r*Math.random());for(i=0;i<l;i++)e[(z+i)%r]=a*t[(z+i)%r]+(1-a)*n[(u+i)%r],o[(u+i)%r]=a*n[(u+i)%r]+(1-a)*t[(z+i)%r];if(Math.random()<d){var s=g[1]-g[0];e[Math.floor(r*Math.random())]=g[0]+s*Math.random()}if(Math.random()<d){s=g[1]-g[0];o[Math.floor(r*Math.random())]=g[0]+s*Math.random()}return[e,o]}function p(t){for(var n=[],r=0;r<t;r++)n.push(Math.random()<.5?0:1);return n}function x(t,n){for(var r=t.length,e=[],o=[],i=0;i<r;i++)e.push(t[i]);for(i=0;i<r;i++)o.push(n[i]);var a,l=2+Math.floor((r-2)*Math.random()),z=Math.floor(r*Math.random()),u=Math.floor(r*Math.random());for(i=0;i<l;i++)e[(z+i)%r]=n[(u+i)%r],o[(u+i)%r]=t[(z+i)%r];Math.random()<d&&(e[a=Math.floor(r*Math.random())]=(e[a]+1)%2);Math.random()<d&&(o[a=Math.floor(r*Math.random())]=(o[a]+1)%2);return[e,o]}function F(t){for(var n=[],r=g[1]-g[0],e=0;e<t;e++)n.push(g[0]+Math.floor(r*Math.random()));return n}function y(t,n){for(var r=t.length,e=[],o=[],i=0;i<r;i++)e.push(t[i]);for(i=0;i<r;i++)o.push(n[i]);var a=3*Math.random()-1,l=2+Math.floor((r-2)*Math.random()),z=Math.floor(r*Math.random()),u=Math.floor(r*Math.random());for(i=0;i<l;i++)e[(z+i)%r]=a*t[(z+i)%r]+(1-a)*n[(u+i)%r],o[(u+i)%r]=a*n[(u+i)%r]+(1-a)*t[(z+i)%r],e[(z+i)%r]=Math.max(g[0],Math.min(Math.round(e[(z+i)%r]),g[1])),o[(u+i)%r]=Math.max(g[0],Math.min(Math.round(o[(u+i)%r]),g[1]));if(Math.random()<d){var s=g[1]-g[0];e[Math.floor(r*Math.random())]=g[0]+Math.floor(s*Math.random())}if(Math.random()<d){s=g[1]-g[0];o[Math.floor(r*Math.random())]=g[0]+Math.floor(s*Math.random())}return[e,o]}this.permutation=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("GeneticAlgorithm","permutation","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("GeneticAlgorithm","permutation","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("GeneticAlgorithm","permutation","Invalid function argument.");var r=Math.round(n);if(r<3)return GlobalFunctions.set_error("GeneticAlgorithm","permutation","Permutation too short.");if(h=1e3,f=100,c=800,d=.02,2<arguments.length&&("number"==typeof arguments[2].iterations&&(h=Math.max(1,Math.round(arguments[2].iterations))),"number"==typeof arguments[2].population&&(f=Math.max(2,Math.round(arguments[2].population))),"number"==typeof arguments[2].children&&(c=Math.max(2,Math.round(arguments[2].children))),"number"==typeof arguments[2].mutation_rate&&(d=Math.max(0,Math.min(arguments[2].mutation_rate,1)))),1!=v(t,i=u(r)))return GlobalFunctions.set_error("GeneticAlgorithm","permutation","Invalid input data, method not applicable.");for(var e=[],o=0;o<f;o++){var i=u(r);e.push({x:i,v:t(i)})}e.sort(function(t,n){return t.v-n.v});for(n=0;n<h;n++){for(o=0;o<c;o++){var a=Math.floor(f*Math.pow(Math.random(),2)),l=Math.floor(f*Math.pow(Math.random(),2)),z=s(e[a].x,e[l].x);e.push({x:z[0],v:t(z[0])}),e.push({x:z[1],v:t(z[1])})}e.sort(function(t,n){return t.v-n.v}),e.splice(f)}return e[0].x},this.vector=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("GeneticAlgorithm","vector","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("GeneticAlgorithm","vector","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("GeneticAlgorithm","vector","Invalid function argument.");var r=Math.round(n);if(r<3)return GlobalFunctions.set_error("GeneticAlgorithm","vector","Length of input vector too short.");if(h=1e3,f=100,c=800,d=.02,g=[-1,1],2<arguments.length&&("number"==typeof arguments[2].iterations&&(h=Math.max(1,Math.round(arguments[2].iterations))),"number"==typeof arguments[2].population&&(f=Math.max(2,Math.round(arguments[2].population))),"number"==typeof arguments[2].children&&(c=Math.max(2,Math.round(arguments[2].children))),"number"==typeof arguments[2].mutation_rate&&(d=Math.max(0,Math.min(arguments[2].mutation_rate,1))),0!=GlobalFunctions.is_vector(arguments[2].bounds)&&2==arguments[2].bounds.length)){var e=arguments[2].bounds[0],o=arguments[2].bounds[1];g=[Math.min(e,o),Math.max(e,o)]}if(1!=v(t,l=m(r)))return GlobalFunctions.set_error("GeneticAlgorithm","vector","Invalid input data, method not applicable.");for(var i=[],a=0;a<f;a++){var l=m(r);i.push({x:l,v:t(l)})}i.sort(function(t,n){return t.v-n.v});for(n=0;n<h;n++){for(a=0;a<c;a++){var z=Math.floor(f*Math.pow(Math.random(),2)),u=Math.floor(f*Math.pow(Math.random(),2)),s=b(i[z].x,i[u].x);i.push({x:s[0],v:t(s[0])}),i.push({x:s[1],v:t(s[1])})}i.sort(function(t,n){return t.v-n.v}),i.splice(f)}return i[0].x},this.binary=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("GeneticAlgorithm","binary","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("GeneticAlgorithm","binary","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("GeneticAlgorithm","binary","Invalid function argument.");var r=Math.round(n);if(r<3)return GlobalFunctions.set_error("GeneticAlgorithm","binary","Length of input vector too short.");if(h=1e3,f=100,c=800,d=.02,2<arguments.length&&("number"==typeof arguments[2].iterations&&(h=Math.max(1,Math.round(arguments[2].iterations))),"number"==typeof arguments[2].population&&(f=Math.max(2,Math.round(arguments[2].population))),"number"==typeof arguments[2].children&&(c=Math.max(2,Math.round(arguments[2].children))),"number"==typeof arguments[2].mutation_rate&&(d=Math.max(0,Math.min(arguments[2].mutation_rate,1)))),1!=v(t,i=p(r)))return GlobalFunctions.set_error("GeneticAlgorithm","binary","Invalid input data, method not applicable.");for(var e=[],o=0;o<f;o++){var i=p(r);e.push({x:i,v:t(i)})}e.sort(function(t,n){return t.v-n.v});for(n=0;n<h;n++){for(o=0;o<c;o++){var a=Math.floor(f*Math.pow(Math.random(),2)),l=Math.floor(f*Math.pow(Math.random(),2)),z=x(e[a].x,e[l].x);e.push({x:z[0],v:t(z[0])}),e.push({x:z[1],v:t(z[1])})}e.sort(function(t,n){return t.v-n.v}),e.splice(f)}return e[0].x},this.integer=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("GeneticAlgorithm","integer","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("GeneticAlgorithm","integer","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("GeneticAlgorithm","integer","Invalid function argument.");var r=Math.round(n);if(r<3)return GlobalFunctions.set_error("GeneticAlgorithm","integer","Length of input vector too short.");if(h=1e3,f=100,c=800,d=.02,g=[0,255],2<arguments.length&&("number"==typeof arguments[2].iterations&&(h=Math.max(1,Math.round(arguments[2].iterations))),"number"==typeof arguments[2].population&&(f=Math.max(2,Math.round(arguments[2].population))),"number"==typeof arguments[2].children&&(c=Math.max(2,Math.round(arguments[2].children))),"number"==typeof arguments[2].mutation_rate&&(d=Math.max(0,Math.min(arguments[2].mutation_rate,1))),0!=GlobalFunctions.is_vector(arguments[2].bounds)&&2==arguments[2].bounds.length)){var e=Math.round(arguments[2].bounds[0]),o=Math.round(arguments[2].bounds[1]);g=[Math.min(e,o),Math.max(e,o)]}if(1!=v(t,l=F(r)))return GlobalFunctions.set_error("GeneticAlgorithm","integer","Invalid input data, method not applicable.");for(var i=[],a=0;a<f;a++){var l=F(r);i.push({x:l,v:t(l)})}i.sort(function(t,n){return t.v-n.v});for(n=0;n<h;n++){for(a=0;a<c;a++){var z=Math.floor(f*Math.pow(Math.random(),2)),u=Math.floor(f*Math.pow(Math.random(),2)),s=y(i[z].x,i[u].x);i.push({x:s[0],v:t(s[0])}),i.push({x:s[1],v:t(s[1])})}i.sort(function(t,n){return t.v-n.v}),i.splice(f)}return i[0].x}},GlobalFunctions=new function(){var a={hex:"#000000",opacity:1,rgba:[0,0,0,255]},l=[{s:"black",hex:"#000000",opacity:1,rgba:[0,0,0,255]},{s:"red",hex:"#e01622",opacity:1,rgba:[224,22,34,255]},{s:"green",hex:"#359f2f",opacity:1,rgba:[53,159,47,255]},{s:"blue",hex:"#005bca",opacity:1,rgba:[0,91,202,255]},{s:"orange",hex:"#ff8421",opacity:1,rgba:[255,132,33,255]},{s:"yellow",hex:"#fec806",opacity:1,rgba:[254,200,6,255]},{s:"grey",hex:"#b3b3b3",opacity:1,rgba:[179,179,179,255]},{s:"white",hex:"#ffffff",opacity:1,rgba:[255,255,255,255]},{s:"lightgrey",hex:"#f4f4f4",opacity:1,rgba:[244,244,244,255]},{s:"lime",hex:"#a2c603",opacity:1,rgba:[162,198,3,255]},{s:"indigo",hex:"#6000ff",opacity:1,rgba:[96,0,255,255]},{s:"pink",hex:"#f664cc",opacity:1,rgba:[246,100,204,255]},{s:"violet",hex:"#a300ef",opacity:1,rgba:[163,0,239,255]},{s:"cyan",hex:"#1cafe6",opacity:1,rgba:[28,175,230,255]},{s:"magenta",hex:"#e40086",opacity:1,rgba:[228,0,134,255]},{s:"brown",hex:"#8b5c25",opacity:1,rgba:[139,92,37,255]},{s:"olive",hex:"#638b55",opacity:1,rgba:[99,139,85,255]},{s:"aubergine",hex:"#540a3e",opacity:1,rgba:[84,10,62,255]},{s:"none",hex:"#000000",opacity:0,rgba:[0,0,0,0]}],e=3,z="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ.:abcdefghijklmnopqrstuvwxyz";function o(t,n,r){var e=(t<<16)+(n<<8)+r,o="";return o+=z[e%64],o+=z[(e>>=6)%64],o+=z[(e>>=6)%64],o+=z[(e>>=6)%64]}function i(t,n,r,e){for(var o=0,i=0;i<64;i++)if(e==z[i]){o=i;break}for(i=0;i<64;i++)if(r==z[i]){o=64*o+i;break}for(i=0;i<64;i++)if(n==z[i]){o=64*o+i;break}for(i=0;i<64;i++)if(t==z[i]){o=64*o+i;break}return[(o>>16)%256,(o>>8)%256,o%256]}function u(t){var n="0123456789abcdef",r=n.indexOf(t[0]),e=n.indexOf(t[1]);return-1==r||-1==e?-1:16*r+e}function s(t){var n="0123456789abcdef";return n.charAt((t-t%16)/16)+n.charAt(t%16)}function f(t){for(var n,r=[],e=1,o=0;o<t.length;o++)r.push((n=t[o],Math.max(0,Math.min(Math.round(n),255))));var i="#"+s(r[0])+s(r[1])+s(r[2]);return 4==r.length&&(e=0<r[3]?r[3]/255:0),3==r.length&&r.push(255),{hex:i,opacity:e,rgba:r}}this.is_string=function(t){return"string"==typeof t},this.is_boolean=function(t){return"boolean"==typeof t},this.is_function=function(t){return"function"==typeof t},this.is_number=function(t){return"number"==typeof t&&isFinite(t)},this.is_vector=function(t){if("object"!=typeof t)return!1;var n=t.length;if("number"!=typeof n||n<1)return!1;for(var r=0;r<n;r++)if("number"!=typeof t[r]||1!=isFinite(t[r]))return!1;return!0},this.is_matrix=function(t){if("object"!=typeof t)return!1;var n=t.length;if("number"!=typeof n||n<1)return!1;if("object"!=typeof t[0])return!1;var r=t[0].length;if("number"!=typeof r||r<1)return!1;for(var e=1;e<n;e++)if("object"!=typeof t[e]||t[e].length!=r)return!1;for(e=0;e<n;e++)for(var o=0;o<r;o++)if("number"!=typeof t[e][o]||1!=isFinite(t[e][o]))return!1;return!0},this.is_div=function(t){return"string"==typeof t&&(!!document.getElementById(t)&&"DIV"==document.getElementById(t).nodeName)},this.is_textarea=function(t){return"string"==typeof t&&(!!document.getElementById(t)&&"TEXTAREA"==document.getElementById(t).nodeName)},this.encode_vector=function(t){for(var n=t.length%3,r=n.toFixed(0),e=0;e+2<t.length;e+=3)r+=o(t[e],t[e+1],t[e+2]);return 1==n&&(r+=o(t[e],0,0)),2==n&&(r+=o(t[e],t[e+1],0)),r},this.decode_string=function(t){for(var n=[],r=1;r+3<t.length;)n=n.concat(i(t[r],t[r+1],t[r+2],t[r+3])),r+=4;return"1"==t[0]&&(n.pop(),n.pop()),"2"==t[0]&&n.pop(),n},this.get_color=function(t){return"string"==typeof t?function(t){for(var n=0;n<l.length;n++)if(t==l[n].s)return l[n];var r=t.toLowerCase();if(7!=r.length&&9!=r.length)return a;if("#"!=r[0])return a;var e=[],o=0,i=1;if(-1==(o=u(r[1]+r[2])))return a;if(e.push(o),-1==(o=u(r[3]+r[4])))return a;if(e.push(o),-1==(o=u(r[5]+r[6])))return a;if(e.push(o),9==r.length){if(-1==(o=u(r[7]+r[8])))return a;i=0<o?o/255:0}else o=255;return e.push(o),{hex:r.substring(0,7),opacity:i,rgba:e}}(t):"number"==typeof t?(n=t,r=6*Math.max(0,Math.min(n,1)),f([255*Math.max(2-r,r-4),255*Math.min(r,4-r),255*Math.min(r-2,6-r)])):1==function(t){if("object"!=typeof t)return!1;var n=t.length;if("number"!=typeof n||n<3||4<n)return!1;for(var r=0;r<n;r++)if("number"!=typeof t[r])return!1;return!0}(t)?f(t):a;var n,r},this.get_color_table=function(){return l},this.set_error=function(t,n,r){return 0<e&&(popup("Error in "+t+"."+n+": "+r),e--),r},this.set_warning=function(t,n,r){return 0<e&&(popup("Warning in "+t+"."+n+": "+r),e--),r}},Graph=new function(){function d(t){for(var n=t.length,r=0,e=[],o=0;o<n;o++){var i=[Math.round(t[o][0]),Math.round(t[o][1])];e.push([Math.min(i[0],i[1]),Math.max(i[0],i[1])]),r=Math.min(r,Math.min(i[0],i[1]))}if(r<0)for(o=0;o<n;o++)e[o][0]-=r,e[o][1]-=r;return e}function g(t){for(var n=0,r=0;r<t.length;r++)n=Math.max(n,Math.max(t[r][0],t[r][1]));return n+1}function c(t){for(var n=t.length,r=0;r<n;r++)if(t[r][0]==t[r][1])return!1;var e=[];for(r=0;r<n;r++)e.push([Math.min(t[r][0],t[r][1]),Math.max(t[r][0],t[r][1])]);e.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(r=1;r<n;r++)if(e[r-1][0]==e[r][0]&&e[r-1][1]==e[r][1])return!1;return!0}function h(t){for(var n=t.length,r=g(t),e=[],o=0;o<r;o++)e.push([]);for(var i=0;i<n;i++)e[t[i][0]].push(t[i][1]),e[t[i][1]].push(t[i][0]);return e}function i(t,n,r){if(r.length<2)return[360];for(var e=[],o=0;o<r.length;o++){var i=[t[r[o]][0]-t[n][0],t[r[o]][1]-t[n][1]],a=180/Math.PI*Math.atan2(i[1],i[0]);a<0&&(a+=360),e.push(a)}e.sort(function(t,n){return t-n});var l=[];for(o=1;o<e.length;o++)l.push(e[o]-e[o-1]);return l.push(e[0]+(360-e[e.length-1])),l.sort(function(t,n){return t-n})}function f(t,n){for(var r=[],e=0;e<t.length;e++)r.push(i(n,e,t[e]));var o=360;for(e=0;e<t.length;e++)o=Math.min(o,r[e][0]);return o}function v(t,n){for(var r=0;r<n.length;r++)if(n[r]==t)return!0;return!1}function m(t){for(var n=g(t),r=t.length,e=h(t),o=0;o<n;o++)e[o].push(o);var i=[];for(o=0;o<n;o++)i.push([]);for(var a=0;a<r;a++)for(o=0;o<n;o++)1==v(t[a][0],e[o])&&1==v(t[a][1],e[o])&&i[o].push([t[a][0],t[a][1]]);for(var l=[],z=0;z<n;z++){for(var u=0,s=-1;u<n;){var f=e[u].length;0<f&&i[u].length==Math.round(f*(f-1)/2)&&(s=u,u=n),u++}if(-1==s)return"Graph is not chordal";l.push(s),e[s]=[],i[s]=[];for(o=0;o<n;o++)for(a=0;a<e[o].length;)e[o][a]==s?e[o].splice(a,1):a++;for(o=0;o<n;o++)for(a=0;a<i[o].length;)i[o][a][0]==s||i[o][a][1]==s?i[o].splice(a,1):a++}return l}function b(t){for(var n=g(t),r=h(t),e=[],o=0;o<n;o++)e.push([0,-1]);for(var i=n,a=[];0<i;){for(var l=0;0!=e[l][0];)l++;for(a.push(l),e[l]=[1,0];0<a.length;){var z=a[0];a.splice(0,1),i--;var u=(e[z][1]+1)%2;for(o=0;o<r[z].length;o++){var s=r[z][o];if(e[s][1]<0)e[s][1]=u;else if(e[s][1]!=u)return"fail";0==e[s][0]&&(a.push(s),e[s][0]=1)}}}var f=[],c=[];for(o=0;o<n;o++)0==e[o][1]?f.push(o):c.push(o);return{L:f,R:c}}function p(t,n,r,e){for(var o=g(t),i=function(t,n){for(var r=t.length,e=g(t),o=[],i=0;i<e;i++)o.push([]);for(var a=0;a<r;a++)o[t[a][0]].push([t[a][1],a]),o[t[a][1]].push([t[a][0],a]);return o}(t),a=[],l=0;l<o;l++)a.push([0,-1,-1,-1]);var z=n;for(a[z][2]=0;0<=z;){a[z][0]=1;for(l=0;l<i[z].length;l++){var u=i[z][l][0],s=a[z][2]+e[i[z][l][1]];(a[u][2]<0||s<a[u][2])&&(a[u][1]=z,a[u][2]=s,a[u][3]=i[z][l][1])}var f=z=-1;for(l=0;l<o;l++)0==a[l][0]&&0<=a[l][2]&&(f<0||a[l][2]<f)&&(f=a[z=l][2]);0<=r&&1==a[r][0]&&(z=-1)}return a}function s(t,n,r,e,o,i){var a=function(t,n){for(var r=[t[0][0],t[0][0]],e=[t[0][1],t[0][1]],o=1;o<t.length;o++)r[0]=Math.min(r[0],t[o][0]),r[1]=Math.max(r[1],t[o][0]),e[0]=Math.min(e[0],t[o][1]),e[1]=Math.max(e[1],t[o][1]);var i=r[1]-r[0],a=e[1]-e[0],l=Math.max(i,a);l<=0&&(l=1);var z=i<l?(l-i)/2:0,u=a<l?(l-a)/2:0,s=[];for(o=0;o<t.length;o++)s.push([n*((t[o][0]-r[0]+z)/l*.8+.1),n*((t[o][1]-e[0]+u)/l*.8+.1)]);return s}(n,e/100);Sketch.init([0,e],[0,e],{width:e,background:"#f2f2f2"});for(var l=0;l<t.length;l++)Sketch.line(100*a[t[l][0]][0],100*a[t[l][0]][1],100*a[t[l][1]][0],100*a[t[l][1]][1]);if(r.length==t.length)for(l=0;l<t.length;l++){var z=50*(a[t[l][0]][0]+a[t[l][1]][0]),u=50*(a[t[l][0]][1]+a[t[l][1]][1]);Sketch.rect(z,u,40,18),Sketch.text(z,u-1,r[l].toFixed(1),{fill:"#ffffff"})}for(var s=["blue","red","green","yellow","orange","violet","pink","cyan","magenta","indigo"],f=0;f<a.length;f++)"small"!=i?(Sketch.circle(100*a[f][0],100*a[f][1],12,{fill:s[o[f]%s.length],stroke:"#f2f2f2"}),Sketch.text(100*a[f][0],100*a[f][1]-1,f.toFixed(0),{fill:"#ffffff"})):Sketch.circle(100*a[f][0],100*a[f][1],6,{fill:s[o[f]%s.length],stroke:"#f2f2f2"});Sketch.draw()}this.adjacency_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","adjacency_matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","adjacency_matrix","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","adjacency_matrix","Invalid function argument.");for(var n=d(t),r=g(n),e=[],o=0;o<r;o++){e.push([]);for(var i=0;i<r;i++)e[o].push(0)}for(var a=0;a<n.length;a++)e[n[a][0]][n[a][1]]++,e[n[a][1]][n[a][0]]++;return e},this.incidence_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","incidence_matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","incidence_matrix","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","incidence_matrix","Invalid function argument.");for(var n=d(t),r=n.length,e=g(n),o=[],i=0;i<e;i++){o.push([]);for(var a=0;a<r;a++)o[i].push(0)}for(var l=0;l<n.length;l++)o[n[l][0]][l]++,o[n[l][1]][l]++;return o},this.random=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","random","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Graph","random","Invalid function argument.");for(var n=Math.max(3,Math.round(t)),r=ComputationalGeometry.random_points(n),e=ComputationalGeometry.delaunay(r),o=[],i=0;i<e.length;i++){var a=[e[i][0],e[i][1],e[i][2]];a.sort(function(t,n){return t-n}),o.push([a[0],a[1]]),o.push([a[0],a[2]]),o.push([a[1],a[2]])}o.sort(function(t,n){return t[0]!=n[0]?t[0]-n[0]:t[1]-n[1]});for(i=o.length-1;0<i;i--)o[i-1][0]==o[i][0]&&o[i-1][1]==o[i][1]&&o.splice(i,1);var l,z,u=[];for(i=0;i<o.length;i++)u.push((l=r[o[i][0]],z=r[o[i][1]],Math.sqrt((l[0]-z[0])*(l[0]-z[0])+(l[1]-z[1])*(l[1]-z[1]))));return{E:o,L:r,w:u}},this.complete=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","complete","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Graph","complete","Invalid function argument.");for(var n=Math.max(3,Math.round(t)),r=[],e=0;e<n;e++)r.push([50+40*Math.cos(2*Math.PI*e/n),50+40*Math.sin(2*Math.PI*e/n)]);for(var o=[],i=0;i<n-1;i++)for(var a=i+1;a<n;a++)o.push([i,a]);var l=[];for(e=0;e<o.length;e++)l.push(1);return{E:o,L:r,w:l}},this.interval=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","interval","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Graph","interval","Invalid function argument.");for(var n=Math.max(3,Math.round(t)),r=[],e=0,o=0;o<n;o++)r.push([e,e+.5+6*Math.random()]),e+=1.2+Math.random();r[n-1][0]>=r[n-2][1]&&(r[n-1][0]=r[n-2][1]-.1);var i=[];for(o=0;o<n-1;o++)for(var a=o+1,l=0;a<n&&0==l;)r[a][0]<=r[o][1]?i.push([o,a]):l=1,a++;var z=function(t,n){for(var r=h(t);r.length<n;)r.push([]);for(var e=[],o=0;o<n;o++)e.push([o,6*Math.random()]);var i=f(r,e);for(o=0;o<2e3/n;o++){var a=Math.floor(n*Math.random()),l=Math.floor(n*Math.random()),z=e[a][1],u=e[l][1];e[a][1]=6*Math.random(),e[l][1]=6*Math.random();var s=f(r,e);s<i?(e[a][1]=z,e[l][1]=u):i=s}return e}(i,n),u=[];for(o=0;o<i.length;o++)u.push(1);return{E:i,L:z,w:u,I:r}},this.perfect_elimination=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","perfect_elimination","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","perfect_elimination","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","perfect_elimination","Invalid function argument.");var n=d(t);if(1!=c(n))return GlobalFunctions.set_error("Graph","perfect_elimination","Graph is not simple.");var r=m(n);return"string"==typeof r?GlobalFunctions.set_error("Graph","perfect_elimination",r):r},this.coloring=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","coloring","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","coloring","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","coloring","Invalid function argument.");var n=d(t);if(1!=c(n))return GlobalFunctions.set_error("Graph","coloring","Graph is not simple.");var r=m(n);if("string"==typeof r)return GlobalFunctions.set_error("Graph","coloring",r);var e=h(n);if(e.length!=r.length)return GlobalFunctions.set_error("Graph","coloring","Unexpected failure.");for(var o=e.length,i=[],a=0;a<o;a++)i.push(-1);for(a=o-1;0<=a;a--){for(var l=r[a],z=[],u=0;u<e[l].length;u++)-1!=i[e[l][u]]&&z.push(i[e[l][u]]);z.sort(function(t,n){return t-n});var s=-1,f=0;for(z.length<1?s=0:0<z[0]&&(s=0);-1==s&&f<z.length-1;)1<z[f+1]-z[f]&&(s=z[f]+1),f++;-1==s&&(s=z[z.length-1]+1),i[l]=s}return i},this.spanning_tree=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","spanning_tree","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","spanning_tree","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","spanning_tree","Invalid function argument.");for(var n=[],r=0;r<t.length;r++)n.push(1);if(1<arguments.length&&"object"==typeof arguments[1].weights){var e=arguments[1].weights;1==GlobalFunctions.is_vector(e)&&e.length==t.length&&(n=e)}return function(t,n){for(var r=t.length,e=g(t),o=[],i=0;i<n.length;i++)o.push([n[i],i]);o.sort(function(t,n){return t[0]-n[0]});var a=[];for(i=0;i<n.length;i++)a.push(o[i][1]);for(var l=[],z=[],u=new Array(e),s=0;s<e;s++)u[s]=s;var f=e;for(i=0;i<r;i++){var c=[u[t[a[i]][0]],u[t[a[i]][1]]];if(c[0]!=c[1]){for(l.push([t[a[i]][0],t[a[i]][1]]),z.push(n[a[i]]),s=0;s<e;s++)u[s]==c[1]&&(u[s]=c[0]);1==--f&&(i=r)}}return{E:l,w:z}}(t,n)},this.bipartite=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","bipartite","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","bipartite","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","bipartite","Invalid function argument.");var n=b(d(t));return"string"==typeof n?GlobalFunctions.set_error("Graph","bipartite","Graph is not bipartite."):{L:n.L,R:n.R}},this.shortest_path=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Graph","shortest_path","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","shortest_path","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","shortest_path","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Graph","shortest_path","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Graph","shortest_path","Invalid function argument.");var e=d(t),o=g(e),i=Math.round(n),a=Math.round(r);if(i<0||o<=i)return GlobalFunctions.set_error("Graph","shortest_path","Source node is not a vertex of the graph.");if(a<0||o<=a)return GlobalFunctions.set_error("Graph","shortest_path","Target node is not a vertex of the graph.");for(var l=[],z=0;z<e.length;z++)l.push(1);if(3<arguments.length&&"object"==typeof arguments[3].weights){var u=arguments[3].weights;1==GlobalFunctions.is_vector(u)&&u.length==e.length&&(l=u)}for(z=0;z<l.length;z++)if(l[z]<0)return GlobalFunctions.set_error("Graph","shortest_path","Non-negativ weights expected.");if(i==a)return{nodes:[i],edges:[],distance:0};var s=p(e,i,a,l);if(-1==s[a][1])return GlobalFunctions.set_error("Graph","shortest_path","Path does not exist.");for(var f=a,c=[f],h=[];-1<s[f][1];)h.push(s[f][3]),f=s[f][1],c.push(f);return{nodes:c.reverse(),edges:h.reverse(),distance:s[a][2]}},this.shortest_path_tree=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Graph","shortest_path_tree","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","shortest_path_tree","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","shortest_path_tree","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Graph","shortest_path_tree","Invalid function argument.");var r=d(t),e=g(r),o=Math.round(n);if(o<0||e<=o)return GlobalFunctions.set_error("Graph","shortest_path_tree","Source node is not a vertex of the graph.");for(var i=[],a=0;a<r.length;a++)i.push(1);if(2<arguments.length&&"object"==typeof arguments[2].weights){var l=arguments[2].weights;1==GlobalFunctions.is_vector(l)&&l.length==r.length&&(i=l)}for(a=0;a<i.length;a++)if(i[a]<0)return GlobalFunctions.set_error("Graph","shortest_path_tree","Non-negativ weights expected.");var z=p(r,o,-1,i),u=[],s=[];for(a=0;a<z.length;a++)-1<z[a][3]&&(u.push([r[z[a][3]][0],r[z[a][3]][1]]),s.push(i[z[a][3]]));if(0==u.length)return GlobalFunctions.set_error("Graph","shortest_path_tree","Source node is not connected to any other node of the graph.");var f=[];for(a=0;a<e;a++)f.push(z[a][2]);return{E:u,w:s,distances:f}},this.properties=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","properties","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","properties","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","properties","Invalid function argument.");for(var n=d(t),r=g(n),e=n.length,o=c(n),i=function(t){for(var n=t.length,r=g(t),e=new Array(r),o=0;o<r;o++)e[o]=o;for(var i=r,a=0;a<n;a++){var l=[e[t[a][0]],e[t[a][1]]];if(l[0]!=l[1]){for(o=0;o<r;o++)e[o]==l[1]&&(e[o]=l[0]);i--}}return i}(n),a=h(n),l=b(n),z=1==o?m(n):"x",u=0,s=0;s<a.length;s++)u=Math.max(u,a[s].length);return{nodes:r,edges:e,simple:o,connected:1==i,tree:1==o&&1==i&&e==r-1,bipartite:"string"!=typeof l,chordal:"string"!=typeof z,degree:u,components:i}},this.plot=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Graph","plot","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Graph","plot","Invalid function argument.");if(2!=t[0].length)return GlobalFunctions.set_error("Graph","plot","Invalid function argument.");var n=d(t);1!=c(n)&&GlobalFunctions.set_warning("Graph","plot","Graph is not simple.");for(var r=g(n),e=480,o=[],i=[],a=0;a<r;a++)i.push([Math.cos(2*Math.PI*a/r),Math.sin(2*Math.PI*a/r)]);var l=[];for(a=0;a<r;a++)l.push(0);var z="large";if(1<arguments.length){if("number"==typeof arguments[1].width&&(e=Math.max(100,Math.min(Math.round(arguments[1].width),16384))),"object"==typeof arguments[1].weights){var u=arguments[1].weights;1==GlobalFunctions.is_vector(u)&&u.length==n.length&&(o=u)}if("object"==typeof arguments[1].locations){u=arguments[1].locations;1==GlobalFunctions.is_matrix(u)&&u.length==r&&2==u[0].length&&(i=u)}if("object"==typeof arguments[1].coloring){u=arguments[1].coloring;1==GlobalFunctions.is_vector(u)&&u.length==r&&(l=u)}"string"==typeof arguments[1].style&&(z=arguments[1].style)}s(n,i,o,e,l,z)}},Grid=new function(){var u=0,s=0,f=0,c=null,h="",d=1,g=!1,v=[],m="svg";function n(){var t=u,n=u*(f/s),r=u/s,e=t.toFixed(0),o=n.toFixed(0),i='<svg viewBox="0 0 '+e+" "+o+'" style="width:'+e+"px; height:"+o+'px;" xmlns="http://www.w3.org/2000/svg">';0!=c.opacity&&(i+='<rect x="0" y="0" width="'+t.toFixed(3)+'" height="'+n.toFixed(3)+'" ',i+='style="fill:'+c.hex+"; ",i+=c.opacity<1?"fill-opacity:"+c.opacity.toFixed(3)+"; ":"",i+='stroke:none;" />');for(var a=0;a<f;a++)for(var l=0;l<s;l++)0!=v[a][l].opacity&&(i+='<rect x="'+(l*r).toFixed(3)+'" y="'+(n-(a+1)*r).toFixed(3)+'" width="'+r.toFixed(3)+'" height="'+r.toFixed(3)+'" ',i+='style="fill:'+v[a][l].hex+"; ",i+=v[a][l].opacity<1?"fill-opacity:"+v[a][l].opacity.toFixed(3)+"; ":"",i+='stroke:none;" />');return i+="</svg>"}function b(){v=[];for(var t=0;t<f;t++){v.push([]);for(var n=0;n<s;n++)v[t].push(GlobalFunctions.get_color("none"))}}this.draw=function(){if(1!=g)return GlobalFunctions.set_error("Grid","draw","Grid not initialized yet.");"canvas"==m?function(){var t=s*d,n=f*d,r="canvas-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(h).innerHTML='<canvas id="'+r+'" width="'+t+'" height="'+n+'"></canvas>';for(var e=document.getElementById(r).getContext("2d"),o=e.createImageData(t,n),i=0;i<o.data.length;i+=4){var a=Math.floor(i/4),l=n-Math.floor(a/t)-1,z=a%t;l=Math.floor(l/d),z=Math.floor(z/d),0==v[l][z].opacity?0==c.opacity?(o.data[i+0]=0,o.data[i+1]=0,o.data[i+2]=0,o.data[i+3]=0):(o.data[i+0]=c.rgba[0],o.data[i+1]=c.rgba[1],o.data[i+2]=c.rgba[2],o.data[i+3]=c.rgba[3]):(o.data[i+0]=v[l][z].rgba[0],o.data[i+1]=v[l][z].rgba[1],o.data[i+2]=v[l][z].rgba[2],o.data[i+3]=v[l][z].rgba[3])}e.putImageData(o,0,0)}():document.getElementById(h).innerHTML=n()},this.svg=function(){if(1!=g)return GlobalFunctions.set_error("Grid","svg","Grid not initialized yet.");var t="";0<arguments.length&&"string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(n()):document.getElementById(t).value=n()},this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Grid","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Grid","init","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Grid","init","Invalid function argument.");var r=480,e="none",o="svg",i="on",a="",l=1;if(2<arguments.length&&("number"==typeof arguments[2].width&&(r=Math.max(2,Math.round(arguments[2].width))),void 0!==arguments[2].background&&(e=arguments[2].background),"string"==typeof arguments[2].style&&(o=arguments[2].style),"string"==typeof arguments[2].scaling&&(i=arguments[2].scaling),"string"==typeof arguments[2].div&&(a=arguments[2].div),"number"==typeof arguments[2].zoom&&(l=Math.max(1,Math.min(Math.round(arguments[2].zoom),1024)))),""==a||1!=GlobalFunctions.is_div(a)){var z=document.createElement("div");""==a&&(a="random-id-"+(1e10*Math.random()).toFixed(0)),z.setAttribute("id",a),document.body.appendChild(z)}h=a,s=Math.max(1,Math.round(t)),f=Math.max(1,Math.round(n)),c=GlobalFunctions.get_color(e),m=o,d=l,function(t,n){if(u=t,"off"!=n){var r="random-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(h).innerHTML='<div id="'+r+'" style="height:2000px; padding:0; margin:0;"></div>',u=Math.min(t,Math.round(document.getElementById(r).clientWidth))}}(r,i),b(),document.getElementById(h).style.textAlign="center",document.getElementById(h).innerHTML="",g=!0},this.clear=function(){if(1!=g)return GlobalFunctions.set_error("Grid","clear","Grid not initialized yet.");b()},this.pixel=function(t,n,r){if(1!=g)return GlobalFunctions.set_error("Grid","pixel","Grid not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Grid","pixel","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Grid","pixel","Invalid function argument.");var e=Math.round(n),o=Math.round(t);if(e<0||f<=e||o<0||s<=o)return GlobalFunctions.set_warning("Grid","pixel","Pixel coordinates out of range.");v[e][o]=GlobalFunctions.get_color(r)}},Integrate=new function(){function s(t,n){for(var r=n.length-1,e=new Array(r+1),o=0;o<=r;o++)e[o]=t(n[o]);var i=n[r]-n[0],a=r,l=1,z=new Array,u=new Array;do{var s=0;for(o=l;o<r;o+=l)s+=e[o];s+=(e[0]+e[r])/2,z.push(i*i/(a*a)),u.push(s*i/a),a/=2,l*=2}while(a%2==0);return function(t,n,r){for(var e=t.length,o=new Array(e),i=0;i<e;i++)o[i]=n[i];for(i=1;i<e;i++)for(var a=e-1;i<=a;a--)o[a]+=(r-t[a])*(o[a]-o[a-1])/(t[a]-t[a-i]);return o[e-1]}(z,u,0)}this.func=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Integrate","func","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("Integrate","func","Invalid function argument.");if(1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Integrate","func","Invalid function argument.");if(1!=function(t,n){var r=!1;try{var e=t(n);"number"==typeof e&&1==isFinite(e)&&(r=!0)}catch(t){r=!1}return r}(t,n))return GlobalFunctions.set_error("Integrate","func","Function should return a real number for all real-valued arguments.");var e=Math.min(n,r),o=Math.max(n,r),i="romberg",a=256;if(3<arguments.length&&("string"==typeof arguments[3].method&&(i=arguments[3].method),"number"==typeof arguments[3].n&&(a=Math.max(2,Math.min(Math.round(arguments[3].n),8192)))),"romberg"==i&&256!=a){for(var l=2;2*l<=a;)l*=2;a=l}for(var z=[],u=0;u<=a;u++)z.push(e+u/a*(o-e));return"trapezoid"==i?function(t,n){for(var r=n.length-1,e=new Array(r+1),o=0;o<=r;o++)e[o]=t(n[o]);var i=0;for(o=1;o<r;o++)i+=e[o];return(i+=(e[0]+e[r])/2)*(n[r]-n[0])/r}(t,z):"simpson"==i?function(t,n){for(var r=n.length-1,e=new Array(r+1),o=0;o<=r;o++)e[o]=t(n[o]);var i=new Array(r);for(o=0;o<r;o++)i[o]=t(.5*(n[o]+n[o+1]));var a=0;for(o=1;o<r;o++)a+=e[o];var l=0;for(o=0;o<r;o++)l+=i[o];return((e[0]+e[r])/6+a/3+2*l/3)*(n[r]-n[0])/r}(t,z):s(t,z)}},Interpolate=new function(){function F(t,n,r,e,o){if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Interpolate",e,"Invalid function argument.");if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("Interpolate",e,"Invalid function argument.");if(1!=GlobalFunctions.is_number(r)&&1!=GlobalFunctions.is_vector(r))return GlobalFunctions.set_error("Interpolate",e,"Invalid function argument.");if(t.length!=n.length)return GlobalFunctions.set_error("Interpolate",e,"Improper matrix or vector dimension.");var i=t.length;if(i<o)return GlobalFunctions.set_error("Interpolate",e,"Invalid input data, method not applicable.");for(var a=[],l=0;l<i;l++)a.push([t[l],n[l]]);a.sort(function(t,n){return t[0]-n[0]});var z=[],u=[];for(l=0;l<i;l++)z.push(a[l][0]),u.push(a[l][1]);for(l=0;l<i-1;l++)if(z[l]>=z[l+1])return GlobalFunctions.set_error("Interpolate",e,"Invalid input data, method not applicable.");return[z,u]}this.linear=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Interpolate","linear","Invalid number of function arguments.");var e=F(t,n,r,"linear",2);if("string"==typeof e)return e;var o=e[0],i=e[1],a=o.length,l=r;"number"==typeof r&&(l=[r]);for(var z=[],u=0;u<l.length;u++){var s=l[u],f=0,c=a-1;if(s<=o[1])c=1;else if(s>=o[a-2])f=a-2;else for(;1<c-f;){var h=Math.floor((c+f)/2);o[h]>s?c=h:f=h}var d=(i[c]-i[f])/(o[c]-o[f]);z.push(i[f]+(s-o[f])*d)}return"number"==typeof r?z[0]:z},this.akima=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Interpolate","akima","Invalid number of function arguments.");var e=F(t,n,r,"akima",3);if("string"==typeof e)return e;for(var o=e[0],i=e[1],a=o.length,l=new Array(a+3),z=0;z<a-1;z++)l[z+2]=(i[z+1]-i[z])/(o[z+1]-o[z]);l[a+1]=2*l[a]-l[a-1],l[a+2]=2*l[a+1]-l[a],l[1]=2*l[2]-l[3],l[0]=2*l[1]-l[2];var u=new Array(a);for(z=0;z<a;z++){var s=(b=Math.abs(l[z+3]-l[z+2]))+(m=Math.abs(l[z+1]-l[z]));u[z]=0!=s?(b*l[z+1]+m*l[z+2])/s:(l[z+2]+l[z+1])/2}var f=r;"number"==typeof r&&(f=[r]);var c=[];for(z=0;z<f.length;z++){for(var h=f[z],d=0,g=a-1;1<g-d;){var v=Math.floor((g+d)/2);o[v]>h?g=v:d=v}var m=o[g]-o[d],b=h-o[d];c.push(i[d]+u[d]*b+(3*l[d+2]-2*u[d]-u[d+1])*b*b/m+(u[d]+u[d+1]-2*l[d+2])*b*b*b/(m*m))}return"number"==typeof r?c[0]:c},this.cubic=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Interpolate","cubic","Invalid number of function arguments.");var e=F(t,n,r,"cubic",3);if("string"==typeof e)return e;for(var o=e[0],i=e[1],a=o.length,l=new Array(a-1),z=0;z<a-1;z++)l[z]=o[z+1]-o[z];var u=new Array(a-2);for(z=0;z<a-2;z++)u[z]=(i[z+2]-i[z+1])/l[z+1]-(i[z+1]-i[z])/l[z];for(z=0;z<a-2;z++)u[z]*=6;var s=new Array(a-2);for(z=0;z<a-2;z++)s[z]=new Array(a-2);for(z=0;z<a-2;z++)for(var f=0;f<a-2;f++)s[z][f]=0;for(z=0;z<a-2;z++)s[z][z]=2*(l[z]+l[z+1]);for(z=0;z<a-3;z++)s[z][z+1]=l[z+1];for(z=0;z<a-3;z++)s[z+1][z]=l[z+1];var c=LinearAlgebra.solve(s,u,{method:"cholesky"});if("string"==typeof c)return GlobalFunctions.set_error("Interpolate","cubic","Unexpected failure.");c.push(0),c.unshift(0);var h=new Array(a-1);for(z=0;z<a-1;z++)h[z]=(i[z+1]-i[z])/l[z]+l[z]*(c[z]+2*c[z+1])/6;var d=r;"number"==typeof r&&(d=[r]);var g=[];for(z=0;z<d.length;z++){for(var v=d[z],m=0,b=a-1;1<b-m;){var p=Math.floor((b+m)/2);o[p]>v?b=p:m=p}var x=v-o[b];g.push(i[b]+h[m]*x+c[b]*x*x/2+(c[b]-c[m])*x*x*x/(6*l[m]))}return"number"==typeof r?g[0]:g},this.grid=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Interpolate","grid","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Interpolate","grid","Invalid function argument.");for(var e=Math.min(t,n),o=Math.max(t,n),i=Math.max(e!=o?(o-e)/1e5:1,r),a=[],l=e;l<=o;l+=i)a.push(l);return a}},JsonData=new function(){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status&&"function"==typeof json_data&&json_data(JSON.parse(this.responseText))},this.load=function(t){return arguments.length<1?GlobalFunctions.set_error("JsonData","load","Invalid number of function arguments."):1!=GlobalFunctions.is_string(t)?GlobalFunctions.set_error("JsonData","load","Invalid function argument."):(n.open("GET",t,!0),void n.send())},this.stringify=function(t){return arguments.length<1?GlobalFunctions.set_error("JsonData","stringify","Invalid number of function arguments."):JSON.stringify(t)}},LinearAlgebra=new function(){var x=["Invalid number of function arguments.","Invalid function argument.","Improper matrix or vector dimension.","Matrix is not regular.","Matrix is not positive definite.","Matrix is not symmetrical.","Matrix is not square.","Decomposition does not exist.","Matrix diagonal-elements are not allowed to be zero.","Maximum number of iterations executed, method aborted."],v=0;function m(t,n){for(var r=t.length,e=1;e<r;e++)for(var o=0;o<e;o++)if(Math.abs(t[e][o]-t[o][e])>n)return!1;return!0}function b(t,n){for(var r=t.length,e=new Array(r),o=0;o<r;o++){for(var i=0,a=0;a<r;a++)i+=t[o][a]*n[a];e[o]=i}return e}function p(t){for(var n=t.length,r=0,e=0;e<n;e++)r+=Math.abs(t[e]);return r}function F(t){for(var n=t.length,r=0,e=0;e<n;e++)r+=t[e]*t[e];return r}function d(t,n,r,e){var o=t*t+4*n*r-2*t*e+e*e;if(o<0)return e;var i=.5*(t+e-(o=Math.sqrt(o))),a=.5*(t+e+o);return Math.abs(i-e)<Math.abs(a-e)?i:a}function g(t,n){for(var r=t.length,e=n.length,o=new Array(r-1),i=new Array(r-1),a=0;a<r-1;a++){var l=(t[a][a]<0?-1:1)*Math.sqrt(t[a][a]*t[a][a]+t[a+1][a]*t[a+1][a]);o[a]=0==l?1:t[a][a]/l,i[a]=0==l?0:t[a+1][a]/l,t[a][a]=o[a]*t[a][a]+i[a]*t[a+1][a],t[a+1][a]=0;for(var z=Math.min(a+3,r),u=a+1;u<z;u++){var s=t[a][u];t[a][u]=o[a]*t[a][u]+i[a]*t[a+1][u],t[a+1][u]=o[a]*t[a+1][u]-i[a]*s}}for(a=0;a<r-1;a++){for(z=Math.min(r,a+2),u=Math.max(0,a-1);u<z;u++){s=t[u][a];t[u][a]=o[a]*t[u][a]+i[a]*t[u][a+1],t[u][a+1]=o[a]*t[u][a+1]-i[a]*s}for(u=0;u<e;u++){s=n[u][a];n[u][a]=o[a]*n[u][a]+i[a]*n[u][a+1],n[u][a+1]=o[a]*n[u][a+1]-i[a]*s}}}this.mult=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("LinearAlgebra","mult",x[0]);if(1==GlobalFunctions.is_number(t))return function(t,n){if(1==GlobalFunctions.is_vector(n)){for(var r=n.length,e=new Array(r),o=0;o<r;o++)e[o]=t*n[o];return e}if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("LinearAlgebra","mult",x[1]);var i=n.length,a=(r=n[0].length,new Array(i));for(o=0;o<i;o++)a[o]=new Array(r);for(o=0;o<i;o++)for(var l=0;l<r;l++)a[o][l]=t*n[o][l];return a}(t,n);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","mult",x[1]);var r=t.length,e=t[0].length;if(1==GlobalFunctions.is_vector(n)){if(n.length!=e)return GlobalFunctions.set_error("LinearAlgebra","mult",x[2]);for(var o=new Array(r),i=0;i<r;i++)o[i]=0;for(i=0;i<r;i++)for(var a=0;a<e;a++)o[i]+=t[i][a]*n[a];return o}if(1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("LinearAlgebra","mult",x[1]);if(n.length!=e)return GlobalFunctions.set_error("LinearAlgebra","mult",x[2]);var l=n[0].length,z=new Array(r);for(i=0;i<r;i++)z[i]=new Array(l);for(i=0;i<r;i++)for(a=0;a<l;a++)z[i][a]=0;for(i=0;i<r;i++)for(a=0;a<l;a++)for(var u=0;u<e;u++)z[i][a]+=t[i][u]*n[u][a];return z},this.add=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("LinearAlgebra","add",x[0]);if(1==GlobalFunctions.is_vector(t)&&1==GlobalFunctions.is_vector(n)){var r=t.length;if(n.length!=r)return GlobalFunctions.set_error("LinearAlgebra","add",x[2]);for(var e=new Array(r),o=0;o<r;o++)e[o]=t[o]+n[o];return e}if(1!=GlobalFunctions.is_matrix(t)||1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("LinearAlgebra","add",x[1]);var i=t.length;r=t[0].length;if(n.length!=i||n[0].length!=r)return GlobalFunctions.set_error("LinearAlgebra","add",x[2]);var a=new Array(i);for(o=0;o<i;o++)a[o]=new Array(r);for(o=0;o<i;o++)for(var l=0;l<r;l++)a[o][l]=t[o][l]+n[o][l];return a},this.sub=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("LinearAlgebra","sub",x[0]);if(1==GlobalFunctions.is_vector(t)&&1==GlobalFunctions.is_vector(n)){var r=t.length;if(n.length!=r)return GlobalFunctions.set_error("LinearAlgebra","sub",x[2]);for(var e=new Array(r),o=0;o<r;o++)e[o]=t[o]-n[o];return e}if(1!=GlobalFunctions.is_matrix(t)||1!=GlobalFunctions.is_matrix(n))return GlobalFunctions.set_error("LinearAlgebra","sub",x[1]);var i=t.length;r=t[0].length;if(n.length!=i||n[0].length!=r)return GlobalFunctions.set_error("LinearAlgebra","sub",x[2]);var a=new Array(i);for(o=0;o<i;o++)a[o]=new Array(r);for(o=0;o<i;o++)for(var l=0;l<r;l++)a[o][l]=t[o][l]-n[o][l];return a},this.transpose=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","transpose",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","transpose",x[1]);for(var n=t.length,r=t[0].length,e=new Array(r),o=0;o<r;o++)e[o]=new Array(n);for(o=0;o<r;o++)for(var i=0;i<n;i++)e[o][i]=t[i][o];return e},this.vector_norm=function(t,n){var r=t.length,e=0;if(-1==n){for(var o=0;o<r;o++)e=Math.max(e,Math.abs(t[o]));return e}if(1==n){for(o=0;o<r;o++)e+=Math.abs(t[o]);return e}if(2!=n)return 0;for(o=0;o<r;o++)e+=t[o]*t[o];return Math.sqrt(e)},this.matrix_norm=function(t,n){var r=t.length,e=t[0].length,o=0;if(-1==n){for(var i=0;i<r;i++){for(var a=0,l=0;l<e;l++)a+=Math.abs(t[i][l]);o=Math.max(o,a)}return o}if(1==n){for(l=0;l<e;l++){for(a=0,i=0;i<r;i++)a+=Math.abs(t[i][l]);o=Math.max(o,a)}return o}if(2!=n)return 0;var z=this.mult(this.transpose(t),t),u=this.eigenvalues(z);return 1!=GlobalFunctions.is_number(u.v[0])?0:Math.sqrt(Math.abs(u.v[0]))},this.norm=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","norm",x[0]);var n=2;return 1<arguments.length&&"number"==typeof arguments[1].p&&(n=arguments[1].p),-1!=n&&1!=n&&2!=n?GlobalFunctions.set_error("LinearAlgebra","norm","Use p = 2, p = 1, or p = -1."):1==GlobalFunctions.is_vector(t)?this.vector_norm(t,n):1==GlobalFunctions.is_matrix(t)?this.matrix_norm(t,n):GlobalFunctions.set_error("LinearAlgebra","norm",x[1])},this.cond=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","cond",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","cond",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","cond",x[6]);var r=this.invert(t);return 1!=GlobalFunctions.is_matrix(r)?GlobalFunctions.set_error("LinearAlgebra","cond",x[3]):this.matrix_norm(t,-1)*this.matrix_norm(r,-1)},this.identity_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","identity_matrix",x[0]);if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("LinearAlgebra","identity_matrix",x[1]);for(var n=Math.max(1,Math.floor(t)),r=new Array(n),e=0;e<n;e++)r[e]=new Array(n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=e==o?1:0;return r},this.diagonal_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","diagonal_matrix",x[0]);if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("LinearAlgebra","diagonal_matrix",x[1]);for(var n=t.length,r=new Array(n),e=0;e<n;e++)r[e]=new Array(n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=e==o?t[e]:0;return r},this.zero_matrix=function(){var t=1;0<arguments.length&&1==GlobalFunctions.is_number(arguments[0])&&(t=Math.max(1,Math.floor(arguments[0])));var n=t;1<arguments.length&&1==GlobalFunctions.is_number(arguments[1])&&(t=Math.max(1,Math.floor(arguments[1])));for(var r=new Array(n),e=0;e<n;e++)r[e]=new Array(t);for(e=0;e<n;e++)for(var o=0;o<t;o++)r[e][o]=0;return r},this.tridiagonal_matrix=function(t,n,r,e){if(arguments.length<4)return GlobalFunctions.set_error("LinearAlgebra","tridiagonal_matrix",x[0]);if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("LinearAlgebra","tridiagonal_matrix",x[1]);if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("LinearAlgebra","tridiagonal_matrix",x[1]);if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("LinearAlgebra","tridiagonal_matrix",x[1]);if(1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("LinearAlgebra","tridiagonal_matrix",x[1]);for(var o=this.zero_matrix(t),i=0;i<t;i++)for(var a=0;a<t;a++)o[i][a]=a==i?r:i-a==1?n:a-i==1?e:0;return o},this.matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","matrix",x[0]);if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("LinearAlgebra","matrix",x[1]);var n=Math.max(1,Math.round(t)),r="symmetrical";if(1<arguments.length&&"string"==typeof arguments[1].type&&(r=arguments[1].type),"zero"==r)return this.zero_matrix(n);if("identity"==r)return this.identity_matrix(n);if("tridiagonal"==r){var e=(Math.random()<.5?-1:1)*(Math.floor(9*Math.random())+1),o=(Math.random()<.5?-1:1)*(Math.floor(9*Math.random())+1),i=Math.abs(e)+Math.abs(o)+1;return this.tridiagonal_matrix(n,e,i,o)}if("lower_triangular"==r){for(var a=this.zero_matrix(n),l=1;l<n;l++)for(var z=0;z<l;z++)a[l][z]=(Math.random()<.5?-1:1)*Math.floor(13*Math.random());for(l=0;l<n;l++)a[l][l]=(Math.random()<.5?-1:1)*(Math.floor(12*Math.random())+1);return a}if("upper_triangular"==r){for(a=this.zero_matrix(n),l=0;l<n-1;l++)for(z=l+1;z<n;z++)a[l][z]=(Math.random()<.5?-1:1)*Math.floor(13*Math.random());for(l=0;l<n;l++)a[l][l]=(Math.random()<.5?-1:1)*(Math.floor(12*Math.random())+1);return a}if("symmetrical"==r){for(a=this.zero_matrix(n),l=1;l<n;l++)for(z=0;z<l;z++)a[l][z]=(Math.random()<.5?-1:1)*Math.floor(9*Math.random()),a[z][l]=a[l][z];for(l=0;l<n;l++){var u=0;for(z=0;z<l;z++)u+=Math.abs(a[l][z]);for(z=l+1;z<n;z++)u+=Math.abs(a[l][z]);a[l][l]=u+1}return a}for(a=this.zero_matrix(n),l=0;l<n;l++)for(z=0;z<n;z++)a[l][z]=2*Math.random()-1;return a},this.invert=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","invert",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","invert",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","invert",x[6]);for(var r=new Array(n),e=0;e<n;e++)r[e]=new Array(2*n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=t[e][o];for(e=0;e<n;e++)for(o=n;o<2*n;o++)r[e][o]=0;for(e=0;e<n;e++)r[e][n+e]=1;for(e=0;e<n;e++){for(var i=Math.abs(r[e][e]),a=e,l=e+1;l<n;l++)Math.abs(r[l][e])>i&&(i=Math.abs(r[l][e]),a=l);if(0==i)return GlobalFunctions.set_error("LinearAlgebra","invert",x[3]);for(o=0;o<2*n;o++){var z=r[e][o];r[e][o]=r[a][o],r[a][o]=z}i=r[e][e];for(o=0;o<2*n;o++)r[e][o]/=i;for(l=0;l<n;l++)if(l!=e){var u=r[l][e];for(o=0;o<2*n;o++)r[l][o]-=u*r[e][o]}}var s=new Array(n);for(e=0;e<n;e++)s[e]=new Array(n);for(e=0;e<n;e++)for(o=0;o<n;o++)s[e][o]=r[e][n+o];return s},this.solve_gauss=function(t,n){for(var r=t.length,e=new Array(r),o=0;o<r;o++)e[o]=new Array(r+1);for(o=0;o<r;o++){for(var i=0;i<r;i++)e[o][i]=t[o][i];e[o][r]=n[o]}for(o=0;o<r;o++){for(var a=Math.abs(e[o][o]),l=o,z=o+1;z<r;z++)Math.abs(e[z][o])>a&&(a=Math.abs(e[z][o]),l=z);if(0==a)return x[3];for(i=0;i<r+1;i++){var u=e[o][i];e[o][i]=e[l][i],e[l][i]=u}a=e[o][o];for(i=0;i<r+1;i++)e[o][i]/=a;for(z=o+1;z<r;z++){var s=e[z][o];for(i=0;i<r+1;i++)e[z][i]-=s*e[o][i]}}var f=new Array(r);for(o=r-1;0<=o;o--){f[o]=e[o][r];for(z=o+1;z<r;z++)f[o]-=f[z]*e[o][z]}return f},this.qr=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","qr",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","qr",x[1]);for(var n=t.length,r=t[0].length,e=new Array(n),o=0;o<n;o++)e[o]=new Array(r);for(o=0;o<n;o++)for(var i=0;i<r;i++)e[o][i]=t[o][i];for(var a=this.identity_matrix(n),l=0;l<Math.min(n,r);l++){var z=Math.abs(e[l][l]);for(o=l+1;o<n;o++)z=Math.max(z,Math.abs(e[o][l]));0==z&&(z=1);var u=new Array(n);for(o=0;o<n;o++)u[o]=o<l?0:e[o][l]/z;var s=0;for(o=l;o<n;o++)s+=u[o]*u[o];var f=0;0!=(s=Math.sqrt(s))&&(f=1/(s*(s+Math.abs(u[l])))),s*=e[l][l]<0?-1:1,u[l]+=s,e[l][l]=-s*z;for(o=l+1;o<n;o++)e[o][l]=0;for(i=l+1;i<r;i++){var c=0;for(o=l;o<n;o++)c+=e[o][i]*u[o];c*=f;for(o=l;o<n;o++)e[o][i]-=c*u[o]}for(o=0;o<n;o++){for(c=0,i=l;i<n;i++)c+=a[o][i]*u[i];c*=f;for(i=l;i<n;i++)a[o][i]-=c*u[i]}}return{Q:a,R:e}},this.solve_qr=function(t,n){var r=t.length,e=this.qr(t);if(1!=GlobalFunctions.is_matrix(e.Q))return x[7];if(1!=GlobalFunctions.is_matrix(e.R))return x[7];for(var o=this.mult(this.transpose(e.Q),n),i=new Array(r),a=r-1;0<=a;a--){i[a]=o[a];for(var l=a+1;l<r;l++)i[a]-=i[l]*e.R[a][l];if(0==e.R[a][a])return x[3];i[a]/=e.R[a][a]}return i},this.lu=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","lu",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","lu",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","lu",x[6]);for(var r=this.identity_matrix(n),e=this.identity_matrix(n),o=0;o<n;o++)for(var i=0;i<n;i++)r[o][i]=t[o][i];for(var a=0;a<n-1;a++){if(0==r[a][a])return GlobalFunctions.set_error("LinearAlgebra","lu",x[7]);for(o=a+1;o<n;o++)e[o][a]=r[o][a]/r[a][a];for(o=a+1;o<n;o++)r[o][a]=0;for(o=a+1;o<n;o++)for(i=a+1;i<n;i++)r[o][i]=r[o][i]-e[o][a]*r[a][i]}return{L:e,U:r}},this.solve_lu=function(t,n){var r=t.length,e=this.lu(t);if(1!=GlobalFunctions.is_matrix(e.L))return x[7];if(1!=GlobalFunctions.is_matrix(e.U))return x[7];for(var o=new Array(r),i=0;i<r;i++){o[i]=n[i];for(var a=0;a<i;a++)o[i]-=o[a]*e.L[i][a];if(0==e.L[i][i])return x[3];o[i]/=e.L[i][i]}var l=new Array(r);for(i=r-1;0<=i;i--){l[i]=o[i];for(a=i+1;a<r;a++)l[i]-=l[a]*e.U[i][a];if(0==e.U[i][i])return x[3];l[i]/=e.U[i][i]}return l},this.cholesky=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","cholesky",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","cholesky",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","cholesky",x[6]);if(1!=m(t,1e-12))return GlobalFunctions.set_error("LinearAlgebra","cholesky",x[5]);for(var r=new Array(n),e=0;e<n;e++)r[e]=new Array(n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=0;for(var i=0;i<n;i++){var a=t[i][i];for(o=0;o<i;o++)a-=r[i][o]*r[i][o];if(a<=0)return GlobalFunctions.set_error("LinearAlgebra","cholesky",x[7]);r[i][i]=Math.sqrt(a);for(e=i+1;e<n;e++){var l=t[e][i];for(o=0;o<i;o++)l-=r[i][o]*r[e][o];r[e][i]=l/r[i][i]}}return r},this.solve_cholesky=function(t,n){var r=t.length,e=this.cholesky(t);if(1!=GlobalFunctions.is_matrix(e))return x[7];for(var o=0;o<r;o++)if(0==e[o][o])return x[3];var i=new Array(r);for(o=0;o<r;o++){i[o]=n[o];for(var a=0;a<o;a++)i[o]-=i[a]*e[o][a];i[o]/=e[o][o]}var l=new Array(r);for(o=r-1;0<=o;o--){l[o]=i[o];for(a=o+1;a<r;a++)l[o]-=l[a]*e[a][o];l[o]/=e[o][o]}return l},this.solve=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("LinearAlgebra","solve",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","solve",x[1]);if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("LinearAlgebra","solve",x[1]);var r=t.length;if(t[0].length!=r)return GlobalFunctions.set_error("LinearAlgebra","solve",x[6]);if(n.length!=r)return GlobalFunctions.set_error("LinearAlgebra","solve",x[2]);var e="gauss";2<arguments.length&&"string"==typeof arguments[2].method&&(e=arguments[2].method),"lu"!=e&&"qr"!=e&&"cholesky"!=e&&(e="gauss");var o=[];return"lu"==e&&(o=this.solve_lu(t,n)),"qr"==e&&(o=this.solve_qr(t,n)),"cholesky"==e&&(o=this.solve_cholesky(t,n)),"gauss"==e&&(o=this.solve_gauss(t,n)),1==GlobalFunctions.is_string(o)?GlobalFunctions.set_error("LinearAlgebra","solve",o):o.length!=n.length?GlobalFunctions.set_error("LinearAlgebra","solve","Unexpected failure."):o},this.det=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","det",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","det",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","det",x[6]);for(var r=new Array(n),e=0;e<n;e++)r[e]=new Array(n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=t[e][o];for(var i=0;i<n;i++){var a=Math.abs(r[i][i]);for(e=i+1;e<n;e++)a=Math.max(a,Math.abs(r[e][i]));0==a&&(a=1);var l=new Array(n);for(e=0;e<n;e++)l[e]=e<i?0:r[e][i]/a;var z=0;for(e=i;e<n;e++)z+=l[e]*l[e];var u=0;0!=(z=Math.sqrt(z))&&(u=1/(z*(z+Math.abs(l[i])))),z*=r[i][i]<0?-1:1,l[i]+=z,r[i][i]=-z*a;for(e=i+1;e<n;e++)r[e][i]=0;for(o=i+1;o<n;o++){var s=0;for(e=i;e<n;e++)s+=r[e][o]*l[e];s*=u;for(e=i;e<n;e++)r[e][o]-=s*l[e]}}var f=n%2==0?1:-1;for(i=0;i<n;i++)f*=r[i][i];return f},this.cg=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("LinearAlgebra","cg",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","cg",x[1]);if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("LinearAlgebra","cg",x[1]);var r=t.length;if(t[0].length!=r)return GlobalFunctions.set_error("LinearAlgebra","cg",x[6]);if(n.length!=r)return GlobalFunctions.set_error("LinearAlgebra","cg",x[2]);if(1!=m(t,1e-12))return GlobalFunctions.set_error("LinearAlgebra","cg",x[5]);var e=1e-10;2<arguments.length&&"number"==typeof arguments[2].accuracy&&(e=Math.max(1e-12,arguments[2].accuracy));for(var o=0,i=0,a=0,l=new Array(r),z=new Array(r),u=0;u<r;u++)l[u]=0;var s=function(t,n,r){for(var e=t.length,o=new Array(e),i=0;i<e;i++)o[i]=n[i];for(i=0;i<e;i++){for(var a=0,l=0;l<e;l++)a+=t[i][l]*r[l];o[i]-=a}return o}(t,n,l);for(u=0;u<r;u++)z[u]=s[u];for(var f=p(s),c=F(s);o<r&&e<=f;){var h=b(t,z),d=0;for(u=0;u<r;u++)d+=z[u]*h[u];if(0==d)return GlobalFunctions.set_error("LinearAlgebra","cg",x[4]);i=c/d;for(u=0;u<r;u++)l[u]+=i*z[u];for(u=0;u<r;u++)s[u]-=i*h[u];var g=c;f=p(s),a=(c=F(s))/g;for(u=0;u<r;u++)z[u]=s[u]+a*z[u];o++}return v=o,l},this.hessenberg=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","hessenberg",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","hessenberg",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","hessenberg",x[6]);for(var r=new Array(n),e=0;e<n;e++)r[e]=new Array(n);for(e=0;e<n;e++)for(var o=0;o<n;o++)r[e][o]=t[e][o];for(var i=this.identity_matrix(n),a=0;a<n-2;a++){var l=Math.abs(r[a+1][a]);for(e=a+2;e<n;e++)l=Math.max(l,Math.abs(r[e][a]));0==l&&(l=1);var z=new Array(n);for(e=0;e<n;e++)z[e]=e<a+1?0:r[e][a]/l;var u=0;for(e=a+1;e<n;e++)u+=z[e]*z[e];var s=0;0!=(u=Math.sqrt(u))&&(s=1/(u*(u+Math.abs(z[a+1])))),u*=r[a+1][a]<0?-1:1,z[a+1]+=u,r[a+1][a]=-u*l;for(e=a+2;e<n;e++)r[e][a]=0;for(o=a+1;o<n;o++){var f=0;for(e=a+1;e<n;e++)f+=r[e][o]*z[e];f*=s;for(e=a+1;e<n;e++)r[e][o]-=f*z[e]}for(e=0;e<n;e++){for(f=0,o=a+1;o<n;o++)f+=r[e][o]*z[o];f*=s;for(o=a+1;o<n;o++)r[e][o]-=f*z[o]}for(o=0;o<n;o++){for(f=0,e=a+1;e<n;e++)f+=i[e][o]*z[e];f*=s;for(e=a+1;e<n;e++)i[e][o]-=f*z[e]}}return{Q:i,R:r}},this.eigenvalues=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","eigenvalues",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","eigenvalues",x[1]);var n=t.length;if(t[0].length!=n)return GlobalFunctions.set_error("LinearAlgebra","eigenvalues",x[6]);if(1!=m(t,1e-12))return GlobalFunctions.set_error("LinearAlgebra","eigenvalues",x[5]);var r=1e-10;1<arguments.length&&"number"==typeof arguments[1].accuracy&&(r=Math.max(1e-12,arguments[1].accuracy));for(var e=new Array(n),o=0;o<n;o++)e[o]=new Array(n);for(o=0;o<n;o++)e[o][o]=t[o][o];for(o=1;o<n;o++)for(var i=0;i<o;i++)e[o][i]=.5*(t[o][i]+t[i][o]),e[i][o]=e[o][i];var a=this.identity_matrix(n);if(1!=function(t,n){for(var r=t.length,e=2;e<r;e++)for(var o=0;o<e-1;o++)if(Math.abs(t[e][o])>n)return!1;return!0}(e,0)){var l=this.hessenberg(e);e=l.R,a=this.transpose(l.Q)}for(var z=0,u=10*n+1e3,s=n;1<s;s--){var f=new Array(s);for(o=0;o<s;o++)f[o]=new Array(s);for(o=0;o<s;o++)for(i=0;i<s;i++)f[o][i]=e[o][i];for(;z<u&&Math.abs(f[s-1][s-2])>r;){var c=d(f[s-2][s-2],f[s-2][s-1],f[s-1][s-2],f[s-1][s-1]);for(o=0;o<s;o++)f[o][o]-=c;g(f,a);for(o=0;o<s;o++)f[o][o]+=c;z++}for(o=0;o<s;o++)for(i=0;i<s;i++)e[o][i]=f[o][i]}var h=new Array(n);for(o=0;o<n;o++)h[o]=e[o][o];return(v=z)==u?GlobalFunctions.set_error("LinearAlgebra","eigenvalues",x[9]):function(t,n){for(var r=t.length,e=new Array(r),o=0;o<r;o++)e[o]=Math.abs(t[o]);var i=new Array(r);for(o=0;o<r;o++)i[o]=o;for(var a=0;a<r-1;a++)for(var l=a+1;l<r;l++)if(e[a]<e[l]){var z=i[a];i[a]=i[l],i[l]=z;var u=e[a];e[a]=e[l],e[l]=u}var s=new Array(r);for(a=0;a<r;a++)s[a]=t[i[a]];var f=new Array(r);for(a=0;a<r;a++)f[a]=new Array(r);for(a=0;a<r;a++){var c=n[i[a]][0]<0?-1:1;for(l=0;l<r;l++)f[a][l]=c*n[i[a]][l]}return{v:s,Q:f}}(h,this.transpose(a))},this.bidiagonalize=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","bidiagonalize",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","bidiagonalize",x[1]);for(var n=t.length,r=t[0].length,e=new Array(n),o=0;o<n;o++)e[o]=new Array(r);for(o=0;o<n;o++)for(var i=0;i<r;i++)e[o][i]=t[o][i];for(var a=this.identity_matrix(n),l=this.identity_matrix(r),z=0;z<Math.min(n,r);z++){var u=Math.abs(e[z][z]);for(o=z+1;o<n;o++)u=Math.max(u,Math.abs(e[o][z]));0==u&&(u=1);var s=new Array(n);for(o=0;o<n;o++)s[o]=o<z?0:e[o][z]/u;var f=0;for(o=z;o<n;o++)f+=s[o]*s[o];var c=0;0!=(f=Math.sqrt(f))&&(c=1/(f*(f+Math.abs(s[z])))),f*=e[z][z]<0?-1:1,s[z]+=f,e[z][z]=-f*u;for(o=z+1;o<n;o++)e[o][z]=0;for(i=z+1;i<r;i++){var h=0;for(o=z;o<n;o++)h+=e[o][i]*s[o];h*=c;for(o=z;o<n;o++)e[o][i]-=h*s[o]}for(o=0;o<n;o++){for(h=0,i=z;i<n;i++)h+=a[o][i]*s[i];h*=c;for(i=z;i<n;i++)a[o][i]-=h*s[i]}if(z<r-1){for(u=Math.abs(e[z][z+1]),i=z+2;i<r;i++)u=Math.max(u,Math.abs(e[z][i]));0==u&&(u=1);for(s=new Array(r),i=0;i<r;i++)s[i]=i<z+1?0:e[z][i]/u;for(f=0,i=z+1;i<r;i++)f+=s[i]*s[i];c=0;0!=(f=Math.sqrt(f))&&(c=1/(f*(f+Math.abs(s[z+1])))),f*=e[z][z+1]<0?-1:1,s[z+1]+=f;for(i=0;i<r;i++){for(h=0,o=z+1;o<r;o++)h+=l[o][i]*s[o];h*=c;for(o=z+1;o<r;o++)l[o][i]-=h*s[o]}e[z][z+1]=-f*u;for(i=z+2;i<r;i++)e[z][i]=0;for(o=z+1;o<n;o++){for(h=0,i=z+1;i<r;i++)h+=e[o][i]*s[i];h*=c;for(i=z+1;i<r;i++)e[o][i]-=h*s[i]}}}return{Q:a,R:e,U:l}},this.svd=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearAlgebra","svd",x[0]);if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("LinearAlgebra","svd",x[1]);var n=t.length<t[0].length,r=this.bidiagonalize(n?this.transpose(t):t),e=r.Q.length,o=r.U.length,i=this.zero_matrix(o);i[0][0]=r.R[0][0]*r.R[0][0];for(var a=1;a<o;a++)i[a][a]=r.R[a][a]*r.R[a][a]+r.R[a-1][a]*r.R[a-1][a],i[a-1][a]=r.R[a-1][a-1]*r.R[a-1][a],i[a][a-1]=i[a-1][a];var l=this.eigenvalues(i),z=this.zero_matrix(o);for(a=0;a<o-1;a++)for(var u=0;u<o;u++)z[a][u]=r.R[a][a]*l.Q[u][a]+r.R[a][a+1]*l.Q[u][a+1];for(u=0;u<o;u++)z[o-1][u]=r.R[o-1][o-1]*l.Q[u][o-1];var s=this.qr(z),f=this.zero_matrix(e,o);for(a=0;a<o;a++)f[a][a]=Math.abs(s.R[a][a]);var c=this.identity_matrix(e);for(a=0;a<o;a++)for(u=0;u<o;u++)c[a][u]=s.Q[a][u];for(u=0;u<o;u++)if(s.R[u][u]<0)for(a=0;a<o;a++)c[a][u]*=-1;var h=this.zero_matrix(e);for(a=o;a<e;a++)for(u=o;u<e;u++)h[a][u]=r.Q[a][u];for(a=0;a<e;a++)for(u=0;u<o;u++)for(var d=0;d<e;d++)h[a][u]+=r.Q[a][d]*c[d][u];for(a=0;a<o;a++)for(u=o;u<e;u++)for(d=0;d<e;d++)h[a][u]+=r.Q[a][d]*c[d][u];var g=this.zero_matrix(o);for(a=0;a<o;a++)g[a][0]=l.Q[a][0];for(a=0;a<o;a++)for(u=1;u<o;u++)for(d=0;d<o;d++)g[a][u]+=l.Q[a][d]*r.U[d][u];if(1<arguments.length){var v=-1;if("number"==typeof arguments[1].q&&(v=Math.max(1,Math.min(Math.round(arguments[1].q),Math.min(e,o)))),0<v){var m=this.zero_matrix(e,v),b=this.zero_matrix(v,v),p=this.zero_matrix(v,o);for(a=0;a<e;a++)for(u=0;u<v;u++)m[a][u]=h[a][u];for(a=0;a<v;a++)for(u=0;u<v;u++)b[a][u]=f[a][u];for(a=0;a<v;a++)for(u=0;u<o;u++)p[a][u]=g[a][u];h=m,f=b,g=p}}return 1!=n?{U:h,S:f,V:g}:{U:this.transpose(g),S:this.transpose(f),V:this.transpose(h)}},this.iterations=function(){return v}},LinearProgramming=new function(){var y=!1,M=1e-6,_=0,s=0,i=0;function a(t){return 1==i?GlobalFunctions.set_error("LinearProgramming",t,"Linear programming problem is unbounded."):2==i?GlobalFunctions.set_error("LinearProgramming",t,"Linear programming problem is infeasible."):5==i?GlobalFunctions.set_error("LinearProgramming",t,"Maximum number of iterations executed, method aborted."):6==i?GlobalFunctions.set_error("LinearProgramming",t,"Invalid number of function arguments."):7==i?GlobalFunctions.set_error("LinearProgramming",t,"Invalid function argument."):8==i?GlobalFunctions.set_error("LinearProgramming",t,"Improper matrix or vector dimension."):9==i?GlobalFunctions.set_error("LinearProgramming",t,"Linear programming problem is unbounded, infeasible, or ill-posed."):GlobalFunctions.set_error("LinearProgramming",t,"Unexpected failure.")}function G(t){return i=t,!1}function w(t,n){for(var r=t,e=2;e<=n;e++)r*=(t+1-e)/e;return Math.round(r)}function g(t){for(var n=0,r=0;r<t.length;r++)n+=Math.abs(t[r]);return n<t.length*M}function v(t){for(var n=0,r=0;r<t.length-1;r++)n+=Math.abs(t[r]);var e=Math.abs(t[t.length-1]);return!(n<(t.length-1)*M&&M<e)}function o(t){for(var n=t.length,r=0,e=0,o=0;o<n;o++)t[o]<0&&r++;for(o=0;o<n;o++)0<t[o]&&e++;return r==n?-2:e==n?2:0==r?1:0==e?-1:0}function I(t,n,r,e){for(var o=-1,i=-1,a=0;a<r&&-1==o;)t[0][a]<-M&&(o=a),a++;if(-1==o)return[-1,-1];for(var l=0,z=1;z<=n;z++)if(t[z][o]>M){var u=t[z][r]/t[z][o];-1==i||u<l?(i=z,l=u):u==l&&e[z-1]<e[i-1]&&(i=z)}return[o,i]}function k(t,n,r){for(var e=-1,o=-1,i=0;i<r&&-1==e;)t[0][i]<-M&&(e=i),i++;if(-1==e)return[-1,-1];for(var a=0,l=1;l<=n;l++)if(t[l][e]>M){var z=t[l][r]/t[l][e];(-1==o||z<a)&&(o=l,a=z)}return[e,o]}function X(t,n,r){for(var e=-1,o=-1,i=-M,a=0;a<r;a++)t[0][a]<i&&(i=t[0][a],e=a);if(-1==e)return[-1,-1];i=0;for(var l=1;l<=n;l++)if(t[l][e]>M){var z=t[l][r]/t[l][e];(-1==o||z<i)&&(o=l,i=z)}return[e,o]}function A(t,n,r){for(var e=0,o=[],i=0;i<r;i++)if(t[0][i]<-M){e++;for(var a=0,l=[],z=1;z<=n;z++)if(t[z][i]>M){var u=t[z][r]/t[z][i];0==l.length&&(a=u+1),u==a&&l.push(z),u<a&&(l=[z],a=u)}for(var s=0;s<l.length;s++)o.push([i,l[s]])}return 0==e?1:0==o.length?2:o}function N(t,n,r){var e=A(t,n,r);if("number"==typeof e&&1==e)return[-1,-1];if("number"==typeof e&&2==e)return[0,-1];for(var o=1,i=-1,a=0;a<e.length;a++){var l=t[0][e[a][0]]*t[e[a][1]][r]/t[e[a][1]][e[a][0]];l<o&&(o=l,i=a)}return e[i]}function f(t,n,r,e){for(var o=n.length,i=n[0].length,a=new Array(o+1),l=0;l<o+1;l++)a[l]=new Array(i+1);for(l=0;l<o;l++)for(var z=0;z<i;z++)a[l+1][z]=n[l][z];for(l=0;l<o;l++)a[l+1][i]=r[l];for(z=0;z<i;z++)a[0][z]=t[z];a[0][i]=0;var u=new Array(o);for(l=0;l<o;l++)u[l]=e[l];1==y&&(Console.print("Ausgangstableau:"),Console.print(a));for(l=0;l<o;l++)if(0!=a[0][u[l]]){for(z=0;z<=i;z++)z!=u[l]&&(a[0][z]-=a[0][u[l]]*a[l+1][z]);a[0][u[l]]=0}for(var s,f=0,c=0,h=Math.min(w(i,o),1e3*i);0==c;){1==y&&(Console.print("Basis und Tableau:"),Console.print(u),Console.print(a));var d=[-1,-1];0==_&&(d=N(a,o,i)),1==_&&(d=k(a,o,i)),2==_&&(d=X(a,o,i)),3==_&&(void 0,d="number"==typeof(s=A(a,o,i))&&1==s?[-1,-1]:"number"==typeof s&&2==s?[0,-1]:s[Math.floor(s.length*Math.random())]),4==_&&(d=I(a,o,i,u));var g=d[0],v=d[1];if(-1==g&&(c=3),-1<g&&-1==v&&(c=1),0==c){for(z=0;z<=i;z++)z!=g&&(a[v][z]/=a[v][g]);a[v][g]=1;for(l=0;l<=o;l++)if(l!=v){for(z=0;z<=i;z++)z!=g&&(a[l][z]-=a[l][g]*a[v][z]);a[l][g]=0}for(l=1;l<=o;l++)a[l][i]<0&&(a[l][i]=0);u[v-1]=g,f++}h<=f&&(c=5)}if(1==c)return G(1);if(5==c)return G(5);var m=new Array(i);for(z=0;z<i;z++)m[z]=0;for(l=0;l<o;l++)m[u[l]]=a[l+1][i];var b=new Array(o);for(l=0;l<o;l++)b[l]=new Array(i);for(l=0;l<o;l++)for(z=0;z<i;z++)b[l][z]=a[l+1][z];var p=new Array(o);for(l=0;l<o;l++)p[l]=a[l+1][i];var x=0;for(z=0;z<i;z++)x+=(Math.abs(m[z])<M?0:m[z])*t[z];var F=new Array(i);for(z=0;z<i;z++)F[z]=a[0][z];return[m,b,p,u,x,f,F]}function F(t,n,r){for(var e=-1,o=-1,i=1;i<=n&&-1==o;)t[i][r]<-M&&(o=i),i++;if(-1==o)return[-1,-1];for(var a=0,l=0;l<r;l++)if(t[o][l]<-M){var z=-t[0][l]/t[o][l];(-1==e||z<a)&&(e=l,a=z)}return[e,o]}function L(t,n,r){for(var e=-1,o=-1,i=-M,a=1;a<=n;a++)t[a][r]<i&&(i=t[a][r],o=a);if(-1==o)return[-1,-1];i=0;for(var l=0;l<r;l++)if(t[o][l]<-M){var z=-t[0][l]/t[o][l];(-1==e||z<i)&&(e=l,i=z)}return[e,o]}function H(t,n,r){for(var e=0,o=[],i=1;i<=n;i++)if(t[i][r]<-M){e++;for(var a=0,l=[],z=0;z<r;z++)if(t[i][z]<-M){var u=-t[0][z]/t[i][z];0==l.length&&(a=u+1),u==a&&l.push(z),u<a&&(l=[z],a=u)}for(var s=0;s<l.length;s++)o.push([l[s],i])}return 0==e?1:0==o.length?2:o}function P(t,n,r){var e=H(t,n,r);if("number"==typeof e&&1==e)return[-1,-1];if("number"==typeof e&&2==e)return[0,-1];for(var o=-1,i=-1,a=0;a<e.length;a++){var l=t[0][e[a][0]]*t[e[a][1]][r]/t[e[a][1]][e[a][0]];o<l&&(o=l,i=a)}return e[i]}function c(t,n,r){for(var e=t.length,o=n.length,i=new Array(o),a=0;a<o;a++)i[a]=new Array(e);for(a=0;a<o;a++)for(var l=0;l<e;l++)i[a][l]=n[a][l];var z=new Array(e);for(l=0;l<e;l++)z[l]=t[l];for(a=0;a<o;a++){if(r[a]<0){z.push(0);for(var u=0;u<o;u++)u!=a&&i[u].push(0);i[a].push(1)}if(0<r[a]){z.push(0);for(u=0;u<o;u++)u!=a&&i[u].push(0);i[a].push(-1)}}return[z,i]}function l(t){if(t.length<3)return G(6);if(1!=GlobalFunctions.is_vector(t[0]))return G(7);if(1!=GlobalFunctions.is_matrix(t[1]))return G(7);if(1!=GlobalFunctions.is_vector(t[2]))return G(7);var n=t[0],r=t[1],e=t[2],o=n.length,i=e.length;if(r.length!=i)return G(8);if(r[0].length!=o)return G(8);for(var a=new Array(o),l=0;l<o;l++)a[l]=1;for(var z=new Array(i),u=0;u<i;u++)z[u]=0;if(_=0,y=!(M=1e-6),4==t.length){var s=t[3];if("object"==typeof s.signs&&1==GlobalFunctions.is_vector(s.signs)&&s.signs.length==o)for(l=0;l<o;l++)a[l]=0<s.signs[l]?1:s.signs[l]<0?-1:0;if("object"==typeof s.constraints&&1==GlobalFunctions.is_vector(s.constraints)&&s.constraints.length==i)for(u=0;u<i;u++)z[u]=0<s.constraints[u]?1:s.constraints[u]<0?-1:0;if("string"==typeof s.method){var f=s.method.trim().toLowerCase().replace("-","").replace("_","");"steepestedge"==f&&(_=0),"firstindex"==f&&(_=1),"smallestvalue"==f&&(_=2),"random"==f&&(_=3),"bland"==f&&(_=4)}"boolean"==typeof s.print&&(y=s.print),"number"==typeof s.accuracy&&(M=Math.max(s.accuracy,1e-12))}return[n,a,r,e,z]}function z(t,n,r,e,o){for(var i=t.length,a=e.length,l=new Array(a),z=0;z<a;z++)l[z]=new Array(i);for(z=0;z<a;z++)for(var u=0;u<i;u++)l[z][u]=r[z][u];var s=new Array(i);for(u=0;u<i;u++)s[u]=t[u];var f=new Array(a);for(z=0;z<a;z++)f[z]=e[z];var c=new Array(a);for(z=0;z<a;z++)c[z]=o[z];for(u=0;u<i;u++){if(n[u]<0){s[u]=-s[u];for(z=0;z<a;z++)l[z][u]=-l[z][u]}if(0==n[u]){s.push(-s[u]);for(z=0;z<a;z++)l[z].push(-l[z][u])}}for(i=s.length,z=0;z<a;z++)if(0<c[z]){c[z]=-1,f[z]=-f[z];for(u=0;u<i;u++)l[z][u]=-l[z][u]}return[s,l,f,c]}function u(t,n){for(var r=n.length,e=new Array(r),o=0,i=0,a=0;a<r;a++)0==n[a]&&i++;if(t.length<r+i)return G(4);for(a=0;a<r;a++)0<n[a]&&(e[a]=t[a]),n[a]<0&&(e[a]=-t[a]),0==n[a]&&(e[a]=t[a]-t[r+o],o++);return e}function h(t){var n=t.length,r=t[0].length;if(r<n)return G(4);for(var e=new Array(n),o=0;o<n;o++)e[o]=r-n+o;return e}function d(t,n,r,e){var o=c(t,n,e);if(0==o)return!1;var i=function(t,n){for(var r=t.length,e=t[0].length,o=new Array(r),i=0;i<r;i++)o[i]=new Array(e+1);for(i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=t[i][a];for(i=0;i<r;i++)o[i][e]=n[i];var l=0;for(a=0;l<r&&a<e;){var z=Math.abs(o[l][a]),u=l;for(i=l+1;i<r;i++)Math.abs(o[i][a])>z&&(z=Math.abs(o[i][a]),u=i);if(M<z){if(l<u)for(var s=a;s<=e;s++){var f=o[l][s];o[l][s]=o[u][s],o[u][s]=f}for(s=a+1;s<=e;s++)o[l][s]/=o[l][a];for(i=l+(o[l][a]=1);i<r;i++)if(Math.abs(o[i][a])>M){for(s=a+1;s<=e;s++)o[i][s]-=o[i][a]*o[l][s];o[i][a]=0}else o[i][a]=0;l++}else for(i=l;i<r;i++)o[i][a]=0;a++}for(;0<r&&1==g(o[r-1]);)r--;if(0==r)return G(4);if(r==t.length&&1==y){for(i=0;i<r;i++)for(a=0;a<e;a++)o[i][a]=t[i][a];for(i=0;i<r;i++)o[i][e]=n[i]}for(i=0;i<r;i++)if(o[i][e]<0)for(a=0;a<=e;a++)o[i][a]=-o[i][a];var c=0;for(i=0;i<r;i++)1!=v(o[i])&&c++;if(0<c)return G(2);var h=new Array(r),d=new Array(r);for(i=0;i<r;i++)h[i]=new Array(e);for(i=0;i<r;i++)for(a=0;a<e;a++)h[i][a]=o[i][a];for(i=0;i<r;i++)d[i]=o[i][e];return[h,d]}(o[1],r);if(0==i)return!1;var a=function(t,n){for(var r=t.length,e=t[0].length,o=new Array(r),i=new Array(r),a=0;a<r;a++)o[a]=new Array(e);for(a=0;a<r;a++)for(var l=0;l<e;l++)o[a][l]=t[a][l];for(a=0;a<r;a++)i[a]=n[a];for(a=0;a<r;a++)for(l=0;l<r;l++)o[a].push(a==l?1:0);var z=new Array(r);for(a=0;a<r;a++)z[a]=e+a;var u=new Array(e+r);for(l=0;l<e+r;l++)u[l]=l<e?0:1;return[u,o,i,z]}(i[0],i[1]);if(0==a)return!1;var l=f(a[0],a[1],a[2],a[3]);if(0==l)return!1;if(Math.abs(l[4])>=M)return G(2);s[0]=l[5];var z=function(t,n){for(var r=t.length,e=t[0].length,o=new Array(r),i=0;i<r;i++)o[i]=new Array(e);for(i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=t[i][a];var l=new Array(r);for(i=0;i<r;i++)l[i]=n[i];for(var z=0;z<r;z++)if(l[z]>=e-r){var u=-1,s=0;for(a=0;a<e-r;a++){var f=Math.abs(o[z][a]);1<f&&(f=1/f),s<f&&(s=f,u=a)}if(-1<u){for(a=0;a<e;a++)a!=u&&(o[z][a]/=o[z][u]);for(o[z][u]=1,i=0;i<r;i++)if(i!=z){for(a=0;a<e;a++)a!=u&&(o[i][a]-=o[i][u]*o[z][a]);o[i][u]=0}l[z]=u}}for(i=0;i<r;i++)if(l[i]>=e-r)return G(4);var c=new Array(r);for(i=0;i<r;i++)c[i]=new Array(e-r);for(i=0;i<r;i++)for(a=0;a<e-r;a++)c[i][a]=o[i][a];return[c,l]}(l[1],l[3]);if(0==z)return!1;var u=f(o[0],z[0],l[2],z[1]);return 0!=u&&(s[1]=u[5],[u[0],u[4]])}function m(t,n,r,e){var o=c(t,n,e);if(0==o)return!1;var i=h(o[1]);if(0==i)return!1;var a=function(t,n,r,e){for(var o=n.length,i=n[0].length,a=new Array(o+1),l=0;l<o+1;l++)a[l]=new Array(i+1);for(l=0;l<o;l++)for(var z=0;z<i;z++)a[l+1][z]=n[l][z];for(l=0;l<o;l++)a[l+1][i]=r[l];for(z=0;z<i;z++)a[0][z]=t[z];a[0][i]=0;var u=new Array(o);for(l=0;l<o;l++)u[l]=e[l];1==y&&(Console.print("Ausgangstableau:"),Console.print(a));for(var s,f=0,c=0,h=Math.min(w(i,o),1e3*i);0==c;){1==y&&(Console.print("Basis und Tableau:"),Console.print(u),Console.print(a));var d=[-1,-1];0==_&&(d=P(a,o,i)),1==_&&(d=F(a,o,i)),2==_&&(d=L(a,o,i)),3==_&&(d="number"==typeof(s=H(a,o,i))&&1==s?[-1,-1]:"number"==typeof s&&2==s?[0,-1]:s[Math.floor(s.length*Math.random())]),4==_&&(d=F(a,o,i));var g=d[0],v=d[1];if(-1==v&&(c=3),-1<v&&-1==g&&(c=2),0==c){for(z=0;z<=i;z++)z!=g&&(a[v][z]/=a[v][g]);for(a[v][g]=1,l=0;l<=o;l++)if(l!=v){for(z=0;z<=i;z++)z!=g&&(a[l][z]-=a[l][g]*a[v][z]);a[l][g]=0}for(z=0;z<i;z++)a[0][z]<0&&(a[0][z]=0);u[v-1]=g,f++}h<=f&&(c=5)}if(2==c)return G(2);if(5==c)return G(5);var m=new Array(i);for(z=0;z<i;z++)m[z]=0;for(l=0;l<o;l++)m[u[l]]=a[l+1][i];var b=new Array(o);for(l=0;l<o;l++)b[l]=new Array(i);for(l=0;l<o;l++)for(z=0;z<i;z++)b[l][z]=a[l+1][z];var p=new Array(o);for(l=0;l<o;l++)p[l]=a[l+1][i];var x=0;for(z=0;z<i;z++)x+=(Math.abs(m[z])<M?0:m[z])*t[z];return[m,b,p,u,x,f]}(o[0],o[1],r,i);return 0!=a&&(s[1]=a[5],[a[0],a[4]])}function b(t,n,r,e){return-2==o(e)&&1<=o(t)?m(t,n,r,e):-2==o(e)&&1<=o(r)?function(t,n,r,e){var o=c(t,n,e);if(0==o)return!1;var i=h(o[1]);if(0==i)return!1;var a=f(o[0],o[1],r,i);return 0!=a&&(s[1]=a[5],[a[0],a[4]])}(t,n,r,e):d(t,n,r,e)}this.minimize=function(){s=[i=0,0];var t=l(arguments);if(0==t)return a("minimize");var n=z(t[0],t[1],t[2],t[3],t[4]);if(0==n)return a("minimize");var r=b(n[0],n[1],n[2],n[3]);if(0==r)return a("minimize");var e=u(r[0],t[1]);return 0==e?a("minimize"):{x:e,value:r[1],iterations:s}},this.maximize=function(){s=[i=0,0];var t=l(arguments);if(0==t)return a("maximize");var n=function(t){for(var n=t.length,r=new Array(n),e=0;e<n;e++)r[e]=-t[e];return r}(t[0]);if(0==n)return a("maximize");var r=z(n,t[1],t[2],t[3],t[4]);if(0==r)return a("maximize");var e=b(r[0],r[1],r[2],r[3]);if(0==e)return a("maximize");var o=u(e[0],t[1]);return 0==o?a("maximize"):{x:o,value:-e[1],iterations:s}};var p={};function n(t){var n=p[t].c,r=p[t].z,e=p[t].A,o=p[t].b,i=p[t].s,a=n.length,l=o.length,z=new Array(a);if("number"==typeof r)for(var u=0;u<a;u++)z[u]=r;else z=r;var s=new Array(l);if("number"==typeof i)for(var f=0;f<l;f++)s[f]=i;else s=i;if(3!=e[0].length||e.length<4)return{c:n,z:z,A:e,b:o,s:s};var c=new Array(l);for(f=0;f<l;f++)c[f]=new Array(a);for(f=0;f<l;f++)for(u=0;u<a;u++)c[f][u]=0;for(var h=0;h<e.length;h++)c[e[h][0]][e[h][1]]=e[h][2];return{c:n,z:z,A:c,b:o,s:s}}p.md35={},p.md35.c=[3,-5,0,2,1],p.md35.z=1,p.md35.A=[[5,-2,3,-4,1],[0,1,0,1,0],[-2,5,-3,1,-1]],p.md35.b=[-6,9,-3],p.md35.s=0,p.afiro={},p.afiro.c=[0,-.4,0,0,0,0,0,0,0,0,0,0,-.32,0,0,0,-.6,0,0,0,0,0,0,0,0,0,0,0,-.48,0,0,10],p.afiro.z=1,p.afiro.A=[[0,0,-1],[0,1,1],[0,2,1],[1,0,-1.06],[1,3,1],[2,0,1],[3,1,-1],[3,12,1.4],[4,4,-1],[4,5,-1],[4,6,-1],[4,7,-1],[4,12,1],[4,13,1],[5,4,-1.06],[5,5,-1.06],[5,6,-.96],[5,7,-.86],[5,14,1],[6,4,1],[6,8,-1],[7,5,1],[7,9,-1],[8,6,1],[8,10,-1],[9,7,1],[9,11,-1],[10,15,-1],[10,16,1],[10,17,1],[10,18,1],[11,15,-.43],[11,19,1],[12,15,1],[13,16,-1],[13,28,1.4],[14,20,-.43],[14,21,-.43],[14,22,-.39],[14,23,-.37],[14,30,1],[15,20,1],[15,21,1],[15,22,1],[15,23,1],[15,28,-1],[15,29,1],[15,31,1],[16,20,1],[16,24,-1],[17,21,1],[17,25,-1],[18,22,1],[18,26,-1],[19,23,1],[19,27,-1],[20,8,2.364],[20,9,2.386],[20,10,2.408],[20,11,2.429],[20,18,-1],[20,24,2.191],[20,25,2.219],[20,26,2.249],[20,27,2.279],[21,2,-1],[21,15,.109],[22,13,-1],[22,20,.109],[22,21,.108],[22,22,.108],[22,23,.107],[23,0,.301],[23,17,-1],[24,4,.301],[24,5,.313],[24,6,.313],[24,7,.326],[24,29,-1],[25,3,1],[25,19,1],[26,14,1],[26,30,1]],p.afiro.b=[0,0,80,0,0,0,80,0,0,0,0,0,500,0,0,44,500,0,0,0,0,0,0,0,0,310,300],p.afiro.s=[0,0,-1,-1,0,0,-1,-1,-1,-1,0,0,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],this.example=function(){var t="";return 0<arguments.length&&"string"==typeof arguments[0].id&&(t=arguments[0].id),n("md35"==t?"md35":"afiro")}},LinearRegression=new function(){var f=!1,c=[];function h(t){if("object"!=typeof t||t.length<2)return-1;for(var n=0,r=0;r<t.length;r++){if("object"!=typeof t[r].input||"number"!=typeof t[r].target)return-1;if(1!=GlobalFunctions.is_vector(t[r].input))return-1;if(0==r&&(n=t[r].input.length),t[r].input.length!=n)return-1}return 1}function l(t){for(var n=c[0],r=0;r<t.length;r++)n+=t[r]*c[r+1];return n}this.evaluate=function(t){return 1!=f?GlobalFunctions.set_error("LinearRegression","evaluate","No regression calculated yet."):arguments.length<1?GlobalFunctions.set_error("LinearRegression","evaluate","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("LinearRegression","evaluate","Invalid function argument."):t.length+1!=c.length?GlobalFunctions.set_error("LinearRegression","evaluate","Invalid function argument."):l(t)},this.histogram=function(t){if(1!=f)return GlobalFunctions.set_error("LinearRegression","histogram","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LinearRegression","histogram","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LinearRegression","histogram","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LinearRegression","histogram","Invalid function argument.");var n="on";1<arguments.length&&"string"==typeof arguments[1].display&&(n=arguments[1].display);for(var r=[],e=0;e<t.length;e++)r.push(l(t[e].input)-t[e].target);return"on"==n&&function(t){for(var n=0,r=0;r<t.length;r++)n=Math.max(n,Math.abs(t[r]));n*=1.01,Chart.init(600,320,{digits:1}),Chart.histogram(t,{range:[-n,n],bins:16}),Chart.draw()}(r),r},this.mae=function(t){if(1!=f)return GlobalFunctions.set_error("LinearRegression","mae","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LinearRegression","mae","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LinearRegression","mae","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LinearRegression","mae","Invalid function argument.");for(var n=0,r=0;r<t.length;r++)n+=Math.abs(l(t[r].input)-t[r].target);return n/t.length},this.rmse=function(t){if(1!=f)return GlobalFunctions.set_error("LinearRegression","rmse","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LinearRegression","rmse","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LinearRegression","rmse","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LinearRegression","rmse","Invalid function argument.");for(var n=0,r=0;r<t.length;r++){var e=t[r].target-l(t[r].input);n+=e*e}return Math.sqrt(n/t.length)},this.r2=function(t){if(1!=f)return GlobalFunctions.set_error("LinearRegression","r2","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LinearRegression","r2","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LinearRegression","r2","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LinearRegression","r2","Invalid function argument.");for(var n=0,r=0;r<t.length;r++)n+=t[r].target;n/=t.length;var e=0,o=0;for(r=0;r<t.length;r++){var i=t[r].target-l(t[r].input);e+=i*i;var a=t[r].target-n;o+=a*a}return o<1e-8?-1:1-e/o},this.train=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LinearRegression","train","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LinearRegression","train","Invalid function argument.");f=!1,c=[];for(var n=[],r=[],e=0;e<t.length;e++){n.push([1]);for(var o=0;o<t[e].input.length;o++)n[e].push(t[e].input[o]);r.push(t[e].target)}var i=LinearAlgebra.transpose(n),a=LinearAlgebra.mult(i,n),l=LinearAlgebra.det(a);if(Math.abs(l)<1e-8)return GlobalFunctions.set_error("LinearRegression","train","Insufficient or collinear data.");var z=LinearAlgebra.invert(a);if("string"==typeof z)return GlobalFunctions.set_error("LinearRegression","train","Insufficient or collinear data.");var u=LinearAlgebra.mult(LinearAlgebra.mult(z,i),r);f=!0;for(var s=0;s<u.length;s++)c.push(u[s]);return u}},LogisticRegression=new function(){var s=!1,f=[],c=[];function h(t){if("object"!=typeof t||t.length<2)return-1;for(var n=0,r=0;r<t.length;r++){if("object"!=typeof t[r].input||"number"!=typeof t[r].target)return-1;var e=Math.round(t[r].target);if(e<0||1<e)return-1;if(1!=GlobalFunctions.is_vector(t[r].input))return-1;if(0==r&&(n=t[r].input.length),t[r].input.length!=n)return-1}return 1}function i(t,n){var r=[255,255,255,0];if(0<n){var e=GlobalFunctions.get_color("blue").rgba;r=[e[0],e[1],e[2],Math.round(200*t/n)]}return r}function l(t){for(var n=c[0],r=0;r<t.length;r++)n+=t[r]*c[r+1];return 1/(1+Math.exp(-n))}function d(t){for(var n=0,r=f[0].input.length,e=0;e<f.length;e++){for(var o=t[0],i=0;i<r;i++)o+=t[i+1]*f[e].input[i];var a=1/(1+Math.exp(-o));n-=1==f[e].target?Math.log(Math.max(1e-6,a)):Math.log(Math.max(1e-6,1-a))}return n}function g(){return d(arguments)}this.evaluate=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","evaluate","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","evaluate","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("LogisticRegression","evaluate","Invalid function argument.");if(t.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","evaluate","Invalid function argument.");var n="number";1<arguments.length&&"string"==typeof arguments[1].output&&(n=arguments[1].output);var r=l(t);return"index"==n?Math.round(r):"round"==n?0==Math.round(r)?[1,0]:[0,1]:r},this.test=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","test","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","test","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","test","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","test","Invalid function argument.");for(var n=0,r=0;r<t.length;r++)Math.round(l(t[r].input))==Math.round(t[r].target)&&n++;return n},this.histogram=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","histogram","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","histogram","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","histogram","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","histogram","Invalid function argument.");var n="on";1<arguments.length&&"string"==typeof arguments[1].display&&(n=arguments[1].display);for(var r,e=[],o=0;o<t.length;o++)e.push(l(t[o].input)-t[o].target);return"on"==n&&(r=e,Chart.init(600,320,{digits:2}),Chart.histogram(r,{range:[-1,1],bins:16}),Chart.draw()),e},this.mae=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","mae","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","mae","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","mae","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","mae","Invalid function argument.");for(var n=0,r=0;r<t.length;r++)n+=Math.abs(l(t[r].input)-t[r].target);return n/t.length},this.rmse=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","rmse","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","rmse","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","rmse","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","rmse","Invalid function argument.");for(var n=0,r=0;r<t.length;r++){var e=t[r].target-l(t[r].input);n+=e*e}return Math.sqrt(n/t.length)},this.r2=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","r2","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","r2","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","r2","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","r2","Invalid function argument.");for(var n=0,r=0;r<t.length;r++)n+=t[r].target;n/=t.length;var e=0,o=0;for(r=0;r<t.length;r++){var i=t[r].target-l(t[r].input);e+=i*i;var a=t[r].target-n;o+=a*a}return o<1e-8?-1:1-e/o},this.confusion_matrix=function(t){if(1!=s)return GlobalFunctions.set_error("LogisticRegression","confusion_matrix","No regression calculated yet.");if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","confusion_matrix","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","confusion_matrix","Invalid function argument.");if(t[0].input.length+1!=c.length)return GlobalFunctions.set_error("LogisticRegression","confusion_matrix","Invalid function argument.");var n="off";1<arguments.length&&"string"==typeof arguments[1].display&&(n=arguments[1].display);for(var r=[[0,0],[0,0]],e=0;e<t.length;e++)r[Math.round(t[e].target)][Math.round(l(t[e].input))]++;return"on"==n&&function(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.pow(t[e][o],.64));for(Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"}),Sketch.box(n/2,n/2,n,{fill:"#fafafa"}),e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:i(Math.pow(t[e][o],.64),r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(0));Sketch.draw()}(r),r},this.train=function(t){if(arguments.length<1)return GlobalFunctions.set_error("LogisticRegression","train","Invalid number of function arguments.");if(h(t)<1)return GlobalFunctions.set_error("LogisticRegression","train","Invalid function argument.");var n=t[0].input.length;s=!1,f=t,c=[];var r=1;1<arguments.length&&"number"==typeof arguments[1].runs&&(r=Math.max(1,Math.round(arguments[1].runs)));for(var e=[],o=0,i=0;i<r;i++){for(var a=[],l=0;l<n+1;l++)a.push(random(-1,1));var z=NonlinearProgramming.minimize(g,a,{maximal_iterations:1e6,accuracy:1e-4}),u=d(z);if(0==i||u<o){o=u,e=[];for(l=0;l<n+1;l++)e.push(z[l])}}s=!0;for(l=0;l<e.length;l++)c.push(e[l]);return e}},glb_int_time_onload=Date.now(),glb_list_keys={13:{a:0,key:"ENTER"},18:{a:0,key:"ALT"},19:{a:0,key:"PAUSE"},27:{a:0,key:"ESC"},32:{a:0,key:"SPACE"},33:{a:0,key:"PAGE_UP"},34:{a:0,key:"PAGE_DOWN"},35:{a:0,key:"END"},36:{a:0,key:"HOME"},37:{a:0,key:"LEFT"},38:{a:0,key:"UP"},39:{a:0,key:"RIGHT"},40:{a:0,key:"DOWN"},45:{a:0,key:"INSERT"},46:{a:0,key:"DELETE"},48:{a:0,key:"0"},49:{a:0,key:"1"},50:{a:0,key:"2"},51:{a:0,key:"3"},52:{a:0,key:"4"},53:{a:0,key:"5"},54:{a:0,key:"6"},55:{a:0,key:"7"},56:{a:0,key:"8"},57:{a:0,key:"9"},65:{a:0,key:"A"},66:{a:0,key:"B"},67:{a:0,key:"C"},68:{a:0,key:"D"},69:{a:0,key:"E"},70:{a:0,key:"F"},71:{a:0,key:"G"},72:{a:0,key:"H"},73:{a:0,key:"I"},74:{a:0,key:"J"},75:{a:0,key:"K"},76:{a:0,key:"L"},77:{a:0,key:"M"},78:{a:0,key:"N"},79:{a:0,key:"O"},80:{a:0,key:"P"},81:{a:0,key:"Q"},82:{a:0,key:"R"},83:{a:0,key:"S"},84:{a:0,key:"T"},85:{a:0,key:"U"},86:{a:0,key:"V"},87:{a:0,key:"W"},88:{a:0,key:"X"},89:{a:0,key:"Y"},90:{a:0,key:"Z"},112:{a:0,key:"F1"},113:{a:0,key:"F2"},114:{a:0,key:"F3"},115:{a:0,key:"F4"}};function animation_loop(){"object"==typeof Physics&&"function"==typeof Physics.step&&Physics.step(),"function"==typeof loop&&loop()}function time(){return(Date.now()-glb_int_time_onload)/Math.pow(10,3)}function on_click_event(t){"function"==typeof on_click&&on_click(t)}function random(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Main","random","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Main","random","Invalid function argument.");var r="real";2<arguments.length&&"string"==typeof arguments[2].type&&(r=arguments[2].type);var e=Math.min(t,n),o=Math.max(t,n);return"integer"!=r?e+(o-e)*Math.random():(e=Math.round(e),o=Math.round(o),Math.floor(e+(o-e+1)*Math.random()))}function vector(t){if(arguments.length<1)return GlobalFunctions.set_error("Main","vector","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Main","vector","Invalid function argument.");for(var n=Math.max(1,Math.round(t)),r=[],e=0;e<n;e++)r.push(0);return r}function matrix(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Main","matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Main","matrix","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Main","matrix","Invalid function argument.");for(var r=Math.max(1,Math.round(t)),e=Math.max(1,Math.round(n)),o=[],i=0;i<r;i++)o.push([]);for(i=0;i<r;i++)for(var a=0;a<e;a++)o[i].push(0);return o}function sort(t){if(arguments.length<1)return GlobalFunctions.set_error("Main","sort","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Main","sort","Invalid function argument.");for(var n=[],r=0;r<t.length;r++)n.push(t[r]);return n.sort(function(t,n){return t-n})}function popup_init(){var t=document.createElement("div");t.setAttribute("id","taralinopopup"),t.setAttribute("style","background:rgba(0,0,0,0.8); position:fixed; height:100%; width:100%; margin:0; left:0; top:0; font-family:sans-serif; z-index:65535;"),document.body.appendChild(t),document.getElementById("taralinopopup").innerHTML='<div style="box-sizing:border-box; position:relative; background-color:#fff; color:#202020; border-radius:10px; padding:40px 10%; text-align:center; left:50%; top:10%; width:80%; margin-left:-40%;"><div style="font-size:24px; font-weight:bold;">Notice</div><div id="taralinopopupcontent" style="font-size:16px; margin-top:24px; line-height:132%;"></div><div style="margin-top:24px;"><a href="javascript:void(0)" onclick="document.getElementById(\'taralinopopup\').style.display=\'none\';" style="display:inline-block; text-decoration:none; font-size:16px; background-color:#1a7cd0; color:#fff; border-radius:24px; padding:12px 24px;" onmouseover="this.style.backgroundColor=\'#42bc35\'" onmouseout="this.style.backgroundColor=\'#1a7cd0\'">OK</a></div></div>'}window.onload=function(){"function"==typeof setup&&setup(),"object"==typeof Animation&&"function"==typeof Animation.start&&Animation.start(),glb_int_time_onload=Date.now()},this.get_key_table=function(){return glb_list_keys},document.addEventListener("keydown",function(t){if(("function"==typeof on_key_down||"function"==typeof on_key_up)&&"number"==typeof t.keyCode){var n=t.keyCode;116!=n&&"function"==typeof t.preventDefault&&t.preventDefault();var r=glb_list_keys[n];"undefinded"!=typeof r&&0==r.a&&(r.a=1,"function"==typeof on_key_down&&on_key_down(r.key))}},!1),document.addEventListener("keyup",function(t){if(("function"==typeof on_key_down||"function"==typeof on_key_up)&&"number"==typeof t.keyCode){var n=t.keyCode;116!=n&&"function"==typeof t.preventDefault&&t.preventDefault();var r=glb_list_keys[n];"undefinded"!=typeof r&&(r.a=0,"function"==typeof on_key_up&&on_key_up(r.key))}},!1),this.popup=function(t){return arguments.length<1?GlobalFunctions.set_error("Main","popup","Invalid number of function arguments."):(1==GlobalFunctions.is_number(t)&&(t=t.toFixed(6)),1!=GlobalFunctions.is_string(t)?GlobalFunctions.set_error("Main","popup","Invalid function argument."):(1!=GlobalFunctions.is_div("taralinopopup")&&popup_init(),void(1==GlobalFunctions.is_div("taralinopopup")&&1==GlobalFunctions.is_div("taralinopopupcontent")&&(document.getElementById("taralinopopupcontent").innerHTML=t,document.getElementById("taralinopopup").style.display="inline"))))};var NearestNeighbor=new function(){var f=2;function u(t,n){return 1==f?function(t,n){for(var r=0,e=0;e<t.length;e++)r+=Math.abs(t[e]-n[e]);return r}(t,n):-1==f?function(t,n){for(var r=Math.abs(t[0]-n[0]),e=1;e<t.length;e++)r=Math.max(r,Math.abs(t[e]-n[e]));return r}(t,n):-2==f?function(t,n){for(var r=[0,0,0],e=0;e<t.length;e++)r[0]+=t[e]*n[e],r[1]+=t[e]*t[e],r[2]+=n[e]*n[e];return 0==r[1]&&0==r[2]?0:0==r[1]||0==r[2]?1:1-r[0]*r[0]/(r[1]*r[2])}(t,n):function(t,n){for(var r=0,e=0;e<t.length;e++){var o=t[e]-n[e];r+=o*o}return Math.sqrt(r)}(t,n)}function c(t,n){var r=[255,255,255,0];if(0<n){var e=GlobalFunctions.get_color("blue").rgba;r=[e[0],e[1],e[2],Math.round(200*t/n)]}return r}function h(t){if("object"!=typeof t||t.length<2)return-1;for(var n=0,r=0,e=0;e<t.length;e++){if("object"!=typeof t[e].input||"number"!=typeof t[e].index)return-1;if(1!=GlobalFunctions.is_vector(t[e].input))return-1;if(0==e&&(n=Math.max(1,t[e].input.length)),t[e].input.length!=n)return-1;if(t[e].index<0)return-1;r=Math.max(r,Math.round(t[e].index))}return r+1}function d(t,n,r,e){for(var o=[],i=0;i<t.length;i++)o.push([u(t[i].input,n),i]);o.sort(function(t,n){return t[0]-n[0]});var a=[];for(i=0;i<e;i++)a.push([0,i]);for(var l=0;l<r;l++)a[t[o[l][1]].index][0]++;a.sort(function(t,n){return n[0]-t[0]});for(var z=r;a[0][0]==a[1][0]&&z<t.length;)a.sort(function(t,n){return t[1]-n[1]}),a[t[o[z][1]].index][0]++,a.sort(function(t,n){return n[0]-t[0]}),z++;return a[0][1]}this.test=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("NearestNeighbor","test","Invalid number of function arguments.");var e=h(t);if(e<1)return GlobalFunctions.set_error("NearestNeighbor","test","Invalid function argument.");var o=h(n);if(o<1||e<o)return GlobalFunctions.set_error("NearestNeighbor","test","Invalid function argument.");if(t[0].input.length!=n[0].input.length)return GlobalFunctions.set_error("NearestNeighbor","test","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("NearestNeighbor","test","Invalid function argument.");var i=Math.max(1,Math.round(r));if(i>t.length)return GlobalFunctions.set_error("NearestNeighbor","test","Invalid function argument.");f=2,3<arguments.length&&"string"==typeof arguments[3].metric&&("manhattan"==arguments[3].metric.trim().toLowerCase()&&(f=1),"maximum"==arguments[3].metric.trim().toLowerCase()&&(f=-1),"cosine"==arguments[3].metric.trim().toLowerCase()&&(f=-2));for(var a=0,l=0;l<n.length;l++){d(t,n[l].input,i,e)==n[l].index&&a++}return a},this.confusion_matrix=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid number of function arguments.");var e=h(t);if(e<1)return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid function argument.");var o=h(n);if(o<1||e<o)return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid function argument.");if(t[0].input.length!=n[0].input.length)return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid function argument.");var i=Math.max(1,Math.round(r));if(i>t.length)return GlobalFunctions.set_error("NearestNeighbor","confusion_matrix","Invalid function argument.");f=2;var a="off";3<arguments.length&&("string"==typeof arguments[3].metric&&("manhattan"==arguments[3].metric.trim().toLowerCase()&&(f=1),"maximum"==arguments[3].metric.trim().toLowerCase()&&(f=-1),"cosine"==arguments[3].metric.trim().toLowerCase()&&(f=-2)),"string"==typeof arguments[3].display&&(a=arguments[3].display));for(var l=[],z=0;z<e;z++){l.push([]);for(var u=0;u<e;u++)l[z].push(0)}for(z=0;z<n.length;z++){var s=d(t,n[z].input,i,e);l[n[z].index][s]++}return"on"==a&&function(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.pow(t[e][o],.64));for(Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"}),Sketch.box(n/2,n/2,n,{fill:"#fafafa"}),e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:c(Math.pow(t[e][o],.64),r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(0));Sketch.draw()}(l),l},this.evaluate=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid number of function arguments.");var e=h(t);if(e<1)return GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid function argument.");if(n.length!=t[0].input.length)return GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid function argument.");var o=Math.max(1,Math.round(r));return o>t.length?GlobalFunctions.set_error("NearestNeighbor","evaluate","Invalid function argument."):(f=2,3<arguments.length&&"string"==typeof arguments[3].metric&&("manhattan"==arguments[3].metric.trim().toLowerCase()&&(f=1),"maximum"==arguments[3].metric.trim().toLowerCase()&&(f=-1),"cosine"==arguments[3].metric.trim().toLowerCase()&&(f=-2)),d(t,n,o,e))},this.get=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("NearestNeighbor","get","Invalid number of function arguments.");var e=GlobalFunctions.is_matrix(t)?function(t){for(var n=[],r=0;r<t.length;r++)n.push({input:t[r],index:0});return n}(t):t;if(h(e)<1)return GlobalFunctions.set_error("NearestNeighbor","get","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("NearestNeighbor","get","Invalid function argument.");if(n.length!=e[0].input.length)return GlobalFunctions.set_error("NearestNeighbor","get","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("NearestNeighbor","get","Invalid function argument.");var o=Math.max(1,Math.round(r));return o>e.length?GlobalFunctions.set_error("NearestNeighbor","get","Invalid function argument."):(f=2,3<arguments.length&&"string"==typeof arguments[3].metric&&("manhattan"==arguments[3].metric.trim().toLowerCase()&&(f=1),"maximum"==arguments[3].metric.trim().toLowerCase()&&(f=-1),"cosine"==arguments[3].metric.trim().toLowerCase()&&(f=-2)),function(t,n,r){for(var e=[],o=0;o<t.length;o++)e.push([u(t[o].input,n),o]);e.sort(function(t,n){return t[0]-n[0]});for(var i=[],a=0;a<r;a++)i.push(e[a][1]);return i}(e,n,o))}},NeuralNetwork=new function(){var g=[],v=[],m=!1,c=[],r=0,a=0,i=0,e="test";function h(t){for(var n=new Array(t),r=0;r<t;r++)n[r]=0;return n}function d(t,n){for(var r=new Array(t),e=0;e<t;e++)r[e]=new Array(n);for(e=0;e<t;e++)for(var o=0;o<n;o++)r[e][o]=0;return r}function l(t,n){for(var r=0;r<g.length;r++)for(var e=0;e<g[r].length;e++)for(var o=0;o<g[r][e].length;o++)g[r][e][o]+=t*n[0][r][e][o];for(r=0;r<v.length;r++)for(e=0;e<v[r].length;e++)v[r][e]+=t*n[1][r][e]}function z(t,n){for(var r=0;r<t[0].length;r++)for(var e=0;e<t[0][r].length;e++)for(var o=0;o<t[0][r][e].length;o++)t[0][r][e][o]+=n[0][r][e][o];for(r=0;r<t[1].length;r++)for(e=0;e<t[1][r].length;e++)t[1][r][e]+=n[1][r][e];return t}function u(t,n){var r=[255,255,255,0];if(0<n){var e=GlobalFunctions.get_color("blue").rgba;r=[e[0],e[1],e[2],Math.round(200*t/n)]}return r}function o(t,n){for(var r,e=t.length,o=v[n].length,i=new Array(o),a=0;a<o;a++)i[a]=v[n][a];for(a=0;a<o;a++)for(var l=0;l<e;l++)i[a]+=t[l]*g[n][a][l];for(a=0;a<o;a++)i[a]=(r=i[a],1/(1+Math.exp(-r)));return i}function b(t){for(var n=[],r=t,e=0;e<v.length;e++)r=o(r,e),n.push(r);return n}function s(t){for(var n=t,r=0;r<g.length;r++)n=o(n,r);return n}function f(t){if("object"!=typeof t||t.length<2)return!1;for(var n=0,r=0,e=0;e<t.length;e++){if("object"!=typeof t[e].input||"object"!=typeof t[e].output)return!1;if(1!=GlobalFunctions.is_vector(t[e].input)||1!=GlobalFunctions.is_vector(t[e].output))return!1;if(0==e&&(n=Math.max(1,t[e].input.length),r=Math.max(1,t[e].output.length)),t[e].input.length!=n||t[e].output.length!=r)return!1}return c[0]==n&&c[c.length-1]==r}function p(t){for(var n=0,r=t[n],e=1;e<t.length;e++)t[e]>r&&(r=t[n=e]);return n}function n(t){for(var n=0,r=0;r<t.length;r++){p(s(t[r].input))==p(t[r].output)&&n++}return n}function x(t,n){for(var r=[],e=[],o=0;o<g.length;o++)r.push(d(g[o].length,g[o][0].length)),e.push(h(v[o].length));var i=b(t),a=[];for(o=0;o<v.length;o++)a.push(h(v[o].length));for(o=v.length-1;0<=o;o--)for(var l=0;l<a[o].length;l++)if(o==v.length-1)a[o][l]=i[o][l]*(1-i[o][l])*(i[o][l]-n[l]);else{for(var z=0,u=0;u<a[o+1].length;u++)z+=g[o+1][u][l]*a[o+1][u];a[o][l]=i[o][l]*(1-i[o][l])*z}for(o=0;o<g.length;o++)for(u=0;u<g[o].length;u++)for(l=0;l<g[o][u].length;l++)r[o][u][l]=(0<o?i[o-1][l]:t[l])*a[o][u];for(o=0;o<v.length;o++)for(u=0;u<v[o].length;u++)e[o][u]=a[o][u];return[r,e]}function F(t){for(var n=t.length,r=Math.min(n,a),e=r==n?0:Math.floor(n*Math.random()),o=x(t[e].input,t[e].output),i=1;i<r;i++)o=z(o,x(t[e=r==n?i:Math.floor(n*Math.random())].input,t[e].output));return o}function y(t,n){for(var r=Math.min(t.length,a),e=i/r,o=0;o<n;o++){l(-e,F(t))}}this.evaluate=function(t){if(1!=m)return GlobalFunctions.set_error("NeuralNetwork","evaluate","NeuralNetwork not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("NeuralNetwork","evaluate","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("NeuralNetwork","evaluate","Invalid function argument.");if(t.length!=g[0][0].length)return GlobalFunctions.set_error("NeuralNetwork","evaluate","Improper dimension of function input data.");var n="";1<arguments.length&&"string"==typeof arguments[1].output&&(n=arguments[1].output);var r=s(t);return"index"==n?p(r):"round"==n?function(t){for(var n=[],r=0;r<t.length;r++)n.push(0);return n[p(t)]=1,n}(r):r},this.test=function(t){return 1!=m?GlobalFunctions.set_error("NeuralNetwork","test","NeuralNetwork not initialized yet."):arguments.length<1?GlobalFunctions.set_error("NeuralNetwork","test","Invalid number of function arguments."):1!=f(t)?GlobalFunctions.set_error("NeuralNetwork","test","Invalid function argument."):n(t)},this.confusion_matrix=function(t){if(1!=m)return GlobalFunctions.set_error("NeuralNetwork","confusion_matrix","NeuralNetwork not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("NeuralNetwork","confusion_matrix","Invalid number of function arguments.");if(1!=f(t))return GlobalFunctions.set_error("NeuralNetwork","confusion_matrix","Invalid function argument.");for(var n=s(t[0].input).length,r=[],e=0;e<n;e++){r.push([]);for(var o=0;o<n;o++)r[e].push(0)}for(var i=0;i<t.length;i++){var a=s(t[i].input);r[p(t[i].output)][p(a)]++}var l="off";return 1<arguments.length&&"string"==typeof arguments[1].display&&(l=arguments[1].display),"on"==l&&function(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.pow(t[e][o],.64));for(Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"}),Sketch.box(n/2,n/2,n,{fill:"#fafafa"}),e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:u(Math.pow(t[e][o],.64),r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(0));Sketch.draw()}(r),r},this.train=function(t){return 1!=m?GlobalFunctions.set_error("NeuralNetwork","train","NeuralNetwork not initialized yet."):arguments.length<1?GlobalFunctions.set_error("NeuralNetwork","train","Invalid number of function arguments."):1!=f(t)?GlobalFunctions.set_error("NeuralNetwork","train","Invalid function argument."):(r=1e3,a=100,i=5,1<arguments.length&&("number"==typeof arguments[1].iterations&&(r=Math.max(1,Math.min(Math.round(arguments[1].iterations),1e8))),"number"==typeof arguments[1].batch_size&&(a=Math.max(1,Math.round(arguments[1].batch_size))),"number"==typeof arguments[1].learning_rate&&(i=Math.abs(arguments[1].learning_rate))),void y(t,r))};var M,_,G,w=0,I=0,k=[],X=[],A=[],N=0;function L(t){G.beginPath(),G.rect(0,0,340,40),G.fillStyle="#f4f4f4",G.fill(),G.beginPath(),G.rect(10,10,320,20),G.fillStyle="#d4d4d4",G.fill(),G.beginPath(),G.rect(10,10,320*t,20),G.fillStyle="#005bca",G.fill()}function H(t){return"loss"==e?function(t){for(var n=0,r=0;r<t.length;r++){for(var e=s(t[r].input),o=t[r].output,i=0,a=0;a<e.length;a++)i+=(e[a]-o[a])*(e[a]-o[a]);n+=i}return 100*n/(t.length*t[0].output.length)}(t):n(t)}function P(t,n){var r=Math.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]));return dG1=24/r,G1=[t[0]+dG1*(n[0]-t[0]),t[1]+dG1*(n[1]-t[1])],dG2=(r-26)/r,G2=[t[0]+dG2*(n[0]-t[0]),t[1]+dG2*(n[1]-t[1])],[G1,G2]}function q(t,n,r,e){return[120+150*r,50*(n+t[r])/2-50*e-10]}this.progess_loop=function(){w++;var t=Math.round(r*w/64),n=Math.max(1,t-I);y(X,n),I+=n,k.push([I,H(A)]),L(I/r),r<=I&&(clearInterval(N),document.getElementById(M).innerHTML="","function"==typeof on_training_done&&on_training_done(k))},this.progress=function(t,n){return 1!=m?GlobalFunctions.set_error("NeuralNetwork","progress","NeuralNetwork not initialized yet."):arguments.length<2?GlobalFunctions.set_error("NeuralNetwork","progress","Invalid number of function arguments."):1!=f(t)?GlobalFunctions.set_error("NeuralNetwork","progress","Invalid function argument."):1!=f(n)?GlobalFunctions.set_error("NeuralNetwork","progress","Invalid function argument."):(r=1e3,a=100,i=5,e="test",2<arguments.length&&("number"==typeof arguments[2].iterations&&(r=Math.max(1,Math.min(Math.round(arguments[2].iterations),1e8))),"number"==typeof arguments[2].batch_size&&(a=Math.max(1,Math.round(arguments[2].batch_size))),"number"==typeof arguments[2].learning_rate&&(i=Math.abs(arguments[2].learning_rate)),"string"==typeof arguments[2].output&&(e=arguments[2].output.trim())),X=t,k=[[I=w=0,H(A=n)]],function(){M="random-id-"+(1e10*Math.random()).toFixed(0);var t=document.createElement("div");t.setAttribute("id",M),document.body.appendChild(t),document.getElementById(M).style.textAlign="center",document.getElementById(M).innerHTML="",M=M;var n="canvas-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(M).innerHTML='<canvas id="'+n+'" width="340" height="40"></canvas>',_=document.getElementById(n),G=_.getContext("2d"),L(0)}(),void(N=setInterval(this.progess_loop,20)))},this.init=function(t){if(m=!1,arguments.length<1)return GlobalFunctions.set_error("NeuralNetwork","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("NeuralNetwork","init","Invalid function argument.");if(t.length<2)return GlobalFunctions.set_error("NeuralNetwork","init","Length of input vector must be at least 2.");c=[];for(var n=0;n<t.length;n++)c.push(Math.max(1,Math.round(t[n])));!function(){g=[],v=[];for(var t=0;t<c.length-1;t++){for(var n=d(c[t+1],c[t]),r=0;r<c[t+1];r++)for(var e=0;e<c[t];e++)n[r][e]=2*Math.random()-1;g.push(n);var o=h(c[t+1]);for(e=0;e<c[t+1];e++)o[e]=2*Math.random()-1;v.push(o)}}(),m=!0},this.set_weights_and_biases=function(t){if(arguments.length<1)return GlobalFunctions.set_error("NeuralNetwork","set_weights_and_biases","Invalid number of function arguments.");if("object"!=typeof t)return GlobalFunctions.set_error("NeuralNetwork","set_weights_and_biases","Invalid function argument.");if("object"!=typeof t.weights||"object"!=typeof t.biases)return GlobalFunctions.set_error("NeuralNetwork","set_weights_and_biases","Invalid function argument.");var n=t.weights,r=t.biases;if(1==GlobalFunctions.is_matrix(n)&&1==GlobalFunctions.is_vector(r)&&(n=[n],r=[r]),"object"!=typeof n)return!1;if("object"!=typeof r)return!1;if(n.length!=r.length)return!1;for(var e=n.length,o=!1,i=0;i<e;i++)1!=GlobalFunctions.is_matrix(n[i])&&(o=!0),1!=GlobalFunctions.is_vector(r[i])&&(o=!0);if(1==o)return!1;var a=[n[0][0].length];for(i=0;i<e;i++)a.push(r[i].length);var l=!1;for(i=0;i<e;i++)n[i].length!=a[i+1]&&(l=!0),n[i][0].length!=a[i]&&(l=!0);a.length!=c.length&&(l=!0);for(i=0;i<a.length;i++)a[i]!=c[i]&&(l=!0);if(1==l)return!1;g=[],v=[];for(i=0;i<e;i++){for(var z=d(a[i+1],a[i]),u=0;u<a[i+1];u++)for(var s=0;s<a[i];s++)z[u][s]=n[i][u][s];g.push(z);var f=h(a[i+1]);for(u=0;u<a[i+1];u++)f[u]=r[i][u];v.push(f)}return!0},this.set_data=function(t){return m=!1,arguments.length<1?GlobalFunctions.set_error("NeuralNetwork","set_data","Invalid number of function arguments."):"object"!=typeof t?GlobalFunctions.set_error("NeuralNetwork","set_data","Invalid function argument."):"object"!=typeof t.layout||"object"!=typeof t.weights||"object"!=typeof t.biases?GlobalFunctions.set_error("NeuralNetwork","set_data","Invalid function argument."):(this.init(t.layout),m=!1,1!=this.set_weights_and_biases(t)?GlobalFunctions.set_error("NeuralNetwork","set_data","Copying of data failed due to improper input dimensions."):void(m=!0))},this.plot=function(t){if(1!=m)return GlobalFunctions.set_error("NeuralNetwork","plot","NeuralNetwork not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("NeuralNetwork","plot","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("NeuralNetwork","plot","Invalid function argument.");if(t.length!=g[0][0].length)return GlobalFunctions.set_error("NeuralNetwork","plot","Improper dimension of function input data.");for(var n=[g[0][0].length],r=n[0],e=0;e<v.length;e++)n.push(v[e].length),r=Math.max(r,v[e].length);var o=b(t);o.unshift(t);var i,a,l,z,u=150*(n.length-1)+240,s=50*(r-1)+80;Sketch.init([0,u],[0,s],{width:u,background:"#f2f2f2"});for(e=0;e<n.length-1;e++)for(var f=0;f<n[e];f++)for(var c=0;c<n[e+1];c++){var h=P(q(n,r,e,f),q(n,r,e+1,c));Sketch.arrow(h[0][0],h[0][1],h[1][0],h[1][1],{stroke:"#0059c5"})}for(f=0;f<n[0];f++){h=P([(d=q(n,r,0,f))[0]-100,d[1]],d);Sketch.arrow(h[0][0],h[0][1],h[1][0],h[1][1],{stroke:"#0059c5"})}for(f=0;f<n[n.length-1];f++){h=P(d=q(n,r,n.length-1,f),[d[0]+100,d[1]]);Sketch.arrow(h[0][0],h[0][1],h[1][0],h[1][1],{stroke:"#0059c5"})}for(e=0;e<n.length;e++)for(f=0;f<n[e];f++){var d=q(n,r,e,f);Sketch.circle(d[0],d[1],14,{fill:(i=o[e][f],void 0,void 0,void 0,a=Math.max(0,Math.min(i,1)),l=[0,89,197],z=[255,255,255],[Math.round(a*l[0]+(1-a)*z[0]),Math.round(a*l[1]+(1-a)*z[1]),Math.round(a*l[2]+(1-a)*z[2])]),stroke:"#0059c5"})}Sketch.draw()},this.get_data=function(){return 1!=m?GlobalFunctions.set_error("NeuralNetwork","get_data","NeuralNetwork not initialized yet."):{layout:c,weights:g,biases:v}},this.export_data=function(){if(1!=m)return GlobalFunctions.set_error("NeuralNetwork","export_data","NeuralNetwork not initialized yet.");var t="",n=4;0<arguments.length&&("string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),"number"==typeof arguments[0].digits&&(n=Math.max(0,Math.min(Math.round(arguments[0].digits),12))));var r="var T = {\n";r+="layout:[";for(var e=0;e<c.length;e++)r+=c[e].toFixed(0)+(e<c.length-1?",":"");r+="],\n",r+="weights:[";for(e=0;e<g.length;e++){r+="[";for(var o=0;o<g[e].length;o++){r+="[";for(var i=0;i<g[e][o].length;i++)r+=g[e][o][i].toFixed(n)+(i<g[e][o].length-1?",":"");r+="]"+(o<g[e].length-1?",":"")}r+="]"+(e<g.length-1?",":"")}r+="],\n",r+="biases:[";for(e=0;e<v.length;e++){r+="[";for(o=0;o<v[e].length;o++)r+=v[e][o].toFixed(n)+(o<v[e].length-1?",":"");r+="]"+(e<v.length-1?",":"")}r+="]\n",r+="};\n",""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(r):document.getElementById(t).value=r}},Nlp=new function(){var l=!1,z=[],u={},s="";function f(t){var n=t.toLowerCase();return n=(n=(n=(n=(n=(n=n.trim()).replace("'","")).replace(/[^a-zA-Z0-9]/g," ")).replace(/\s{2,}/g," ")).trim()).split(" ")}function c(t){return"number"!=typeof u[t]?-1:u[t]}this.init=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Nlp","init","Invalid number of function arguments.");if("object"!=typeof t||t.length<2)return GlobalFunctions.set_error("Nlp","init","Invalid function argument.");for(var n=0;n<t.length;n++)if("string"!=typeof t[n].input)return GlobalFunctions.set_error("Nlp","init","Invalid function argument.");var r=0,e={};for(n=0;n<t.length;n++)for(var o={},i=f(t[n].input),a=0;a<i.length;a++)i[a].length<2||("object"==typeof e[i[a]]?(e[i[a]].count++,"number"!=typeof o[i[a]]&&(o[i[a]]=0,e[i[a]].frequency++)):(e[i[a]]={index:r,count:1,frequency:1,idf:0},o[i[a]]=0,r++));for(var a in e)e[a].idf=Math.log(t.length/e[a].frequency);for(var a in z=[],e)z.push({word:a,count:e[a].count,frequency:e[a].frequency,idf:e[a].idf});z.sort(function(t,n){return n.count-t.count}),u={};for(n=0;n<z.length;n++)u[z[n].word]=n;l=!0},this.bag_of_words=function(){return 1!=l?GlobalFunctions.set_error("Nlp","bag_of_words","Nlp not initialized yet."):z},this.vectorize=function(t){return 1!=l?GlobalFunctions.set_error("Nlp","vectorize","Nlp not initialized yet."):arguments.length<1?GlobalFunctions.set_error("Nlp","vectorize","Invalid number of function arguments."):1!=GlobalFunctions.is_string(t)?GlobalFunctions.set_error("Nlp","vectorize","Invalid function argument."):(s="tf",1<arguments.length&&"string"==typeof arguments[1].method&&(s=arguments[1].method),function(t){for(var n=[],r=0;r<z.length;r++)n.push(0);var e=f(t);if("binary"==s){for(var o=0;o<e.length;o++)0<=(i=c(e[o]))&&(n[i]=1);return n}for(o=0;o<e.length;o++){var i;0<=(i=c(e[o]))&&n[i]++}var a=1;for(r=0;r<n.length;r++)a=Math.max(a,n[r]);for(r=0;r<n.length;r++)n[r]/=a;if("tf"==s)return n;for(r=0;r<n.length;r++)n[r]*=z[r].idf;return n}(t))}},NonlinearProgramming=new function(){var o,i=1,m=0,b=1e3,p=1e-6;function f(t){for(var n=t.length,r=new Array(n),e=new Array(n),o=0;o<n;o++)e[o]=t[o];for(o=0;o<n;o++)e[o]=t[o]+1e-6,r[o]=y(e),e[o]=t[o]-1e-6,r[o]-=y(e),r[o]/=2e-6,e[o]=t[o];return r}function a(t){for(var n=t.length,r=new Array(n),e=0;e<n;e++)r[e]=t[e];for(var o=y(r),i=1,a="run";m<b&&"run"==a;){m++;var l=f(r),z=new Array(n);for(e=0;e<n;e++)z[e]=r[e]-i*l[e];var u=y(z),s=0;for(e=0;e<n;e++)s+=Math.abs(l[e]);if(s<=p)a="done";else if(1e10<i)a="illposed";else{for(e=s=0;e<n;e++)s+=Math.abs(r[e]);if(1e12<s)a="unbounded";else if(u!=o)if(u<o){for(e=0;e<n;e++)r[e]=z[e];o=u,i*=1.7}else{for(;o<u&&p<i;){i*=.53;for(e=0;e<n;e++)z[e]=r[e]-i*l[e];u=y(z)}if(i<=p)a="done";else{for(e=0;e<n;e++)r[e]=z[e];o=u}}else i*=.87}}return"illposed"==a?"illposed":"unbounded"==a?"unbounded":[r,o]}function x(t){var a=[],o=[];function l(t,n){var r=a[t];a[t]=a[n],a[n]=r;var e=o[t];o[t]=o[n],o[n]=e}for(var n=0;n<t.length;n++)a.push(t[n]);for(n=0;n<t.length;n++)o.push(n);return function t(n,r){if(n<r-1){var e=Math.floor(.5*(n+r));t(n,e=function(t,n,r){var e=a[r];l(r,n-1);for(var o=t,i=t;i<n-1;i++)a[i]<=e&&(l(o,i),o++);return l(n-1,o),o}(n,r,e)),t(e+1,r)}}(0,a.length),o}function F(t){for(var n=t.length-1,r=0,e=new Array(n),o=0;o<n;o++)e[o]=0;for(var i=0;i<=n;i++)for(o=0;o<n;o++)e[o]+=t[i][o];for(o=0;o<n;o++)e[o]/=n+1;for(i=0;i<=n;i++){var a=0;for(o=0;o<n;o++)a+=(e[o]-t[i][o])*(e[o]-t[i][o]);r=Math.max(r,Math.sqrt(a))}return r}function l(t){for(var n=t.length,r=new Array(n+1),e=new Array(n+1),o="run",i=0,a=0;a<=n;a++){r[a]=new Array(n);for(var l=0;l<n;l++)r[a][l]=t[l]}for(l=0;l<n;l++)r[l][l]*=1.05,Math.abs(r[l][l])<25e-5&&(r[l][l]=25e-5*(0<=r[l][l]?1:-1));for(a=0;a<=n;a++)e[a]=y(r[a]);for(;m<b&&"run"==o;){m++;var z=x(e);if(F(r)<p&&e[z[n]]-e[z[0]]<p)o="done",i=z[0];else{var u=0;for(l=0;l<n;l++)u+=Math.abs(r[z[0]][l]);if(1e20<u)o="unbounded";else{var s=new Array(n);for(l=0;l<n;l++)s[l]=0;for(l=0;l<n;l++)for(a=0;a<n;a++)s[l]+=r[z[a]][l];for(l=0;l<n;l++)s[l]/=n;var f=new Array(n);for(l=0;l<n;l++)f[l]=2*s[l]-r[z[n]][l];var c=y(f);if(c<e[z[0]]){var h=new Array(n);for(l=0;l<n;l++)h[l]=3*s[l]-2*r[z[n]][l];var d=y(h);if(d<c){for(l=0;l<n;l++)r[z[n]][l]=h[l];e[z[n]]=d}else{for(l=0;l<n;l++)r[z[n]][l]=f[l];e[z[n]]=c}}else if(c<e[z[n-1]]){for(l=0;l<n;l++)r[z[n]][l]=f[l];e[z[n]]=c}else{var g=new Array(n);if(c<e[z[n]])for(l=0;l<n;l++)g[l]=.5*s[l]+.5*f[l];else for(l=0;l<n;l++)g[l]=.5*s[l]+.5*r[z[n]][l];var v=y(g);if(v<e[z[n]]){for(l=0;l<n;l++)r[z[n]][l]=g[l];e[z[n]]=v}else for(a=1;a<=n;a++){for(l=0;l<n;l++)r[z[a]][l]=.5*r[z[0]][l]+.5*r[z[a]][l];e[z[a]]=y(r[z[a]])}}}}}return"unbounded"==o?"unbounded":[r[i],e[i]]}function y(t){return i*o.apply(o,t)}function z(t){return isFinite(y(t))}this.iterations=function(){return m},this.minimize=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("NonlinearProgramming","minimize","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("NonlinearProgramming","minimize","Invalid function argument.");if(1!=GlobalFunctions.is_number(n)&&1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("NonlinearProgramming","minimize","Invalid function argument.");if(1==GlobalFunctions.is_number(n)&&(n=[n]),o=t,1!=z(n))return GlobalFunctions.set_error("NonlinearProgramming","minimize","Invalid function argument.");m=0,i=1,b=1e3,p=1e-6;var r="nelder";2<arguments.length&&("number"==typeof arguments[2].maximal_iterations&&(b=Math.max(1,Math.round(arguments[2].maximal_iterations))),"number"==typeof arguments[2].accuracy&&(p=Math.max(1e-12,arguments[2].accuracy)),"string"==typeof arguments[2].method&&(r=arguments[2].method));var e="gradient"==r?a(n):l(n);return"unbounded"==e||"illposed"==e?GlobalFunctions.set_error("NonlinearProgramming","minimize","Optimization problem unbounded or ill-posed."):(b<=m&&GlobalFunctions.set_warning("NonlinearProgramming","minimize","Maximum number of iterations achieved. Result may not satisfy expected accuracy."),1==e[0].length?e[0][0]:e[0])},this.maximize=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("NonlinearProgramming","maximize","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("NonlinearProgramming","maximize","Invalid function argument.");if(1!=GlobalFunctions.is_number(n)&&1!=GlobalFunctions.is_vector(n))return GlobalFunctions.set_error("NonlinearProgramming","maximize","Invalid function argument.");if(1==GlobalFunctions.is_number(n)&&(n=[n]),o=t,1!=z(n))return GlobalFunctions.set_error("NonlinearProgramming","maximize","Invalid function argument.");m=0,i=-1,b=1e3,p=1e-6;var r="nelder";2<arguments.length&&("number"==typeof arguments[2].maximal_iterations&&(b=Math.max(1,Math.round(arguments[2].maximal_iterations))),"number"==typeof arguments[2].accuracy&&(p=Math.max(1e-12,arguments[2].accuracy)),"string"==typeof arguments[2].method&&(r=arguments[2].method));var e="gradient"==r?a(n):l(n);return"unbounded"==e||"illposed"==e?GlobalFunctions.set_error("NonlinearProgramming","maximize","Optimization problem unbounded or ill-posed."):(b<=m&&GlobalFunctions.set_warning("NonlinearProgramming","maximize","Maximum number of iterations achieved. Result may not satisfy expected accuracy."),1==e[0].length?e[0][0]:e[0])}},Ode=new function(){var a,c=.8,h=1.5,d=0,g=0,v=0;function l(t,n){return 11==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o];return r}(t,n):21==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o]/2;var i=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*i[o];return r}(t,n):22==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o];var i=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*(e[o]/2+i[o]/2);return r}(t,n):31==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o]/3;var i=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+2*t*i[o]/3;var a=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*(e[o]/4+3*a[o]/4);return r}(t,n):32==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o]/2;var i=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*(-1*e[o]+2*i[o]);var a=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*(e[o]/6+2*i[o]/3+a[o]/6);return r}(t,n):41==g?function(t,n){for(var r=new Array(n.length),e=p(n),o=0;o<r.length;o++)r[o]=n[o]+t*e[o]/2;var i=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*i[o]/2;var a=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*a[o];var l=p(r);for(o=0;o<r.length;o++)r[o]=n[o]+t*(e[o]/6+i[o]/3+a[o]/3+l[o]/6);return r}(t,n):n}function m(t){for(var n=0,r=0;r<t.length;r++)n+=t[r]*t[r];return Math.sqrt(n)}function b(t,n){return 3==g?function(t,n){for(var r=new Array(n.length),e=new Array(n.length),o=p(n),i=0;i<r.length;i++)r[i]=n[i]+t*o[i]/2;var a=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+3*t*a[i]/4;var l=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(2*o[i]+3*a[i]+4*l[i])/9;var z=p(r);for(i=0;i<r.length;i++)e[i]=t*(5*o[i]/72-a[i]/12-l[i]/9+z[i]/8);return new Array(m(e),r)}(t,n):4==g?function(t,n){for(var r=new Array(n.length),e=new Array(n.length),o=p(n),i=0;i<r.length;i++)r[i]=n[i]+t*o[i]/2;var a=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*a[i]/2;var l=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*l[i];var z=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(o[i]/6+a[i]/3+l[i]/3+z[i]/6);var u=p(r);for(i=0;i<r.length;i++)e[i]=t*(z[i]-u[i])/6;return new Array(m(e),r)}(t,n):5==g?function(t,n){for(var r=new Array(n.length),e=new Array(n.length),o=p(n),i=0;i<r.length;i++)r[i]=n[i]+t*o[i]/5;var a=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(3*o[i]/40+9*a[i]/40);var l=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(44*o[i]/45-56*a[i]/15+32*l[i]/9);var z=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(19372*o[i]/6561-25360*a[i]/2187+64448*l[i]/6561-212*z[i]/729);var u=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(9017*o[i]/3168-355*a[i]/33+46732*l[i]/5247+49*z[i]/176-5103*u[i]/18656);var s=p(r);for(i=0;i<r.length;i++)r[i]=n[i]+t*(35*o[i]/384+500*l[i]/1113+125*z[i]/192-2187*u[i]/6784+11*s[i]/84);var f=p(r);for(i=0;i<r.length;i++)e[i]=t*(71*o[i]/57600-71*l[i]/16695+71*z[i]/1920-17253*u[i]/339200+22*s[i]/525-f[i]/40);return new Array(m(e),r)}(t,n):n}function p(t){var n=a.apply(a,t);"number"==typeof n&&(n=[n]);for(var r=t.length;n.length<t.length;)r--,n.unshift(t[r]);return n}this.solve=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Ode","solve","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("Ode","solve","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n)&&1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Ode","solve","Invalid function argument.");if(1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Ode","solve","Invalid function argument.");if(1==GlobalFunctions.is_number(n)&&(n=[n]),r<=0)return GlobalFunctions.set_error("Ode","solve","Invalid function argument.");if(a=t,1!=function(t){var n=a.apply(a,t);if("number"==typeof n&&(n=[n]),1!=GlobalFunctions.is_vector(n))return!1;d=n.length;var r=t.length/n.length;return!(1e-6<Math.abs(r-Math.round(r)))}(n))return GlobalFunctions.set_error("Ode","solve","Invalid function argument.");g=5,v=1e-10;var e,o=r/Math.pow(10,3);3<arguments.length&&("string"==typeof arguments[3].method&&(g=Math.max(g,"euler"==(e=arguments[3].method)?11:"midpoint"==e?21:"trapezoid"==e?22:"heun"==e?31:"simpson"==e?32:"runge"==e?41:"adaptive32"==e?3:"adaptive43"==e?4:"adaptive54"==e?5:-1)),"number"==typeof arguments[3].accuracy&&(v=Math.max(1e-12,Math.abs(arguments[3].accuracy))),"number"==typeof arguments[3].step_size&&(o=Math.max(1e-12,Math.abs(arguments[3].step_size))));var i=g<10?function(t,n){for(var r=0,e=t,o=[],i=0;i<d;i++)o.push([]);for(i=0;i<d;i++)o[i].push([r,e[i]]);for(var a,l,z,u,s=v;r<=n;){var f=b(s,e);for(e=f[1],r+=s,i=0;i<d;i++)o[i].push([r,e[i]]);a=s,l=f[0],z=g,u=h-a*(h-1),s=l<=v*a*Math.pow(c/u,z)?u*a:c*a*Math.pow(v*a/l,1/z)}return o}(n,r):function(t,n,r){for(var e=0,o=t,i=[],a=0;a<d;a++)i.push([]);for(a=0;a<d;a++)i[a].push([e,o[a]]);for(;e<=n;)for(o=l(r,o),e+=r,a=0;a<d;a++)i[a].push([e,o[a]]);return i}(n,r,o);return 1==i.length?i[0]:i}},Picture=new function(){var d="";function z(t){if("object"!=typeof t)return 0;var n=t.length;if(n<1)return 0;if("object"!=typeof t[0])return 0;var r=t[0].length;if(r<1)return 0;for(var e=1;e<n;e++)if("object"!=typeof t[e]||t[e].length!=r)return 0;if("number"==typeof t[0][0]){for(e=0;e<n;e++)for(var o=0;o<r;o++)if("number"!=typeof t[e][o]||1!=isFinite(t[e][o]))return 0;return 1}if("object"!=typeof t[0][0])return 0;for(e=0;e<n;e++)for(o=0;o<r;o++){if("object"!=typeof t[e][o]||3!=t[e][o].length)return 0;if(1!=isFinite(t[e][o][0])||1!=isFinite(t[e][o][1])||1!=isFinite(t[e][o][2]))return 0}return 3}function a(t,n){var r=[];if(1==n)for(var e=0;e<t.length;e++){r.push([]);for(var o=0;o<t[e].length;o++){var i=Math.max(0,Math.min(Math.round(t[e][o]),255));r[e].push(i)}}if(3==n)for(e=0;e<t.length;e++){r.push([]);for(o=0;o<t[e].length;o++){i=Math.max(0,Math.min(Math.round((t[e][o][0]+t[e][o][1]+t[e][o][2])/3),255));r[e].push(i)}}return r}this.draw=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","draw","Invalid number of function arguments.");var n=z(t);if(1!=n&&3!=n)return GlobalFunctions.set_error("Picture","draw","Invalid image data.");var r="",e=1,o="";if(1<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),"number"==typeof arguments[1].zoom&&(e=Math.max(1,Math.min(Math.round(arguments[1].zoom),1024))),"string"==typeof arguments[1].display&&(o=arguments[1].display)),""==r||1!=GlobalFunctions.is_div(r)){var i=document.createElement("div");""==r&&(r="random-id-"+(1e10*Math.random()).toFixed(0)),i.setAttribute("id",r),document.body.appendChild(i)}d=r,function(t,n,r,e){var o=t.length*n,i=t[0].length*n,a="picture-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(d).style.textAlign="center","inline-block"==e&&(document.getElementById(d).style.display="inline-block",document.getElementById(d).style.padding="4px 4px 0px 4px"),document.getElementById(d).innerHTML='<canvas id="'+a+'" width="'+i+'" height="'+o+'"></canvas>';for(var l=document.getElementById(a).getContext("2d"),z=l.createImageData(i,o),u=0;u<z.data.length;u+=4){var s=Math.floor(u/4),f=Math.floor(s/i),c=s%i;if(f=Math.floor(f/n),c=Math.floor(c/n),1==r){var h=Math.max(0,Math.min(Math.round(t[f][c]),255));z.data[u+0]=h,z.data[u+1]=h,z.data[u+2]=h}else z.data[u+0]=Math.max(0,Math.min(Math.round(t[f][c][0]),255)),z.data[u+1]=Math.max(0,Math.min(Math.round(t[f][c][1]),255)),z.data[u+2]=Math.max(0,Math.min(Math.round(t[f][c][2]),255));z.data[u+3]=255}l.putImageData(z,0,0)}(t,e,n,o)};var u=[];function s(t,n){for(var r=n.length,e=Math.round((r-1)/2),o=[],i=0;i<t.length;i++){o.push([]);for(var a=0;a<t[i].length;a++){for(var l=0,z=0;z<r;z++)for(var u=0;u<r;u++){var s=Math.max(0,Math.min(i+z-e,t.length-1)),f=Math.max(0,Math.min(a+u-e,t[i].length-1));l+=n[z][u]*t[s][f]}l=Math.max(0,Math.min(Math.round(l),255)),o[i].push(l)}}return o}function f(t,n){for(var r=n.length,e=Math.round((r-1)/2),o=[],i=0;i<t.length;i++){o.push([]);for(var a=0;a<t[i].length;a++){for(var l=[],z=0;z<3;z++){for(var u=0,s=0;s<r;s++)for(var f=0;f<r;f++){var c=Math.max(0,Math.min(i+s-e,t.length-1)),h=Math.max(0,Math.min(a+f-e,t[i].length-1));u+=n[s][f]*t[c][h][z]}u=Math.max(0,Math.min(Math.round(u),255)),l.push(u)}o[i].push(l)}}return o}function l(t,n,r){for(var e=n.length,o=[],i=0;i<t.length;i++){o.push([]);for(var a=0;a<t[i].length;a++){for(var l=0;l<e-2&&t[i][a]>n[l+1];)l++;var z=Math.max(0,Math.min((t[i][a]-n[l])/(n[l+1]-n[l]),1));o[i].push(Math.max(0,Math.min(Math.round(z*r[l+1]+(1-z)*r[l]),255)))}}return o}function i(t,n,r){for(var e=n.length,o=[],i=0;i<t.length;i++){o.push([]);for(var a=0;a<t[i].length;a++){for(var l=0;l<e-2&&t[i][a]>n[l+1];)l++;var z=0,u=[];z=Math.max(0,Math.min((t[i][a][0]-n[l])/(n[l+1]-n[l]),1)),u.push(Math.max(0,Math.min(Math.round(z*r[l+1]+(1-z)*r[l]),255))),z=Math.max(0,Math.min((t[i][a][1]-n[l])/(n[l+1]-n[l]),1)),u.push(Math.max(0,Math.min(Math.round(z*r[l+1]+(1-z)*r[l]),255))),z=Math.max(0,Math.min((t[i][a][2]-n[l])/(n[l+1]-n[l]),1)),u.push(Math.max(0,Math.min(Math.round(z*r[l+1]+(1-z)*r[l]),255))),o[i].push(u)}}return o}u.blur=[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],u.gauss3=[[2/37,5/37,2/37],[5/37,9/37,5/37],[2/37,5/37,2/37]],u.gauss5=[[2/159,4/159,5/159,4/159,2/159],[4/159,9/159,12/159,9/159,4/159],[5/159,12/159,15/159,12/159,5/159],[4/159,9/159,12/159,9/159,4/159],[2/159,4/159,5/159,4/159,2/159]],u.sharpen=[[0,-1,0],[-1,5,-1],[0,-1,0]],u.edge=[[0,1,0],[1,-4,1],[0,1,0]],u.sobelX=[[1,0,-1],[2,0,-2],[1,0,-1]],u.sobelY=[[1,2,1],[0,0,0],[-1,-2,-1]],u.prewittX=[[1,0,-1],[1,0,-1],[1,0,-1]],u.prewittY=[[1,1,1],[0,0,0],[-1,-1,-1]],this.filter=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","filter","Invalid number of function arguments.");var n=z(t);if(1!=n&&3!=n)return GlobalFunctions.set_error("Picture","filter","Invalid image data.");var r="",e=1,o=[];if(1<arguments.length&&("string"==typeof arguments[1].type&&(r=arguments[1].type),"number"==typeof arguments[1].loop&&(e=Math.max(0,Math.min(Math.round(arguments[1].loop),1024))),"object"==typeof arguments[1].kernel)){var i=arguments[1].kernel;1==GlobalFunctions.is_matrix(i)&&i.length==i[0].length&&3<=i.length&&i.length%2==1&&(o=i)}0==o.length&&(o=u.blur,""!=r&&"object"==typeof u[r]&&(o=u[r]));var a=t;if(1==n)for(var l=0;l<e;l++)a=s(a,o);if(3==n)for(l=0;l<e;l++)a=f(a,o);return a},this.vector=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","vector","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Picture","vector","Invalid function argument.");var n=[],r=Math.max(1,Math.round(Math.sqrt(t.length)));if(1<arguments.length){if("object"==typeof arguments[1].range){var e=arguments[1].range;1==GlobalFunctions.is_vector(e)&&2==e.length&&(n=[Math.min(e[0],e[1]),Math.max(e[0],e[1])])}"number"==typeof arguments[1].width&&(r=Math.max(1,Math.round(Math.abs(arguments[1].width))))}var o=Math.round(t.length/r);if(t.length!=r*o)return GlobalFunctions.set_error("Picture","vector","Improper vector length.");if(2!=n.length){n=[t[0],t[0]];for(var i=0;i<t.length;i++)n[0]=Math.min(n[0],t[i]),n[1]=Math.max(n[1],t[i])}if(n[0]>=n[1]){for(var a=[],l=0;l<o;l++){a.push([]);for(var z=0;z<r;z++)a[l].push(128)}return a}for(a=[],l=0;l<o;l++){a.push([]);for(z=0;z<r;z++){var u=Math.max(0,Math.min(Math.round((t[l*r+z]-n[0])/(n[1]-n[0])*255),255));a[l].push(u)}}return a},this.matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Picture","matrix","Invalid function argument.");var n=[];if(1<arguments.length&&"object"==typeof arguments[1].range){var r=arguments[1].range;1==GlobalFunctions.is_vector(r)&&2==r.length&&(n=[Math.min(r[0],r[1]),Math.max(r[0],r[1])])}if(2!=n.length){n=[t[0][0],t[0][0]];for(var e=0;e<t.length;e++)for(var o=0;o<t[e].length;o++)n[0]=Math.min(n[0],t[e][o]),n[1]=Math.max(n[1],t[e][o])}if(n[0]>=n[1]){var i=[];for(e=0;e<t.length;e++){i.push([]);for(o=0;o<t[e].length;o++)i[e].push(128)}return i}for(i=[],e=0;e<t.length;e++){i.push([]);for(o=0;o<t[e].length;o++){var a=Math.max(0,Math.min(Math.round((t[e][o]-n[0])/(n[1]-n[0])*255),255));i[e].push(a)}}return i},this.invert=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","invert","Invalid number of function arguments.");var n=z(t);if(1!=n&&3!=n)return GlobalFunctions.set_error("Picture","invert","Invalid image data.");var r=[];if(1==n)for(var e=0;e<t.length;e++){r.push([]);for(var o=0;o<t[e].length;o++){var i=Math.max(0,Math.min(Math.round(255-t[e][o]),255));r[e].push(i)}}if(3==n)for(e=0;e<t.length;e++){r.push([]);for(o=0;o<t[e].length;o++){var a=[];a.push(Math.max(0,Math.min(Math.round(255-t[e][o][0]),255))),a.push(Math.max(0,Math.min(Math.round(255-t[e][o][1]),255))),a.push(Math.max(0,Math.min(Math.round(255-t[e][o][2]),255))),r[e].push(a)}}return r},this.monochrome=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Picture","monochrome","Invalid number of function arguments.");var n=z(t);return 1!=n&&3!=n?GlobalFunctions.set_error("Picture","monochrome","Invalid image data."):a(t,n)},this.gradient=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Picture","gradient","Invalid number of function arguments.");var e=z(t);if(1!=e&&3!=e)return GlobalFunctions.set_error("Picture","gradient","Invalid image data.");if(1!=GlobalFunctions.is_vector(n)||n.length<2)return GlobalFunctions.set_error("Picture","gradient","Invalid function argument.");if(1!=GlobalFunctions.is_vector(r)||r.length!=n.length)return GlobalFunctions.set_error("Picture","gradient","Invalid function argument.");for(var o=1;o<n.length;o++)if(n[o-1]>=n[o])return GlobalFunctions.set_error("Picture","gradient","Range vector should be strictly increasing.");var i=t;return 3==e&&(i=a(t,3)),l(i,n,r)},this.colorize=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Picture","colorize","Invalid number of function arguments.");var e=z(t);if(1!=e&&3!=e)return GlobalFunctions.set_error("Picture","colorize","Invalid image data.");if(1!=GlobalFunctions.is_vector(n)||n.length<2)return GlobalFunctions.set_error("Picture","colorize","Invalid function argument.");if(1!=GlobalFunctions.is_matrix(r)||r.length!=n.length||3!=r[0].length)return GlobalFunctions.set_error("Picture","colorize","Invalid function argument.");for(var o=1;o<n.length;o++)if(n[o-1]>=n[o])return GlobalFunctions.set_error("Picture","colorize","Range vector should be strictly increasing.");var i=t;return 3==e&&(i=a(t,3)),function(t,n,r){for(var e=n.length,o=[],i=0;i<t.length;i++){o.push([]);for(var a=0;a<t[i].length;a++){for(var l=0;l<e-2&&t[i][a]>n[l+1];)l++;var z=Math.max(0,Math.min((t[i][a]-n[l])/(n[l+1]-n[l]),1)),u=[];u.push(Math.max(0,Math.min(Math.round(z*r[l+1][0]+(1-z)*r[l][0]),255))),u.push(Math.max(0,Math.min(Math.round(z*r[l+1][1]+(1-z)*r[l][1]),255))),u.push(Math.max(0,Math.min(Math.round(z*r[l+1][2]+(1-z)*r[l][2]),255))),o[i].push(u)}}return o}(i,n,r)},this.contrast=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Picture","contrast","Invalid number of function arguments.");var r=z(t);if(1!=r&&3!=r)return GlobalFunctions.set_error("Picture","contrast","Invalid image data.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Picture","contrast","Invalid function argument.");var e=Math.max(0,Math.min(n,127)),o=-Math.max(-127,Math.min(n,0));return 3==r?i(t,[e,255-e],[o,255-o]):l(t,[e,255-e],[o,255-o])},this.brightness=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Picture","brightness","Invalid number of function arguments.");var r=z(t);if(1!=r&&3!=r)return GlobalFunctions.set_error("Picture","brightness","Invalid image data.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Picture","brightness","Invalid function argument.");var e=Math.max(0,Math.min(n,127)),o=-Math.max(-127,Math.min(n,0));return 3==r?i(t,[0,255],[e,255-o]):l(t,[0,255],[e,255-o])};var n=["uMtTtqpTt6tTsqtUsqpVsMlVrqlXsMlWsapVt6tXur5VvbDUv7DTu75Vtr1UuN5UvN9SvNDUuN5Uu71UuN5UuN9Uv79TvNDUub9Utb1Vsr1Wrr1Xqat:oaxemr1hmN1inMxgo6tdoqpcp6papal:pqp.qqtZpqp.p6l:oalboMhboMhaoah:oqh:oqh.p6lZq6pZrqxZqqt.pqp:q6p.qMt:qMtar71bsN1asb5asN9bsN9cs79durPbv7TatNHdsbHes7Hdr79eqN9gqNHht7XiubhhvrlewbtdvblhvrphxO5hysTezstaztDaztL.ztDZzdTYzdp.zdx:zu1czdtfztpizu9mzuPlzv1fzv:gzwTjzxHjzxtmzyLrzy1y","vMxRuaxStqxStMtTt6pUsMpVratXrMpYrMpZrMtZrqtYs6tYs6tXsMtWsMpWsqtVtb1Ttb1Utb1Vtr5Uu75TuN5UurDUvNDUv7DSu75Tt6xVrqtXr6pZq6t:oqtboqxboaxcoqxcoMtenMxfnqteo6tdoMtboapaoMlbnqlbnahbnqdbo6d:oad:oah.pMh.qqtZqqtZq6p.pal:pMl:p6p:pqpaqatarr1:s75arb5brN1crN5dsbDaurP.w7XZv7X:t7LcqN9epb5fpN5gr7DgtrXeub:eu7:gubdiv7hiwrxfzOX.zt1VztTWztdYzttYztpZztt:ztxgztxkzu9lzuLhzv1fzv:gzvxfzwXfzgxgzxPizxtlzy5szxa0","vMxRuMxStaxUt6tXs6tYrapYrqtXrapYralYrapXrqlXralXralXrqpWralVralUrqpUsMlTsqtUt6tVtMxVtr1Uu71Uub9Uub9Ttr5Ut6xVsMxWrMtZq6t:p6tcoqxcoqtdnaxfn6xgnMtfnMten6pcn6ldnMlcn6hdmMhcmahcmqdbn6:bnad:nqd:oMh.pMlYpMh:oqh:oMd:oMhaoah:pMl:q6p:rMxarr5ar71ar71as75atND:wb:WxblUwrhXuNP:rN9cq71dpr1eqN5erNHcsrPeuN:ev7hfw7leyO5.zcTVzcdUzcxSzdPUzd:XztPZzth:zu5dzuTczutbzvHczvlezwdgzxDfzxTgzxTizxXnzhpqzxhyzgq7","vqxPv6xPuaxRtatTt6tVsapUsapUsMlVs6lVrqlWsMhVs6lUs6lVrqlTrMlVrahVrMlUralUrapVs6pVsapWsqtUtN1Su79Su79Utb5Utr5VtN5Wr71:pMxdoMxenMtfnqtenaxfnMxenqpen6tem6telqpem6ldm6dclqdblqdblqdbmM:bn6:anad:na::nad.nqd.o6d.o6d.o6::o6::oal.pqp.qMtZqMt.q6tZrMx.t79auNH:u7L.vNXYyO5PwNhUrr9aqb5cqb1dr7DesNLdtbPdvNdcxbx.z8DVzcTSzcTSzslSzt9Tzt5SzdHVztdYzu1XzuTWzuxXzvT:zw1dzwpezxlezyXfzy:kzy5pzxPwzwu4zwQFzvmQ","vatOv6tOuqtOuMtOu6tQtapQtMlQt6hSsahSs6hSs6dTs6dTs6hTrahRrMhUqqhVqqhVqahWqqlWr6lWrMlUs6lUsapUsqxUsaxVsaxVt6xWtN5Wt75Yrr1Zqqx:pat:pat.q6t:qMt:qMt.p6p:o6pbn6lamqlamqdamMdalqdblahclahcmadbnMdanMd:n6:.n6:.n6:.nM:.nad.nMd:nqh:pal:rMx.rb5.rb1Zrb1.t79:trHau7P:tNLasNHZqr5:q6xar71bs79bt7HcuNTavrh.xNtZzOHRzs:OzslPztDRztTTztPTztLTzdhUze1VzuLUzuXUzvDWzg5azwpczxTczyDezydiziXozxDxzvqAzvQJzvAVzv6h","vqtNvatOuqtOuapOu6pPtqpOtalOtMlPsqhQsMhQsMhRs6dRrqdRrqdSrMdTqadTqadUq6dVpahUpqdUqMhUqqhVqqhVqahVqqlWqahWr6lWs6tVt71VtN5UtN1Vsb1VratWrMtYrMtZqatYq6pZp6p.nqpbmqpcmaldmMlbm6hclahelahdlqdclqdbm6dblq:alad:la::m6:.mM::mMd:n6h:oql:q6p.s79ZuNLYubLZu7LZsrD.sbD:rN5:q71:qN1arb5:sbDatbLavNT.xNlVz8LQzcdPzspNzsxOztPQzdpSzdhTzthTzttTzu5SzeDSzuHVzuPVzvDWzft:zw9czwlezxXhzhdlzh5szgE3zvMEzvAMzf2Tzf2Y","vqxNvMxNv6xOuatPu6pQtqpPtalPtMlPsqhQsMhQs6hQrqdQra:RrMdQrMdRr6:Tqa:Tq6:TpMdUpMhUpahUq6dVq6dVpadVq6dVpqdVpa:VpadVq6lVqMlVq6pVq6hWpqlVpqlXpalYp6pYpMpZpat.o6tcmatdmqpenMtbnalbn6hcmqdbmqdamqdamqdalqdakqdaka:akqXal6::la::mad.p6p.r6tZs71Wu7DWu7DXsr9Yrb1ZqqtZpap.q6tZrr9ZtrHZv7PZvNXYxNhWzO9PzchLzctNzsxNztDPzdHOzdhRzd:Rzd:SztlSztXTztlVzu5WzuPVzupXzuhZzvD:zfxezwDgzwDkzwLqzwHwzvU7zv2Kzv2LzvAR","vqxMvaxMv6xNuatPu6tOu6pPtapOtMlNt6hPsMhQs6hQs6dRra:SqqdTqa:TqM:TqMdTqM:UpadUpM:UpadUpadUpadUpadUpq:Upa:UpM:Tp6:Up6:Voa:Wnq:Wnq:Wna:YnqdZnqd.nqh.o6l:oMl:oMlbnqpbnqpbo6laoah:p6l:p6l.p6pZoql.nad.m6::lM:al6X:kq::lMX:m6:.n6dYpMpXrMxXsN1Vs71VraxWqqxXq6tZqMt.pMt.q6xZsN9YuNHWw7XXwrdVxNhVz7xRzcDLzcXLzslMztHPztPPztXRzt:RztlTztpUzthVztpWztpWze1WzuHXzuLZzvD.zfPbzfDdzvLizvTnzvXrzvLtzv1wzuu3zuuD","vMtNv6tNuatOu6tPu6tOtqpOtMlPt6lOsqlQsMlRs6hQrqhQradTqqdUqadTqMdUq6dUq6:Vq6:Upa:Tpa:Tq6dTq6dUpM:TpMdTpM:TpM:Tp6:Toa:ToM:Uo6XVnaXWn6XXmqXYn6:Ynad.o6d.o6lZoal.oqp:o6l:oql.palYqMpYr6pXqqtXpMlYo6dYma:Zm6::mM:.maX.mM:.n6:Zn6d.mq:ZnM:Zna:ZnMdYmadYmqdZnMh.nql:nMlanqp:pqt:rN5.rb9Ys79YubPYwrhVy7xRycDQz8LPzcdNzchPzcpRzt1SztDSztTTztdVztpXzd:XzdLXztP.ztl:zuX:zuLdztxgzu5kzuLpzuXszuXtzudtzu:tzuPy","uatPu6tOu6pOtqpPtapPtMlOtMlRt6lQsqhRs6hQs6hQrqhRradSr6dTqadUqa:Upq:UqaxWtr:Xs75TqqhUqqhVqahUq6dUpMdUp6dUp6:UpM:Uoa:UoMXVnqTWn6XVn6TWn6XWnMXWnaXYo6XYo6dXo6dYoahYpMlYpqlXqapWrMpXsMtWrMpXpqlXoqhWnqdXma:Zm6XZlq:ZlMX.lMX.l6X.lMXZlMXZl6XZkqX.lM:.lqd:m6d.mah:malamalamapcn6pbnqtbp6xaqb1:sND.uNPZwNhXyc1TyO1UyO5Vz8DWzc:RzslQzt9Szt:UztTUztLVzt9Wzsx.zd9bztPcztTezt:gztpkztxrzu1xztxwzuDszudkzulk","tqpPtqpPtapQtMpQt6pPt6pPt6lQsahQsMhRrqhQrqhRrqdRrMdTqqdTqadUpa:Umad.ucXjzAD:y9xZvsXXu7XUsr9SrapTq6hUpadVpMdUqMhVpadUoa:VnMXWmqXXmqXXmqTWn6XWn6XWnMXXn6XXm6TXmaXYnM:Yo6dWp6hVpMhXpMlWoMdXn6:Yla:Zka:.kMX.k6X.k6X.jqX:k6T:jqT:k6X.kMXZk6X.k6::k6::kM:bkadakqhal6lclMpdlMtflqxgmaxgo6xepN5eqb9ds7HbtrXawNl.wbp:xNx:yO5:zOHZzsPVzs:Szt5Rzt5Tzt9Szd1Uzt1Wzt9ZztL:ztTbzddfztllzttyzuA0zuLrze:kzv1dzvPe","sapQsalQsqlRsMlRsMlQsMhRs6hRs6hSrqhSrahSrMdSrMdTrMdSqadTnqTSh5xRmbDkssDryOHLychFythOz9:Xy8xWwbdMu7DSs6tUrMpUrMlVr6lVpqhVo6:Wn6XXmqXXmaXXmMXXm6XXm6TXlaTXl6TXl6XXlaXXlqTXlaXYl6XYkqXYkaXYkaXZk6X.j6::iq::ia::iq:aj6X:jMX:j6X:jMX.ja:.ja:.ja::jMdajadbjqhbkahckqldl6pelatflr1hlN9ilr9inN9hpNDgrrPeu7:ev7hewNtbxc1:ycD:zOHZzcPVzsXUzshRzstSzsxTzt9UztHVztLXztX:zthczdXjztduzty8zuI6zuY8zuTvzu:izudj","rMhTrMhTrMhUr6hTqqhSr6hTqqhSqqhTqqhUr6dUqqdUqadVqa:SnqLQa4l9b4l9rN:irbtqwsXYysLEyN4xys9KysdVycTNyt5VxcTXvbPRu71SsqxTrqpVpqhVnq:Wn6XVnMXXmaXYmMXXlqTXlMTYkqTYkqXYlMXYl6XZkMXZkMXZk6TYjMX.j6X.jMX:jMX:j6X.j6X:j6X:j6X:jMT:jMX:j6X.iq::iq:.j6::jMdajadbjadbk6hckMhdkqpel6tflqxglr5hlr9in79horDirNLfu7:evrtdxc5bysD:zOH:zcPXzcXTzsdQzspQzt1Rzt1UztDTztHVztLYztP:ztPcztHkzPI0ydQ9z9iCzu26zu5rzu9mzuDm","q6dVq6dVq6hWpqhVpahVpqhVpqhVpqdUq6dUq6dUpadUpa:Up6:Te:PFSnOtk61AusH.oax:qbHRycdMyNd4yN:Ay7xKyt9ZzQlfxsxWxrtMw7HPuN5Rt6xTrMpUpMdUoM:WoM:WnqXXnM:Xma:Xm6XYl6XZlMXYlMXYkqXXkaTZk6TZjqTZjaTZjaTYjaTZj6T.j6TZjMTZjMX.j6::jMX:iq::iaXaia::iq:aiqXaiq:ajM:ajMdbjMldjqpek6tfkqxflaxglb1hlr5hmr9hp7DgrrLdv7:awNpbxNxbysDZzcPTzsdQzspQzt1Qzt1QztHRztPUztPVztPVztTWztTZztDbzt1myt1yxt62zPHvzdLqz9LszPHrzdHo","nqXWo6XWoM:XoMdWoadVoadXoqdXoqdXoqdWp6:Woa:Voa:Vka9QVJoxQn4ofp8ywO5NqNTamadVtrDGx8dHychLyOpZyOhizQ5hyQLaw7LBwbLLur9Rtb1SsatTrMpVq6lVpMhVoq:WoMdVnq:Vna:Xma:Ym6XYlaXXl6XXl6TYkMTYkMTYk6TYjqTZjaTZjaT.j6XZj6X.iqXZjM:.jM::iq:aiq:aiM:aiMdbiM:biadaj6dbjqhcjqldkMpekapfl6tflMxglb5gmN5hnb9fpr9dsNLbuNT:wbhZyc1WzcDUzsXOzslNzt9RzdPSzt:TzthTzt:TztXVztXUztLVztHXztD:zd9iz8xszOxrz8xpxcpuwchvxOdsyslo","kqTWlMTWlaTXmMXXmqXXn6XYnMXYnM:Xna:Xnq:Ymq:WlqPVbL9FW4P9RnWvXJOprqpKwc1bqN9XrMDAr5ozxP5OzPphz9Hmyt9kyu1dyPlQyOlPwbpSv79Ttr1TsaxUrMtVqMlVpqlVpMhVp6hWo6dXnM:YmaXYlqXXlMTXl6TXkaTXkaXWkMTXk6TYkMTZk6TZjqXZjaXZjaXYjaTZjMX.jMX.jMX:j6::j6:aiq:aiqdbjahbjqlck6pdkqldlMpel6xelqxfmb1gnN5for5dqb9bsbHauNT.wNhYz85RzsPNzs:NzstOztDRzt:TztpUztlUztlVzt:WztPUzt9Xzsx.z8pexshnwOTsw8PsvsPrvcPtwcTqyOdjzcpc","j6LXjaLXjqLWk6PWkMPXkaPWkaTWkaTWl6TXkaLWd:PL:pDMXKdDUK54Pn0lUncwrbdbz8tgy8XdrahFtM:7xOdNydLlvsXvwcdhy9Tbyth.zADcyu5:xODSurDStN1TsaxUrqtUrMpWqqpXpalWoMhXnqdYn6:Ym6:Yla:YlaXYl6XYl6XXkqXXkaXYkqTZkaXZkMX.kMXZk6TYk6TYjqTZjqX.jqT.jaX.ja:.jq:.k6::kMd:kqdakahal6lblqpcmatcnMxcoN5cpN5cr7DasNHatrP.vN:ZwrlWz89QzsPLzshLzstOzt5PztPQzt:RzthTztXTzt9VzstYzspXzchYys:cxsPiwODmvs9nwOHnxcPkys:ezctYzt9V","haHWi6HXiaLXiqPXj6LWj6PXj6PXiaPXhqHVapDGVK57:5TSYKxHSZgyQ34nZ4dEoN9Xyd5bystgystbyt9:zPhbwcltssTzmbDfq7XgusLgxd1ezR1ezQTZxs5Rub9St71Tsb1Vs6tXrMtYpqlXp6lWoahYnqdYnMdYmqdZmadYmM:Ymq:Zma:Yla:Yl6:Zl6:ZkaXZkaXYkqXYkqTYkqTYkMXYkMX.kM:.ka::kadakqd:l6dalMd.lahZm6h.mql:napaoatapN1:qr5:s7D:tbPZvNXXwrhXxbtVys1SzcHNzsdLzslMzslNzsxOzt1Pzt1RzstTzslTzc:YzchWzclUzcXYycLdyOHcycLaz8X.zchXzsxUztDUzt:W","gqDVhaHWi6HXi6HWi6HVi6LWgaDUapPJYolET3l0YKpJ:5:S:p:SXKlFRnOuY4:BfKp4xblHz91Xx8LXt7LTyOt:y8xhv8dur8HypbttqN:oqrP:xPD.z9XTz81ExrXNvbHUu75WsMxXr6tYqqpXqMpXpapXpapXpqpYpMlYp6lXp6lXpMlYoahWnqhWn6dYmqdYm6:Yla:YlqXYlqXYmMXYm6:Zm6:Zm6d.mMd.mah:mah:mMh:mMh.mqhZn6h.nah.nal.oMp.pMxZr71Zs7DZuNTYwbdWx7pWxrtVys5SzsLNzsdMzshMzsdNzshNzshPzs:SzOPYz8H.yOHaycHazcTYzshTzc:VzchTzstRzt1QztHSztTUzt:VztpX","h6DUhaDVh6DWgqDVh6DUfq1SZ4pCR3OuTJt4X4hGc65bba1ZZ59KS3.wSZWvT3Otfogyw6h5xr:IxsHMm5pAn6HKpN9St81ircLyp7xtnNXml6pcprDewc9cy8DPz7pEybhPwbPVu79Wsb1Yrr1YraxYrMxWrr1WsN1Wsb1Wsb5Xsr5Xsr5Ws6xWr6xXqMtWpqpXpqpXpMlYpMlXp6lWoqhXoalYoqlYp6pWpMtXpqtXpqtYpqtZq6tZpqtYpqtXpatXpqxXqb1XrN5YsrDYurPWwNdUwrhUxNpUxrtUzODPzsXMzslNzshMzshNzchMzshNzsXQzOPUysDYysHZzcTUzshSzspRzt5RztPQzt:Szt:SztdTzthVzt:UztTU","h6DVh6DVgqDWgMDWfa9V.:5HRZ.wRZ:0X4lJb5x.a5pVSnt0Pn8oQnGrRnGsSJGsdoKwqpSwtqDBw6xFoMHKla:Zi6HViqTZmrLik71dfMDXfa5Vk6hblMxdmMdSv7dSyNhJyNdQw7PWurHWubHWuNDWuNDVurHVvNLTw7PSwbXRx7XRx7XPwrXPwbXPvrPQvNLSvNHTurHTuNHTu7HStrDStrDUu7DUuNHSuNDTu7DUtbDUtrDUuNDVtrDUu7LUtbLUtNHUu7PVu7PWubPXvb:XwNhWvrlXvNhZwbpYz8DRzsXMzsdLzs:Lzs:MzsdLzs:Mzs:NzsXNzsPPzsPQzslPzt1Pzt1QztDQzt:QztdSzt:RztXSztTTztPTztPT","hMDVgaDVgMDVgM9VbLXNXKlFZLHPZ5DP.LXT.:TRVoT9Rn.wQ3GqQZ8pT3.xV.93..Czj4.vlosunpL0s6:KqbDboNHgjqXWg69TeptRe5tTi6dakMtfi6:ah6DXn75gqMlOxcLNybpPy7dRxrdRxb:QxbdQxrhPyblNzNpKzc1Izs9GzsHGzsHFzc9Gzc5Hzc1HzNxJz7xJyrtJybpJyNpKyNpLy7lMxrdMx7:OwbXQw7XPw7XPwr:QwbXQvrXRv7TTubTUuNTWtNLZs7H:r7LaqbHdr7Pcs7XdvNlby85XzOLRz8LQycHQyO9SysHPzOPNzcXMzsPMzsTMzs:LzslMzd1Ozt1OztDQztHPztHQztHQztDRztHSztPSzt:T","ga9Xg6DXe61Uc5hSX4hDTo53X4hFWolFSZx0RJSuT3gySnkyPZ0kPIojS3GqTncu.48ykox1l4syj.p0h.l1l6DSob9fpNPhkMpahMT.hMTZdppRk6pgkb1hjMpckaxeh65UnqPNwbPLzc1Kzc1Jzc1Izs5Gzs9GzsDFzsHGzsPGzsXGzsdHzshHzsdHzsXFzsPEzsPEzsTDzsPEzsXEzshGzshGzshGzsXFzcXHzcXHzcXHzcPHzOHIz8DIyNxMx7lRwbdUv7XWtNP:rrLaqrHcpbHepNHdprLerNPesNTctrXbt7TasbPbsbPbtrX:vbdXxrxSzOHOzsTLzspLzt5MztDMztDOztPPztXPztTPztLPztPQztXSztdRzttS","dpxV:LPMT3x3S.15PZGqP34lOIwkP38oNYojOZ0nOYwkOIojP2wmOYsjNYggRZGoY3csdKCxgoWzk4x2g.t4bKh8k69Snb1fnb5gnbHim7Dhi6daj6tdlbPjkr9hkN1gkb1flb5gp6pZx7lTzNtHzsDGzsHGzsPFzsTEzsTFzs:HzsdHzs:Gzs:HzshHzshIzs:HzsPFzsPEzsLDzsPEzsPGzsTGzcXGzsXFzshGzspGzspIzslHzslHzshGzcXHzODJzO5MyNxRxrtUwrlXub:.tNTarrPbrbPbrNPcqrHdqb9cq79aqN9aqb9arbH:srL.ubXYx7lWxrxSysHPzc:LzspLzt1MztDNztTNztdOztpPzu5NzuDOzuLNzuPO","S.12NZ0qRJx3P3OsM2cfM2.fMIcfMmgfLmOeLmSdM2SeMIceNmohNmkhOIsjV.51ZnswaZorhKWwbo8tc.Ozd:DEg5LHma:Zmalbs7Lcnb1bmbHgjb1bl7HilbHkl7DjjMpcjMpckaxeprHevrPQxrlMysHLzcdHzshIzslIzspKzstJzspIzslJzspIzshIzs:HzsPHzsLGzs9Gzc5HzbtJyNlNxbhPxrlNybxLysDJyODLyO9Ly85Lxc1LwrtOvrhTvb:UurXVubXXtrXYsbP.sNP:qrHaq7Dapr9:pN9apb5:pb5.qrD:rrL:t7P:ub:ZwbpVy81Tyc5QzOLMzsXKzshKzstKztDLztXMztpPzu9MzuTJzu:JzudKzudL","IICcMYolOZGpLY.dLYWeL2SfKmOcLISeM2chMYcgLmSeMYcfO2wjP38pUoPB:L:TVKD3TnGnTmwfPY.dUJ8leL1BhL:Kh:hLi5xOo6POk6PVmqtakatcjb1ekrDhkrDghMXYhMPZkMxfkqtdk5tMubPUvb:Usr5Gys5Jzc:Izt5MztPMztLMzt9MzslKzsTLzsHMz89OyNxQy7tQy7pQxblRwN:VvbXWv7TWuNPXtNLYsbDZrr9ZrN9ZrND:rNLdr7H:pr9apN5bpN5aor9aoN5bnr1bnN1bnb1bnr1bo75cor5bpb5aqbD:rrLatNT.tbX.uN:Zv7dZvrlWxrxTzcHPzs:LzsxLztHMztdOzu1OzuHLzuXJzupJzf5MzvHO","Glw.J2CbKISdJ2CaJYGaLIOdLmWfMIgiMmkiMYgfMIggO30mQJSuUKPAX51LSK55MIchKYGbJY8.KI8:Rm.eX3Cm:KD0aKd5.KL4d.xDnM:Wnqp.lMt:i6hagaPXfMDTbp:Kb:DJiMX.iqd:doxBk5X7sMTDlplEqMlLxsHOzstMzt1MzslMzs:LzsLLzcDPyNxUwbhYv7dZubXZubXZubX:ubX:vN:ZwblWwblVwbpXw7hYtbPZoMlVoqxbs81rs7llsN:drrPcprDcp79cor5boN5aoN5aob5ap75apb9bq79bqN9aqrD:rND:s7H:srP:tbX.v7dYwNpWyc5QzsPKzstJztHMztdOzu1NzuHLzuLKzu:LzutLzv9NzfDO","H20:J2KaI2C:Im4.Jm4ZKIKaJmOaLmWePJCqOZ8pPn.vRZt1V4XCX:5KV4dELYghIHw.HXw.Hm0ZJI4ZTIceVmsgSmkgVZWr:.X8h5dNoaXTnqpYh6DSe:tPfM9U:p9EXoL5bLHKgMDVi6XZb51DZZwxi::FjMPVjq:apNLevs1XysPOzsTLzsLMzsDOzc5SyNtXxNpZwblYwNlYwNlYw7l:wbp:y81VzOLPzcTOzcPNx7xSmaPOb.l8gphNq7lpm7Dgj6HTqbTgrbTfqNHdpb9bp79bpN5aq75ar7D:sNL:u7X.uNXZuNXZuNXZu7TYuNXYubXYvNdWxNpTz81OzcLKzspJztTNztpOzuDMzuhKzuxLzutKzuhKzuTKzuDN","F1oXFHwWDlkUGlkVJlsXHXsWGHoWIXsWLI8aOIokS3ozSoD5S455S413S.13MIsiII4:Hm0:Hm0ZKYC.S2ceSYceMmSbNISbUJCo:KP6h5hLhq1Pfa1PaLDFb:LKdLlPZKdC:51H:p1F:KtBWZwyU3OqXoD2dLlQgaDXl71fmbHjsbTYx7xLysPRzOPNzcPRzOHTzODWzODWzOHUzOLTzOPUzOXTzchSzstTzstTvs1NmMPPiLxRiptQcKtBiqHWlMxdb59Hb:9GhM5Sob5brrTdqbHbqbDar7HasNTbtrXaub:.uNX.tNTasbL.sNLZsNLZsNHZsrPXurXVwNhTx7tQy8DMz8hLzP9KzdTJze1KzuLLzu9KzttJztxKzthN","ClgSClkTD1gTFHgTI1kTGlkTI1oWH1oVI1sWJXsWKm0YLY8:Im4ZIY0ZM2SdMmkhLYcgIm8:HY0ZK24.S2cfTYkfNYWcLYKaPISdS2ojZnsxaol9cpTHbpPHapHHaLDJ:L9IVK0zRn4nS34lSZCnU3WtW3wzW412XKD4d::Pl6tcoax:naTUrbD.qb5RpapLpalLpM:Jrr5LqaxJs7HMvs9RxO:UxOhXwsh.vOL:g:dB:.T7jaDUl6LV.4H3:odAg5pP.Kd9YKL6:4lCb:1Fnq:TsrX:rNPdrrPds7TdsNTdrrPbrbLbr7HaqbHaqbD:qN9.pr9.pr5.pr5.pb9.qN9.rbDYsbLXu7XVwNlSxc9Oy8LNyOTNyOTNy8LOy8HQ","AXWPAlWQCHcSD1cREXgRF1gSH1kUK1oVHXoWFXoUJlwWLY0YHlsVIlsXHlsVKm0XL2C:HI0ZGXwYGHsXKY8.NmK:MmG.MIGZLIC:OmScPYWcT30jV3gtX40y..pA.KxCZ4d7WK91RJ8nSJGpUncw.KtFbLXPbLXObLPOf5xXiqHWjppJc4tDhLLEl:xNgpdLg:dLg5TIa.h9b4hCd:DFa4:2cKt5e5HAa.h4:oh7.4X8a.lBh:tPg5XKZKL5Y453ZoL6..:9::5Gc5PLaKxGb4:8m65Mtb:cv7lbvNl.vNl.v7h.tr:.t7TarrL:qrH:q79.pb1.p71.oN5:o75:oN5:ob5.or5.pN5.qNDZr7H.r7H.r7H.s7LZsbP:srTa","A1WOAXWPCl.QBXWPDXgQCXcQEXcQLHsVKXoVFlgSH1kTGHkTE1kUDHkUDlkUHXoUElgTCXcSBlcSC1gSD1gSHlwWI1sWK1wXJY4YJm0ZK20ZJXwYLI8ZRmgfVJOqTnguSZOoUnswU3ovRJCnT3Ora5LMdpxVeq5Xea5XdLpUap1HaJsv:K10.J.sdoCzeKpAepPJgplN:Kd8ZoT7:KX7X.10Wo12.olDX.D4YKP7ZKP7dLLJhM1S:4T7TZGqTJGqTnKrX.12b5HJea5UbpTM..:Aa.T5oqlRy89SzcTQzOTPz8HPy85SwbpVv7dYtrX.sbPZrNHZqN9.pb5.pN5.pN5.pb5.pr9.q79.qND.qNH.qrH:r7HbrNLbrbPcs7Td","AHWOA1SNAXWOAXWOD1.QEXgRDHcQDXcQE1gQEXcRDlcQDlcSD1cSEHkUElkTEloTEXgSClcRC1cRB1.QB1WQAXWOB1SOCl.RCX.RCHWQCXWQCHSPElcRH1kTH1kTGlsWII0WMmSaQnCnT3oxRJCnXoX9a:TOapTOb:dRa5POZ4dCV3KpXnoyWZgwYnOq:Zkudot9iqDT:olATZOsT3CqSZ8qX452Y4D4UJ.uVJkyX.92fLhOfLdNWnozY453VngwU3StYK52ap1FfMDVhq:.h65U:K:9e:DDt7PLzcxRzt5RzsxQzslOzcdOzO:OysPOxc1Tv7hYsrT:rrParbLbrrLas7L.sNP.srT.t7X:tN::tbdauNhaurpavNtbvbxc","8lOM91OM9HOM9lSNAXSNDHcPClcPClcQDHcRClcQCX.QAHSOB1WOD1WPG1gRH1kSEH.QCX.PBHSOB1SOBHWN9XKMAHONC1.QB1WOBHWPBXSPAXSN9XKM9XKM9HKMA1OMClWPHXgSL2C.Pn8lR3KoRnKqWKT8Uo93YotGW.TAP2ojO2chWKL7W.P7UZCoVJGpWJKpc4pAb51CVZoyV3gxT3KrRJ0nS3CpSZGqTnWtXK11e5:Nb:5F:.lC:4hBWZt0X.52:K:9XK11d5hOj6lbja::bp5GXJgyep55u81MzPDUztHUzt5Szt9Rzt5QzshPzOPVxc5:w7xavrxbvrtawNt:wNx.wNxawO1bwc1dwc5dwsDcxsLZysTWzO:VzOhW","9lSN91OM91KLA1SNBX.PDHcQDlcRD1.RCl.PDHgQC1cQAXSO9XOM9HKL9lOMAXONAXSN9HKL8lGLA1ONA1ON9lON9XKMAXONBHSOCl.QBHSOAHOM9XKM9XKMA1ONBXSOD1cPG1cRFlcQIm0XNIggM2OcQJCoTZkzVKD6Pn8pM2ScNYghPJ8nOIsiP2skPZ0mPYslO2chNIcgO2chUZgxVJozSJCqS38oSJCoSJGpYoP6hqDWiMDVfptScLHKY.H6b51F.4P7UncwX.93gqPXiqd::.tDVZcyXZx0d4x4ts9JzdTTztLSztPSztPTzt1TzslVzOX.ysPZyOH:yOD.ysHZysHYycH.yOH:ycH.ycPZysXXzO:WzsdTzslTzsxT","B1WO9XONAXSNAXSNCH.PClcPCH.PBl.QC1.QBl.PB1WOBHWPAXSOA1SN9lON9XKM9lOM9HKL9HKM9lKM9XOM9XKMAHONB1SNAlOOBXSPBHOOAXKN9XGM9XCLAXKNClWPD1.PDl.PFl.PGHWPGlcQHHkTNI.fRJSuOYwlK2CaJm8:KIGbJI8.JmCaKYCaN2cgN2cgL2GdKICcKYGdOm.iVnozVJszRn8oRZ4nQmwmY.L5haDVhM5Ue:dOd5XLY4D4c:DJY.95XK53V3gxYoP6eLtQ.opCV3cxUJWvX.13d:0yr7XFvOPOyP5SztLTzt1RzshRzsdTzc:Uz8LXyODZz8HYysHXx81:v7pbw7t:wrxZx85ZyODZyOHZycLZycP.","AHSN9lOL9lOM9XKMBlWPC1.ODHcQClcQC1cQBHWPB1SPAlWPAXWOA1SN91KL91KL9XKM9XKMB1SOBHSO91GK9lKLAHONA1KMA1KMAlOOAHOM9lGL8lCJ9XKL9HKMAlSNCX.PEHWPGlcPJHcRK1gQIHcQG1cREXcSFXkUFlkVF1kUG1kVFloVFXkWGHoWK28aLYSdJYCaJ28aJm8cL2GcQn4mV3szTncvRnCqR34oVnozbpHI..lAWnx2X493VZozbpHIaoxFVZgyVJozUnkxWK11XKL6TJOsS38oTJKrTJ4oVnWs..8yjq1Dv85OyclPzslOzsdOzsXOzcLSzcHUzcHUz8HUwNt.v7l:xs5Xxc1XxO1:x85axcD:yOH.ycPZ","AlSNAlSNB1WPBHWOC1WPBXWOCH.QCXgQCXcQBl.PAlSOAHSNAHOM9XKL8lKKA1OMAHOM9HGL9lKLAHKM9XKL9lKLA1KM9XKL91CJ9lKL9HGK8lCK9HGLAXOM9HGLA1KLAXONB1SMCHSLFXWOJ1cQK1gRJlgSFl.QCHWPC1SPC1WQDl.SGHkUH1oVIHsWJXsXK24.HI0YGXsXGXsXK28:LYOdO2giRZGpPmsmPIolQZ0nSnOtP2ojLYKeNISfQYwmUJcwWZx0SZCqX4D4WoD3T3OsRnCpPYkiQmskQmslRmwlSnGpTnOrY3wxgLPDmqPGvNdLxs1Oy85RwbtWx7tWyc9Wy89Yx85aws1.xO1Wyc9VycDWysDVzcXRzspRzsxS","CHcPCH.QBHWPBlWOBXWOBXWPBX.OBX.OBlWPBXSPB1SOAHSM9XOM9lKMA1OMA1OMA1KLAHOM9XKLA1OMA1OMAXONAlOOA1KL9HGK9XGL91GK8XCJ9HKLAlON9lKL9lKL9XGKA1KLAlOMBlONF1WPFH.PFlcPHHcRFXgQDXcPBlWOC1WPCXSPE1.QH1gSIlkUFXgUDXgTDlcTD1cTH1sWII0.JICbKmKcJI8aJI8aKYCbP2gjK2GbHXw.JmCaMIKcP2skVo11RJ4nQYsmRZ8oQn0mPmsjNm.fPmgiPmokQmwkRJ0mS34nSn8nUnOrVnWt.K4xep57kqDMl6TSnadSw7pXwc5awO9exODbx81Zxs1XxO1Zws5aycX:z8tayOti","CHcPBl.OB1SOBHWOBH.OBX.OB1.OB1WOB1WOBHSNAlONAHSNAlSOAXSOA1OMA1OMAXONA1OMAHONAHONAHONAXONAlOMAlOMAXOM9HKL8lCJ8X8J8XCK91GK9HGK91CJ8HCI8XCJ9lGKAHKMBXOMClWNB1OMB1SMBlWOCXWQCX.PAXSO9lKMAXONAlONBlOOC1SPCl.QDlcRCHWRDlcSElgTFXkVF1kWFloYFXsYFHoXGHsYG1oYGHsZI24:KIKdK2GcM2SeNm.gOYghPYojOmkiP2ojOIgiOYchOYchOmghQ2skQZ0mQIskR30lR2wlPmgjRYwnTZKrVJgvY.D2hpdEmMDHsNDOwbtTxs5Wws1.vNtevc1fwODgvcHjts5m","AlWOBHWOAXSNAlSOAlSNA1OM9XOMA1ONAHSNAHSN9XKL9XKLAHOMAXONAXONAlSOAXONAHOMAXSNB1SNAXSMAHONA1KLA1OL8XCK7l4H8HCI8X8J7l8I7l8I7l8I818I7l8I710G7X4H9XGK9lKL9lGKAlKMAlOMAHOMAXONAHSNA1ON9XKMA1SNA1ON9HKL91GLAHKMBXSNAXSNB1SOAHOMB1OOAXSOCX.REHgUD1cUDHgVE1kXF1oYGY0.IYCaJIGcIY8bKICaNI.fQZ4nPYwlOIghP2skPIokNI.fNY.gN2WfNIchOIgjOYchOYchNYWfP2gjQ2wlQZ4oR34pRn8pS38oVnWqc4kynaTGvblYurlbvrtavrtau7hamadV","9lOLAXSMAXSM9lOM9lOM9XKL9lOMA1OM9XKL9HKL91KK9HKLAHOMAHOMA1OM9XKL9lKMA1KLA1OMAHOM91GK8XCK8lGK8XCJ7X8H7l8I7X4H7H4H710H6l4I714I7H4H6l0G6X0F710H8HCJ91GK8H8J9HCJAlOLBHSMA1KL9lOMAHONAHSN9lOMA1OMA1OMA1OMA1ON9XKL8lGK9lOM9HKL8XCL7l8K91GKA1KM9XGM8lGM9lKNC1WRDXgVEloWHY0ZH20:H1wZM2KcPYwlQ34nMmWfMIWeN2cgMIOeM2SeMIWfLmSeM2SfMIOfLYKdL2KcLYOdMI.fNYciO2cjP2olPmwnPYwmPYslTJOqi5hEtNLUwNlVurdWl6HQa.xB","9HKK9XKL9lOL9HKK8lGJ8HCJ8HCJ8HGJ8XCJ8XGJ8lGK8XGK9HKL9HGL8HCK7X8I7X8I7H0G7H4H7X8I7H8J7X8J8HCJ8HCI8lCJ818J714G6X0F6H0G6H0H6H0H6X0G6X0G60wG6X0H714H7H4H7l8I8H8J91CJB1OLAHOM9XKL9XOMAXOMA1OM9lKLA1OMA1OMA1OM9XKL8XCK81CK81CK7lCK7H4J7l8JAHWN9HKN7X8K7l8J9lKMBHWOAlONBlWPDXcSE1gUIHsWKIC:OIoiMm.fL2OcLY.eLIOdLYSdLIOeJmGdKIGeLYOeJmCbJYCbJYCbJmCcK2CcK2CdKYGeMmWgNmkiO2ojNmojSJOrhptMp6tXk6LSW.4zIY8X","7l8I7H8H714H6l4G6l4G714H7X8I7H4H7H4H8HCJ8HCJ714H6l0H6X0H6H0H6H0H6H0F6X0G6X0H6H4H6X4I714I7H4H7H4H6l0H5kwF6X0G6l0H6X0H60wG60wF6X0G6X4G6X0H6l0H6l4G6l4G7l8I8lGJ8lGK8XCI9XGK9lKLA1OM9XGL9XKL9HKL9HKL9HGL8lCK7l8I7H8J6l4J7H8J718J7H8K7l8KAlWP9XKN7X8I8HCKAXOMB1SNDXcPCHWP91GLAHOMD1.PF1gSGloUHHwWHXwXIY4ZIm4.JYC:JI8cI24cIY8cKIKdHm4bII4bIY8bIY4dJ28dIY4bIm8cJYCbK2GcIm8:JmGbMY.hV40zYoX4NIkfClSMAlKJ","81CI7l8I714I6l4H7H8H7H4H7H8H7H8I710H714H6l4H6H0G6X0H6X0H6H0G6X0G6X0G6X0G6GwG5ksF60wG5ksF60wF60wG5ksF5ksF60sF6H0G6X0G6X4G6H0F6X4F6X0F6H0G60wF6H0F6H4G714H7l8I8lCJ8H8I7l8I8H8IAHKLAHOM9lOL8lGK81CJ7lCJ8HGK81CJ7H8I6l4I714J7X8K7X8K7lCKAlWOBl.Q9lOL9lOMAXONBXSOEHgQEHkRAHON9HKLB1SOBXWQCX.QCl.QBXWOCX.PCX.PDHcQFHkVG1sZGI0aH24aFlwaGHwaHI4cH20aHI4bGHw.FHsYEHkWEHkVDXgTE1gTGlsXG1oTBHGK8X0G9XCIAXKJ","818I9lKL9HKL8lGK7X8H6l4G6X4G6l0H6WwH6GwG6X0H6X0G7X8H7X8I714H7H4H710H60wG5ksF5WoE5WoE5ksF5ksF60wG5WsF5ksF60wG60sF60wF6GwG6X0G6H0E6H0E610F60wF60wF6H0F6X0F7H4H8H8I8XCJ818I7H4H818I8HCJ9lKLAXSM9XOL7lCK7XCJ7lCJ7lCJ7XCK7X8K7H4J7H8K7lCK9lSNBlgRClkRC1.QB1WPAXONBHONClcPAlSN8lKLAlSOBXWPCX.PDXcQBlWOAlSOAlSOBHSOBl.QCH.RG1wZFHwZEXwZEXsZF1w.EXsXD1kVClgVBlcSBl.TAlWP9lKL8l8I9X8J7WwE7GwE8X4GA1GIA1CI","8HCJ7l8I7X8I7H4H6X0G6l4H714H714H6l4I7l8J8lGK8XCJ8XCJ8lCJ9XKK81CI60sF5WoE5WoE5WoE5ksF5WoE5ksF5ksF5WsE5WoE60wF5kwE5ksF610F6H0E60wE6H0F6l4G6X0F6X0G6l4H714G7H8H7l8H818H8H8I7l8I718I7H8J714I818JBlSNAlSM81CK7X8J7lCK7XCK81GK718J6l4I7H8J8HGL8lKLAHSNC1cPCHcQAXSN9XKMBlWPBl.PBXWOBX.PC1.PC1WODHcQCl.PBXWOAHOMAXONBXcQBlcREHcRIHwWGY0ZDXoXCXkVBH.RAl.RAHWR9lSO8XCJA1OM9HGK70wF70wE6WsE6kwD7H0E818F8H4G","714H6l0H6X4H6H0G6H0G7l4I91GJ91GJ9XKK9lOL9lKL8lGJ91GJAlSK8XCH60wF5WoE5WoF5WoE5ksF6GwF60wF60wF5ksE5WoE5ksF5ksE5kwE6GwF6X0F6GwE6GwF714G7H0G6l4G6l4G718H7H8H7X8I7l8I7X4H7H0H818I8lGK8XCJ7H4I6l0H9XKLC1WOBHWN9HKK8HGK7XCI8HCK8lKM8HGK7l8I8lGL8lGL8HGKAXWNClgRCH.QAlONBHSNBl.ODHcRCH.QCl.PE1cPEHgPE1gQDXgQC1cPCHcRBlcSBHWPBHWNElgQG1kSDXcRC1cQA1WQ9lSQ91KN7X0H6WwE91GJ818H6GwE6GsD6GsC6ksD6WsE6WwE6kwD"],r=["zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEmwjBuyjfzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzpDJKtEJ.zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzadeQBIohK51G.P6Hzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzztEJ.nCnCcuEZG.92WsE3nSrDpxVNzzzzzzzzzzzzzzzzzzzzqhfQmwjBngvEzzzzzzzzzzzza9YOJ.tErhvUnCnCDJKpzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzhvUrJ4lCDJKpJ4lCSrDnIohBG410M5XOpxVNzzzzzzzzzzzzfuyjBmwjCnCnEngvxFJozzzzcuEZCZ8mrhvUzzzzgvEnGK51zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzhvUr5lSNSN5lzzzzzzzzzzzzzzzzoT7HJ.tEL:PMrxzVzzzzpDJK7HoTTbPqngvEOM5XfAmgpxVNAmgfXcQ6zzzztEJ.K51GVNpxzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzztEJ.J4lCSN5lzzzzzzzzzzzzzzzzzzzzzzzzoD3GK51GRMphzzzznSrDE3WszzzzzzzznSrDE3WsbtyVI4X8zzzzzzzzfAmgE3Wszzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzznCnCD3GozzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzcA2WKL5HzzzzzzzzngvE3WsE92G.bduUzzzzrxzVFZsyTbPqzzzzpxVNnSrDngvEpxVNzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzznSrDE3WsrxzVzzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDE3WsoT7HAYcefuyjzzzzzzzzngvE10G4LLLLzzzzzzzzbtyVI4X8rxzVcuEZCnCnE3WsH4H4OM5XmwjBzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzngvEJ4lCS71knCnCngvEuyjfzzzzzzzzzzzzzzzzngvEOM5XbtyVEngvzzzzzzzzzzzzmSb951GKlCJ4zzzzlgR68Y8YI.dAG410HKL5bduUzzzzqhfQNLpTML:PnSrDzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzoT7HGoD3DJKpM5XOZcuEzzzzzzzzzzzzzzzzxFJofuyj3WsEEngvzzzzzzzzzzzzmgfABmwjzzzzxFJoTNLp0G41EZcuVNpxzzzzzzzzzzzzzzzzxFJofAmgE3Wszzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz:dQMKpDJzzzzzzzzzzzzzzzzzzzznSrD1kS7EngvzzzzzzzzzzzzngvEEngvzzzzmgfAC30kSN5lzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzb9mSEZcurhvUzzzzzzzzzzzzzzzzzzzzngvE30kCOM5XzzzzpDJKzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzduUb9IK:bduUzzzzzzzzzzzzzzzzzzzzzzzzoD3GPaParhvUpDJKJ4lCzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDE3Wszzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzkwF3AI.dVNpxzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvzzzzngvEM5XOoT7HzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzuyjfO61WR6lgzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzuyjf:dQMHKL5zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzbtyVJ.tEzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzznCnCDJKpzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDE3WszzzzzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzoT7HA2Wcfuyjzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvzzzzzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzb9mSK:9Izzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzznSrDE3WszzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvzzzzzzzzngvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzoD3GD3Go.tEJngvEngvEngvEpxVNzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzngvEEJ.tzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvzzzzuyjfngvEEZcuzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzpxVNLLLLEngvEngvEngvH4H4XcQ6zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzznCnCFJoxngvEzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvuyjf.P6HnSrDE3WszzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzoT7Hzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzpxVNLLLLKL5HnSrDngvEngvEmwjBoT7HzzzzzzzzzzzzzzzzzzzzzzzzngvEEngvfAmgEZcungvEEngvzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzoT7HHKL5xFJozzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzztEJ.VNpxE3WsEngvE3Ws0kC3TbPqzzzzzzzzzzzzzzzzzzzzzzzzngvE6lgRG410VNpxdeQaJ4lCzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEBmwjrhvUzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzcQ6XHKL5zzzzzzzzzzzzzzzzzzzzzzzzzzzzngvE1WO6FJoxpxVND3GobduUzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDE3Wszzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzpDJKAYcebduUzzzzzzzzzzzzzzzzzzzzzzzzzzzzmwjB0000VNpxngvEEngvzzzzzzzzpDJKzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzeQadFnwzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzaPaPPaPazzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzdAI.9YOazzzzngvEEZcuzzzzpDJKJoxFqhfQzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzfuyjDJKpTbPqzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzznCnCD3GozzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzlgR6AI.dDZOqpxVNeAYcFJoxzzzzoT7HKL5HNpxVoD3GzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzceAY92G.TbPqzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzatiRQM:dzzzzzzzzzzzzzzzzzzzzzzzzzzzzsE3WN:tUG410NLpTBmwjCJ4lVNpxzzzzzzzzngvEFJoxNLpTnSrDnSrDngvEngvEoT7HngvEngvEnSrDb9mSCZ8mVNpxzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDDnSrzzzzzzzzzzzzzzzzzzzzzzzzzzzzxFJoTbPqP6H.zzzznSrDDJKpGoD3zzzzzzzzzzzzzzzzuyjf.dAIDnSrE3WsEngvFnwzAYceEngvEZcuE3WsOM5XrhvUzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDE3Wszzzzzzzzzzzzzzzzzzzzzzzzzzzz:tUNML:PzzzzzzzzzzzzrxzVbduUzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzztEJ.fuyjzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzngvEEZcuzzzzzzzzzzzzzzzzzzzzzzzzaPaPHKL5rhvUzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzznSrDI4X8nSrDzzzzzzzzzzzzngvEb9mSC30klCJ4zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzrxzVR6lgLLLLnSrDngvEb9mSC30kHoT7.92Gzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzuyjf.dAIE3WsEZcuN:tUrhvUzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"];function c(t){for(var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ.:abcdefghijklmnopqrstuvwxyz",r=0,e=0;e<64;e++)t[0]==n[e]&&(r+=262144*e);for(e=0;e<64;e++)t[1]==n[e]&&(r+=4096*e);for(e=0;e<64;e++)t[2]==n[e]&&(r+=64*e);for(e=0;e<64;e++)t[3]==n[e]&&(r+=e);return[(r>>16)%256,(r>>8)%256,r%256]}function e(t){for(var n=t.length,r=Math.floor(t[0].length/4),e=new Array(n),o=0;o<n;o++)e[o]=new Array(r);for(o=0;o<n;o++)for(var i=0;i<r;i++){var a=4*i;e[o][i]=c(t[o].substring(a,a+4))}return e}this.example=function(){var t="";return 0<arguments.length&&"string"==typeof arguments[0].id&&(t=arguments[0].id),"doodle"==t?a(e(r),3):e(n)}},Plot=new function(){var z=[20,10,60,70],h=["blue","red","green","yellow","orange"],d=[],g=!1,v=0,u=0,s=0,f=0,c=0,m=0,b={},i="",p="",x=null,F="",a="",y="",M=[],_=[];function G(t,n){var r=z[1]+z[3],e=z[0]+z[2];return[z[3]+(v-r)*(t-s)/(f-s),z[0]+(u-e)*(m-n)/(m-c)]}function w(t,n){return G(t,"log"==y?Math.log(n)/Math.LN10:n)}function l(t){var n=Math.abs(t);return 100<=n?0:1<=n?1:.1<=n?2:.01<=n?3:.001<=n?4:1e-4<=n?5:1e-5<=n?6:7}function I(t,n){if(n<=t)return[t];for(var r=[],e=n-t,o=0;e<10;)e*=10,o--;for(;100<=e;)e/=10,o++;var i=(r=function(t){var n=[],r=Math.max(Math.floor(t),0);if(r<12)for(var e=1;e<=r;e+=1)n.push(e);else if(r<24)for(e=2;e<=r;e+=2)n.push(e);else if(r<60)for(e=5;e<=r;e+=5)n.push(e);else for(e=10;e<=r;e+=10)n.push(e);return n}(e))[1]-r[0];r.push(r[r.length-1]+i),r.push(r[r.length-1]+i),r.unshift(r[0]-i),r.unshift(r[0]-i);for(var a=Math.pow(10,o),l=Math.floor(t*Math.pow(10,-o)/r[0])*Math.pow(10,o)*r[0],z=0;z<r.length;z++)r[z]=r[z]*a+l;for(;r[0]<=t+.025*(n-t);)r.shift();for(;r[r.length-1]>=n-.025*(n-t);)r.pop();return r}function k(){if("log"==y){for(var t=I(s,f),n=function(t,n){var r=Math.ceil(t),e=Math.floor(n),o=[];if(e<=r)return o;for(var i=r;i<=e;i++)o.push(Math.pow(10,i));return o}(c,m),r=l(f-s),e=[],o=0;o<t.length;o++)e.push(t[o].toFixed(r));var i=[];for(o=0;o<n.length;o++)i.push("10^"+(Math.log(n[o])/Math.LN10).toFixed(0));b={x:t,y:n,xt:e,yt:i}}else{for(t=I(s,f),n=I(c,m),r=l(f-s),e=[],o=0;o<t.length;o++)e.push(t[o].toFixed(r));var a=l(m-c);for(i=[],o=0;o<n.length;o++)i.push(n[o].toFixed(a));b={x:t,y:n,xt:e,yt:i}}}function X(t,n){var r="<g>";r+='<polygon points="';for(var e=0;e<t.length;e++){var o=G(t[e][0],t[e][1]);r+=o[0].toFixed(3)+","+o[1].toFixed(3)+" "}var i=[];return r+=(i=G(t[t.length-1][0],c))[0].toFixed(3)+","+i[1].toFixed(3)+" ",r+=(i=G(t[0][0],c))[0].toFixed(3)+","+i[1].toFixed(3)+'" ',r+='style="fill:'+n+'; stroke:none; fill-opacity:0.4;" />',r+="</g>"}function A(t,n){var r="";r+='<polyline points="';for(var e=0;e<t.length;e++){var o=G(t[e][0],t[e][1]);r+=o[0].toFixed(3)+","+o[1].toFixed(3)+(e<t.length-1?" ":'" ')}return r+='style="fill:none; stroke:'+n+'; stroke-width:2.0; stroke-linecap:round; stroke-linejoin:round;" />'}function N(t,n){for(var r="<g>",e=0;e<t.length;e++){var o=G(t[e][0],t[e][1]);r+='<circle cx="'+o[0].toFixed(3)+'" cy="'+o[1].toFixed(3)+'" r="2.5" style="fill:'+n+'; stroke:none;" />'}return r+="</g>"}function n(){!function(){if(d.length<1)c=s=0,m=f=1;else{s=d[0].T[0][0],f=d[0].T[0][0],c=d[0].T[0][1],m=d[0].T[0][1],2==_.length&&(s=Math.min(s,_[0][0],_[0][1]),f=Math.max(f,_[0][0],_[0][1]),c=Math.min(c,_[1][0],_[1][1]),m=Math.max(m,_[1][0],_[1][1]));for(var t=0;t<d.length;t++)if("list"==d[t].type)for(var n=0;n<d[t].T.length;n++)s=Math.min(s,d[t].T[n][0]),f=Math.max(f,d[t].T[n][0]),c=Math.min(c,d[t].T[n][1]),m=Math.max(m,d[t].T[n][1]);var r=f-s;for(s-=.1*r,f+=.1*r,t=0;t<d.length;t++)if("func"==d[t].type)for(n=0;n<d[t].T.length;n++)s=Math.min(s,d[t].T[n][0]),f=Math.max(f,d[t].T[n][0]),c=Math.min(c,d[t].T[n][1]),m=Math.max(m,d[t].T[n][1]);var e=m-c;s==f&&(s-=1,f+=1),(c-=.1*e)==(m+=.1*e)&&(c-=1,m+=1)}}(),k();var t,n,r,e,o,i=v.toFixed(0),a=u.toFixed(0),l='<svg viewBox="0 0 '+i+" "+a+'" style="width:'+i+"px; height:"+a+'px;" xmlns="http://www.w3.org/2000/svg">';return l+=(t="",n=z[1]+z[3],r=z[0]+z[2],0!=x.opacity&&(t+='<rect x="'+z[3].toFixed(0)+'" y="'+z[0].toFixed(0)+'" width="'+(v-n).toFixed(0)+'" height="'+(u-r).toFixed(0)+'" style="fill:'+x.hex+'; stroke:none;" />'),t),l+=function(){var t="<g>";if("level"==F||"full"==F)for(var n=0;n<b.y.length;n++){var r=w(s,b.y[n]),e=w(f,b.y[n]);t+='<line x1="'+r[0].toFixed(3)+'" y1="'+r[1].toFixed(3)+'" x2="'+e[0].toFixed(3)+'" y2="'+e[1].toFixed(3)+'" style="fill:none; stroke:#d4d4d4; stroke-width:1.4; stroke-linecap:round;" />'}if("vertical"==F||"full"==F)for(n=0;n<b.x.length;n++)r=G(b.x[n],c),e=G(b.x[n],m),t+='<line x1="'+r[0].toFixed(3)+'" y1="'+r[1].toFixed(3)+'" x2="'+e[0].toFixed(3)+'" y2="'+e[1].toFixed(3)+'" style="fill:none; stroke:#d4d4d4; stroke-width:1.4; stroke-linecap:round;" />';if("crosses"==F)for(var o=0;o<b.y.length;o++)for(var i=0;i<b.x.length;i++)t+='<line x1="'+((r=w(b.x[i],b.y[o]))[0]-3).toFixed(3)+'" y1="'+r[1].toFixed(3)+'" x2="'+(r[0]+3).toFixed(3)+'" y2="'+r[1].toFixed(3)+'" style="fill:none; stroke:#d4d4d4; stroke-width:1.4; stroke-linecap:round;" />',t+='<line x1="'+r[0].toFixed(3)+'" y1="'+(r[1]-3).toFixed(3)+'" x2="'+r[0].toFixed(3)+'" y2="'+(r[1]+3).toFixed(3)+'" style="fill:none; stroke:#d4d4d4; stroke-width:1.4; stroke-linecap:round;" />';if("dots"==F)for(o=0;o<b.y.length;o++)for(i=0;i<b.x.length;i++)t+='<circle cx="'+(r=w(b.x[i],b.y[o]))[0].toFixed(3)+'" cy="'+r[1].toFixed(3)+'" r="2.5" style="fill:#d4d4d4; stroke:none;" />';return t+="</g>"}(),l+=function(){for(var t="",n=0;n<d.length;n++){var r=GlobalFunctions.get_color(d[n].color).hex;"on"==d[n].filling&&(t+=X(d[n].T,r)),"line"!=d[n].style&&"joined"!=d[n].style||(t+=A(d[n].T,r)),"dots"!=d[n].style&&"joined"!=d[n].style||(t+=N(d[n].T,r))}return t}(),l+=function(){var t="<g>",n=z[1]+z[3],r=z[0]+z[2];t+='<rect x="'+z[3].toFixed(0)+'" y="'+z[0].toFixed(0)+'" width="'+(v-n).toFixed(0)+'" height="'+(u-r).toFixed(0)+'" style="fill:none; stroke:#000000; stroke-width:2; stroke-linecap:round; stroke-linejoin:round;" />';for(var e=0;e<b.x.length;e++){var o=G(b.x[e],c),i=G(b.x[e],m);t+='<line x1="'+o[0].toFixed(3)+'" y1="'+o[1].toFixed(3)+'" x2="'+o[0].toFixed(3)+'" y2="'+(o[1]-7).toFixed(3)+'" style="fill:none; stroke:#000000; stroke-width:2; stroke-linecap:round;" />',t+='<line x1="'+i[0].toFixed(3)+'" y1="'+i[1].toFixed(3)+'" x2="'+i[0].toFixed(3)+'" y2="'+(i[1]+7).toFixed(3)+'" style="fill:none; stroke:#000000; stroke-width:2; stroke-linecap:round;" />',t+='<text x="'+o[0].toFixed(3)+'" y="'+(o[1]+20).toFixed(3)+'" style="'+p+' text-anchor:middle; fill:#000000; stroke:none;">'+b.xt[e]+"</text>"}for(e=0;e<b.y.length;e++)o=w(s,b.y[e]),i=w(f,b.y[e]),t+='<line x1="'+o[0].toFixed(3)+'" y1="'+o[1].toFixed(3)+'" x2="'+(o[0]+7).toFixed(3)+'" y2="'+o[1].toFixed(3)+'" style="fill:none; stroke:#000000; stroke-width:2; stroke-linecap:round;" />',t+='<line x1="'+i[0].toFixed(3)+'" y1="'+i[1].toFixed(3)+'" x2="'+(i[0]-7).toFixed(3)+'" y2="'+i[1].toFixed(3)+'" style="fill:none; stroke:#000000; stroke-width:2; stroke-linecap:round;" />',t+='<text x="'+(o[0]-8).toFixed(3)+'" y="'+(o[1]+4).toFixed(3)+'" style="'+p+' text-anchor:end; fill:#000000; stroke:none;">'+b.yt[e]+"</text>";return t+="</g>"}(),l+=((o="")!=M[0]&&(o+='<text x="16" y="'+(e=G(s,.5*(c+m)))[1].toFixed(0)+'" style="'+p+' text-anchor:middle; fill:#000000; stroke:none;" transform="rotate(270 16,'+e[1].toFixed(0)+')">'+M[0]+"</text>"),""!=M[1]&&(o+='<text x="'+(e=G(.5*(s+f),c))[0].toFixed(0)+'" y="'+(u-16).toFixed(0)+'" style="'+p+' text-anchor:middle; fill:#000000; stroke:none;">'+M[1]+"</text>"),o),l+="</svg>"}this.svg=function(){if(1!=g)return GlobalFunctions.set_error("Plot","svg","Plot not initialized yet.");var t="";0<arguments.length&&"string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(n()):document.getElementById(t).value=n()},this.draw=function(){if(1!=g)return GlobalFunctions.set_error("Plot","draw","Plot not initialized yet.");document.getElementById(i).innerHTML=n()},this.list=function(t){if(1!=g)return GlobalFunctions.set_error("Plot","list","Plot not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Plot","list","Invalid number of function arguments.");var n=[];if(1==GlobalFunctions.is_vector(t))for(var r=0;r<t.length;r++)n.push([r+1,t[r]]);if(1==GlobalFunctions.is_matrix(t)&&2==t[0].length)for(r=0;r<t.length;r++)n.push([t[r][0],t[r][1]]);if(0==n.length)return GlobalFunctions.set_error("Plot","list","Invalid function argument.");var e=h[d.length%h.length],o="off",i="dots";if(1<arguments.length&&(void 0!==arguments[1].color&&(e=arguments[1].color),"string"==typeof arguments[1].filling&&(o=arguments[1].filling),"string"==typeof arguments[1].style&&(i=arguments[1].style)),"log"==y)for(r=0;r<n.length;r++){if(n[r][1]<=0)return GlobalFunctions.set_error("Plot","list","Logarithmic scale not applicable for non-positive input data.");n[r][1]=Math.log(n[r][1])/Math.LN10}d.push({type:"list",T:n,color:e,filling:o,style:i})},this.func=function(t,n,r){if(1!=g)return GlobalFunctions.set_error("Plot","func","Plot not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Plot","func","Invalid number of function arguments.");if(1!=GlobalFunctions.is_function(t))return GlobalFunctions.set_error("Plot","func","Invalid function argument.");if(1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Plot","func","Invalid function argument.");if(1!=function(t,n){var r=!1;try{var e=t(n);"number"==typeof e&&1==isFinite(e)&&(r=!0)}catch(t){r=!1}return r}(t,n))return GlobalFunctions.set_error("Plot","func","Function should return a real number for all real-valued arguments.");var e=[],o=Math.min(n,r),i=Math.max(n,r),a="line";if(o==i)e.push([o,t(o)]),a="dots";else for(var l=Math.round(v),z=0;z<=l;z++){var u=(l-z)/l*o+z/l*i;e.push([u,t(u)])}var s=h[d.length%h.length],f="off";if(3<arguments.length&&(void 0!==arguments[3].color&&(s=arguments[3].color),"string"==typeof arguments[3].filling&&(f=arguments[3].filling)),"log"==y)for(var c=0;c<e.length;c++){if(e[c][1]<=0)return GlobalFunctions.set_error("Plot","func","Logarithmic scale not applicable for non-positive input data.");e[c][1]=Math.log(e[c][1])/Math.LN10}d.push({type:"func",T:e,color:s,filling:f,style:a})},this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Plot","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Plot","init","Invalid function argument.");if(i="",p="font-size:14px; font-family:sans-serif;",x=GlobalFunctions.get_color("#f6f6f6"),F="level",a="on",M=[y="",""],_=[],2<arguments.length&&("string"==typeof arguments[2].div&&(i=arguments[2].div),"string"==typeof arguments[2].font&&(p=arguments[2].font),void 0!==arguments[2].background&&(x=GlobalFunctions.get_color(arguments[2].background)),"string"==typeof arguments[2].grid&&(F=arguments[2].grid),"string"==typeof arguments[2].scaling&&(a=arguments[2].scaling),"string"==typeof arguments[2].scale&&(y=arguments[2].scale),"string"==typeof arguments[2].axis&&(M[0]=arguments[2].axis),"object"==typeof arguments[2].axis&&2==arguments[2].axis.length&&"string"==typeof arguments[2].axis[0]&&"string"==typeof arguments[2].axis[1]&&(M=arguments[2].axis),"object"==typeof arguments[2].range&&1==GlobalFunctions.is_matrix(arguments[2].range))){var r=arguments[2].range;2==r.length&&2==r[0].length&&(_=[[r[0][0],r[0][1]],[r[1][0],r[1][1]]])}if(d=[],""==i||1!=GlobalFunctions.is_div(i)){var e=document.createElement("div");""==i&&(i="random-id-"+(1e10*Math.random()).toFixed(0)),e.setAttribute("id",i),document.body.appendChild(e)}document.getElementById(i).style.textAlign="center",document.getElementById(i).innerHTML="",function(t,n){var r=z[1]+z[3],e=z[0]+z[2];if(v=Math.max(r+20,Math.round(t)),u=Math.max(e+20,Math.round(n)),"off"!=a){var o="random-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(i).innerHTML='<div id="'+o+'" style="height:2000px; padding:0; margin:0;"></div>',(v=Math.max(r+20,Math.min(t,Math.round(document.getElementById(o).clientWidth))))<t&&(u=Math.max(e+20,Math.round(u*v/t)))}}(t,n),g=!0},this.clear=function(){d=[]}},Plot3d=new function(){var n,l,e=["blue","red","green","yellow","orange"],f=[],z=[],o=!1,u=0,s=0,i=-1,r="",c=null,a="",h=1;function d(){for(var t=[],n=0;n<z.length;n++)t.push(GlobalFunctions.get_color(z[n]).hex);l.beginPath(),l.rect(0,0,u,s),l.fillStyle=c,l.fill();for(var r,e,o=function(){for(var t=[],n=Math.cos(h*time()),r=Math.sin(h*time()),e=0;e<f.length;e++)t.push([n*f[e][0]-r*f[e][2],f[e][1],r*f[e][0]+n*f[e][2]]);var o=[],i=Math.cos(-.3),a=Math.sin(-.3);for(e=0;e<t.length;e++)o.push([t[e][0],i*t[e][1]-a*t[e][2],a*t[e][1]+i*t[e][2]]);var l,z,u=[0,0,-100],s=[u[0],i*u[1]-a*u[2],a*u[1]+i*u[2]];for(e=0;e<o.length;e++)o[e].push((l=s,z=o[e],(l[0]-z[0])*(l[0]-z[0])+(l[1]-z[1])*(l[1]-z[1])+(l[2]-z[2])*(l[2]-z[2])));for(e=0;e<o.length;e++)o[e].push(f[e][3]);return o.sort(function(t,n){return n[3]-t[3]}),o}(),i=0;i<o.length;i++){var a=(r=o[i][0],e=o[i][1],[u*(.5+.3*r),s*(.5-.3*e)]);l.beginPath(),l.arc(a[0],a[1],2.5,0,2*Math.PI),l.fillStyle=t[o[i][4]],l.fill()}}this.loop_plot3d=function(){d()},this.draw=function(){return 1!=o?GlobalFunctions.set_error("Plot3d","draw","Plot3d not initialized yet."):-1!=i?GlobalFunctions.set_error("Plot3d","draw","Animation already running. No second one allowed."):f.length<1?GlobalFunctions.set_error("Plot3d","draw","No data defined yet."):(function(){for(var t=[f[0][0],f[0][1],f[0][2]],n=[f[0][0],f[0][1],f[0][2]],r=0;r<f.length;r++)for(var e=0;e<3;e++)t[e]=Math.min(t[e],f[r][e]),n[e]=Math.max(n[e],f[r][e]);var o=[];for(e=0;e<3;e++)o.push((n[e]+t[e])/2);var i=Math.max(n[0]-t[0],n[1]-t[1],n[2]-t[2])/2;for(i<=0&&(i=1),r=0;r<f.length;r++)for(e=0;e<3;e++)f[r][e]-=o[e];for(r=0;r<f.length;r++)for(e=0;e<3;e++)f[r][e]/=i}(),t="cid"+(1e10*Math.random()).toFixed(0),document.getElementById(r).innerHTML='<canvas id="'+t+'" width="'+u+'" height="'+s+'"></canvas>',n=document.getElementById(t),l=n.getContext("2d"),d(),void(i=setInterval(this.loop_plot3d,25)));var t},this.list=function(t){if(1!=o)return GlobalFunctions.set_error("Plot3d","list","Plot3d not initialized yet.");if(-1!=i)return GlobalFunctions.set_error("Plot3d","list","Animation already running. No more data allowed.");if(arguments.length<1)return GlobalFunctions.set_error("Plot3d","list","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t)||3!=t[0].length)return GlobalFunctions.set_error("Plot3d","list","Invalid function argument.");var n=e[z.length%e.length];1<arguments.length&&void 0!==arguments[1].color&&(n=arguments[1].color);for(var r=0;r<t.length;r++)f.push([t[r][0],t[r][1],t[r][2],z.length]);z.push(n)},this.init=function(t){if(-1!=i)return GlobalFunctions.set_error("Plot3d","init","Animation already running. No second one allowed.");if(arguments.length<1)return GlobalFunctions.set_error("Plot3d","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Plot3d","init","Invalid function argument.");if(r="",c="#f6f6f6",a="on",(h=1)<arguments.length&&("string"==typeof arguments[1].div&&(r=arguments[1].div),void 0!==arguments[1].background&&(c=GlobalFunctions.get_color(arguments[1].background).hex),"string"==typeof arguments[1].scaling&&(a=arguments[1].scaling),"number"==typeof arguments[1].velocity&&(h=Math.abs(arguments[1].velocity))),""==r||1!=GlobalFunctions.is_div(r)){var n=document.createElement("div");""==r&&(r="plot3d"+(1e10*Math.random()).toFixed(0)),n.setAttribute("id",r),document.body.appendChild(n)}document.getElementById(r).style.textAlign="center",document.getElementById(r).innerHTML="",function(t){if(u=Math.max(100,Math.round(t)),"off"!=a){var n="rid"+(1e10*Math.random()).toFixed(0);document.getElementById(r).innerHTML='<div id="'+n+'" style="height:2000px; padding:0; margin:0;"></div>',u=Math.min(u,Math.round(document.getElementById(n).clientWidth)),document.getElementById(r).innerHTML=""}s=Math.round(u/1.2)}(t),f=[],z=[],o=!0}},PrincipalComponents=new function(){var g=!1,v=[],m=[],b=[];this.compute=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("PrincipalComponents","compute","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("PrincipalComponents","compute","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("PrincipalComponents","compute","Invalid function argument.");var r=t.length,e=t[0].length;if(e<2||r<2)return GlobalFunctions.set_error("PrincipalComponents","compute","Insufficient data. At least two datasets and two variables needed.");var o=Math.max(1,Math.min(Math.round(n),e));v=[];for(var i=0;i<e;i++){for(var a=0,l=0;l<r;l++)a+=t[l][i];v.push(a/r)}var z=[];for(l=0;l<r;l++){z.push([]);for(i=0;i<e;i++)z[l].push(t[l][i]-v[i])}var u=LinearAlgebra.mult(LinearAlgebra.transpose(z),z);if("string"==typeof u)return GlobalFunctions.set_error("PrincipalComponents","compute","Unexpected failure.");for(l=0;l<e;l++)for(i=0;i<e;i++)u[l][i]/=r-1;var s=LinearAlgebra.svd(u);if("string"==typeof s)return GlobalFunctions.set_error("PrincipalComponents","compute","Unexpected failure.");m=[],b=[];for(var f=0;f<o;f++)m.push(s.V[f]),b.push(s.S[f][f]);var c=[];for(l=0;l<r;l++)c.push(LinearAlgebra.mult(m,z[l]));g=!0;var h="off";if(2<arguments.length&&"string"==typeof arguments[2].explained_variance&&(h=arguments[2].explained_variance),"on"==h){var d=[[1,s.S[0][0]]];for(i=1;i<e;i++)d.push([i+1,d[i-1][1]+s.S[i][i]]);for(i=0;i<e;i++)d[i][1]/=d[e-1][1];Plot.init(560,320,{axis:["cumulative explained variance","number of components (variables)"]}),Plot.list(d,{style:e<64?"joined":"line"}),Plot.draw()}return{Q:m,v:b,R:c}},this.transform=function(t){return 1!=g?GlobalFunctions.set_error("PrincipalComponents","transform","PrincipalComponents not initialized yet."):arguments.length<1?GlobalFunctions.set_error("PrincipalComponents","transform","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("PrincipalComponents","transform","Invalid function argument."):t.length!=v.length?GlobalFunctions.set_error("PrincipalComponents","transform","Invalid function argument."):LinearAlgebra.mult(m,LinearAlgebra.sub(t,v))},this.inverse=function(t){return 1!=g?GlobalFunctions.set_error("PrincipalComponents","inverse","PrincipalComponents not initialized yet."):arguments.length<1?GlobalFunctions.set_error("PrincipalComponents","inverse","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("PrincipalComponents","inverse","Invalid function argument."):t.length!=m.length?GlobalFunctions.set_error("PrincipalComponents","inverse","Invalid function argument."):LinearAlgebra.add(LinearAlgebra.mult(LinearAlgebra.transpose(m),t),v)}},RandomForest=new function(){var z=!1,u=0,s=0,a=[],l=[];function f(t,n){var r=[255,255,255,0];if(0<n){var e=GlobalFunctions.get_color("blue").rgba;r=[e[0],e[1],e[2],Math.round(200*t/n)]}return r}function c(t){if("object"!=typeof t||t.length<2)return-1;for(var n=0,r=0,e=0;e<t.length;e++){if("object"!=typeof t[e].input||"number"!=typeof t[e].index)return-1;if(1!=GlobalFunctions.is_vector(t[e].input))return-1;if(0==e&&(n=Math.max(1,t[e].input.length)),t[e].input.length!=n)return-1;if(t[e].index<0)return-1;r=Math.max(r,Math.round(t[e].index))}return r+1}function h(t){for(var n=[],r=0;r<u;r++)n.push(0);for(var e=0;e<a.length;e++)n[DecisionTree.evaluate_tree(a[e],t)]+=l[e];var o=0,i=n[o];for(r=1;r<n.length;r++)n[r]>i&&(i=n[r],o=r);return o}this.init=function(t){if(z=!1,arguments.length<1)return GlobalFunctions.set_error("RandomForest","init","Invalid number of function arguments.");var n=c(t);if(n<1)return GlobalFunctions.set_error("RandomForest","init","Invalid function argument.");var r=23,e=256,o="off";1<arguments.length&&("number"==typeof arguments[1].trees&&(r=Math.max(1,Math.round(arguments[1].trees))),"number"==typeof arguments[1].max_depth&&(e=Math.max(1,Math.min(Math.round(arguments[1].max_depth),256))),"string"==typeof arguments[1].boosting&&(o=arguments[1].boosting)),u=n,s=t[0].input.length,a=[];for(var i=0;i<r;i++)a.push(DecisionTree.random_decision_tree(t,e));l=[];for(i=0;i<r;i++)l.push(1);"on"==o&&function(t){for(var n=[],r=0;r<a.length;r++){for(var e=0,o=0;o<t.length;o++)DecisionTree.evaluate_tree(a[r],t[o].input)==t[o].index&&e++;n.push(e)}var i=0;for(r=0;r<n.length;r++)i=Math.max(i,n[r]);for(r=0;r<l.length;r++)l[r]=Math.pow(n[r]/i,4)}(t),z=!0},this.evaluate=function(t){return 1!=z?GlobalFunctions.set_error("RandomForest","evaluate","RandomForest not initialized yet."):arguments.length<1?GlobalFunctions.set_error("RandomForest","evaluate","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("RandomForest","evaluate","Invalid function argument."):t.length!=s?GlobalFunctions.set_error("RandomForest","evaluate","Improper dimension of function input data."):h(t)},this.test=function(t){if(1!=z)return GlobalFunctions.set_error("RandomForest","test","RandomForest not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("RandomForest","test","Invalid number of function arguments.");var n=c(t);if(n<1||n!=u)return GlobalFunctions.set_error("RandomForest","test","Invalid function argument.");if(t[0].input.length!=s)return GlobalFunctions.set_error("RandomForest","test","Invalid function argument.");for(var r=0,e=0;e<t.length;e++)h(t[e].input)==t[e].index&&r++;return r},this.confusion_matrix=function(t){if(1!=z)return GlobalFunctions.set_error("RandomForest","confusion_matrix","RandomForest not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("RandomForest","confusion_matrix","Invalid number of function arguments.");var n=c(t);if(n<1||n!=u)return GlobalFunctions.set_error("RandomForest","confusion_matrix","Invalid function argument.");if(t[0].input.length!=s)return GlobalFunctions.set_error("RandomForest","confusion_matrix","Invalid function argument.");for(var r=u,e=[],o=0;o<r;o++){e.push([]);for(var i=0;i<r;i++)e[o].push(0)}for(var a=0;a<t.length;a++)e[t[a].index][h(t[a].input)]++;var l="off";return 1<arguments.length&&"string"==typeof arguments[1].display&&(l=arguments[1].display),"on"==l&&function(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.pow(t[e][o],.64));for(Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"}),Sketch.box(n/2,n/2,n,{fill:"#fafafa"}),e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:f(Math.pow(t[e][o],.64),r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(0));Sketch.draw()}(e),e}},Sketch=new function(){var z=null,u=0,s=0,f=0,c=0,h=0,d=0,g="",v="",m="",b=!1,p=1;function x(t,n){return{x:p*(t-f),y:s-p*(n-h)}}function F(t,n){var r='transform="translate('+t.x.toFixed(3)+" "+t.y.toFixed(3)+")";return 0!=n&&(r+=" rotate("+(180*n/Math.PI).toFixed(3)+")"),r+='"'}function y(t,n){var r="fill:none;";0!=t.opacity&&(r="fill:"+t.hex+";",r+=t.opacity<1?" fill-opacity:"+t.opacity.toFixed(3)+";":"");var e="stroke:none;";return 0!=n.opacity&&(e="stroke:"+n.hex+"; stroke-width:2.0; stroke-linejoin:round; stroke-linecap:round;",e+=n.opacity<1?" stroke-opacity:"+n.opacity.toFixed(3)+";":""),'style="'+r+" "+e+'"'}function l(t){var n=function(t){for(var n=t[0].x,r=t[0].x,e=t[0].y,o=t[0].y,i=1;i<t.length;i++)n=Math.min(n,t[i].x),r=Math.max(r,t[i].x),e=Math.min(e,t[i].y),o=Math.max(o,t[i].y);return{xmin:n,xmax:r,ymin:e,ymax:o}}(t);return{x:(n.xmin+n.xmax)/2,y:(n.ymin+n.ymax)/2}}function n(){var t=u.toFixed(0),n=s.toFixed(0),r='<svg viewBox="0 0 '+t+" "+n+'" style="width:'+t+"px; height:"+n+'px;" xmlns="http://www.w3.org/2000/svg">';return 0!=z.opacity&&(r+='<rect x="0" y="0" width="'+u.toFixed(0)+'" height="'+s.toFixed(0)+'" ',r+='style="fill:'+z.hex+"; ",r+=z.opacity<1?"fill-opacity:"+z.opacity.toFixed(3)+"; ":"",r+='stroke:none;" />'),r+=m,r+="</svg>"}this.draw=function(){if(1!=b)return GlobalFunctions.set_error("Sketch","draw","Sketch not initialized yet.");document.getElementById(g).innerHTML=n()},this.svg=function(){if(1!=b)return GlobalFunctions.set_error("Sketch","svg","Sketch not initialized yet.");var t="";0<arguments.length&&"string"==typeof arguments[0].textarea&&(t=arguments[0].textarea),""==t||1!=GlobalFunctions.is_textarea(t)?Console.print(n()):document.getElementById(t).value=n()},this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Sketch","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t)||2!=t.length)return GlobalFunctions.set_error("Sketch","init","Invalid function argument.");if(1!=GlobalFunctions.is_vector(n)||2!=n.length)return GlobalFunctions.set_error("Sketch","init","Invalid function argument.");var r=480,e="none",o="on",i="",a="font-size:14px; font-family:sans-serif;";if(2<arguments.length&&("number"==typeof arguments[2].width&&(r=Math.max(2,Math.round(arguments[2].width))),void 0!==arguments[2].background&&(e=arguments[2].background),"string"==typeof arguments[2].scaling&&(o=arguments[2].scaling),"string"==typeof arguments[2].div&&(i=arguments[2].div),"string"==typeof arguments[2].font&&(a=arguments[2].font)),v=a,""==i||1!=GlobalFunctions.is_div(i)){var l=document.createElement("div");""==i&&(i="random-id-"+(1e10*Math.random()).toFixed(0)),l.setAttribute("id",i),document.body.appendChild(l)}g=i,f=Math.min(t[0],t[1]),c=Math.max(t[0],t[1]),h=Math.min(n[0],n[1]),d=Math.max(n[0],n[1]),c<=f&&(c+=1),d<=h&&(d+=1),z=GlobalFunctions.get_color(e),function(t,n){if(u=t,"off"!=n){var r="random-id-"+(1e10*Math.random()).toFixed(0);document.getElementById(g).innerHTML='<div id="'+r+'" style="height:2000px; padding:0; margin:0;"></div>',u=Math.min(t,Math.round(document.getElementById(r).clientWidth))}var e=c-f,o=d-h;s=Math.round(u*(o/e)),p=u/e}(r,o),document.getElementById(g).style.textAlign="center",document.getElementById(g).innerHTML="",b=!(m="")},this.clear=function(){if(1!=b)return GlobalFunctions.set_error("Sketch","clear","Sketch not initialized yet.");m=""},this.circle=function(t,n,r){if(1!=b)return GlobalFunctions.set_error("Sketch","circle","Sketch not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Sketch","circle","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Sketch","circle","Invalid function argument.");var e=GlobalFunctions.get_color("black"),o=GlobalFunctions.get_color("none");if(3<arguments.length&&(void 0!==arguments[3].fill&&(e=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(o=GlobalFunctions.get_color(arguments[3].stroke))),0==e.opacity&&0==o.opacity)return!1;var i=x(t,n),a=Math.abs(r*p);m+="<circle ",m+='cx="'+i.x.toFixed(3)+'" cy="'+i.y.toFixed(3)+'" r="'+a.toFixed(3)+'" ',m+=y(e,o)+" />"},this.dot=function(t,n){if(1!=b)return GlobalFunctions.set_error("Sketch","dot","Sketch not initialized yet.");if(arguments.length<2)return GlobalFunctions.set_error("Sketch","dot","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Sketch","dot","Invalid function argument.");var r=GlobalFunctions.get_color("black"),e=GlobalFunctions.get_color("none");if(2<arguments.length&&(void 0!==arguments[2].fill&&(r=GlobalFunctions.get_color(arguments[2].fill)),void 0!==arguments[2].stroke&&(e=GlobalFunctions.get_color(arguments[2].stroke))),0==r.opacity&&0==e.opacity)return!1;var o=x(t,n);m+="<circle ",m+='cx="'+o.x.toFixed(3)+'" cy="'+o.y.toFixed(3)+'" r="'+2.5.toFixed(3)+'" ',m+=y(r,e)+" />"},this.box=function(t,n,r){if(1!=b)return GlobalFunctions.set_error("Sketch","box","Sketch not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Sketch","box","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Sketch","box","Invalid function argument.");var e=GlobalFunctions.get_color("black"),o=GlobalFunctions.get_color("none"),i=0;if(3<arguments.length&&(void 0!==arguments[3].fill&&(e=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(o=GlobalFunctions.get_color(arguments[3].stroke)),"number"==typeof arguments[3].angle&&(i=arguments[3].angle)),0==e.opacity&&0==o.opacity)return!1;var a=x(t,n),l=Math.abs(r*p);m+="<rect "+F(a,i)+" ",m+='x="'+(-l/2).toFixed(3)+'" y="'+(-l/2).toFixed(3)+'" width="'+l.toFixed(3)+'" height="'+l.toFixed(3)+'" ',m+=y(e,o)+" />"},this.rect=function(t,n,r,e){if(1!=b)return GlobalFunctions.set_error("Sketch","rect","Sketch not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Sketch","rect","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Sketch","rect","Invalid function argument.");var o=GlobalFunctions.get_color("black"),i=GlobalFunctions.get_color("none"),a=0;if(4<arguments.length&&(void 0!==arguments[4].fill&&(o=GlobalFunctions.get_color(arguments[4].fill)),void 0!==arguments[4].stroke&&(i=GlobalFunctions.get_color(arguments[4].stroke)),"number"==typeof arguments[4].angle&&(a=arguments[4].angle)),0==o.opacity&&0==i.opacity)return!1;var l=x(t,n),z=Math.abs(r*p),u=Math.abs(e*p);m+="<rect "+F(l,a)+" ",m+='x="'+(-z/2).toFixed(3)+'" y="'+(-u/2).toFixed(3)+'" width="'+z.toFixed(3)+'" height="'+u.toFixed(3)+'" ',m+=y(o,i)+" />"},this.line=function(t,n,r,e){if(1!=b)return GlobalFunctions.set_error("Sketch","line","Sketch not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Sketch","line","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Sketch","line","Invalid function argument.");var o=GlobalFunctions.get_color("none"),i=GlobalFunctions.get_color("black");if(4<arguments.length&&void 0!==arguments[4].stroke&&(i=GlobalFunctions.get_color(arguments[4].stroke)),0==o.opacity&&0==i.opacity)return!1;var a=x(t,n),l=x(r,e);m+='<line x1="'+a.x.toFixed(3)+'" y1="'+a.y.toFixed(3)+'" x2="'+l.x.toFixed(3)+'" y2="'+l.y.toFixed(3)+'" ',m+=y(o,i)+" />"},this.polygon=function(t){if(1!=b)return GlobalFunctions.set_error("Sketch","polygon","Sketch not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Sketch","polygon","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Sketch","polygon","Invalid function argument.");if(t.length<3)return GlobalFunctions.set_error("Sketch","polygon","At least three points required.");if(2!=t[0].length)return GlobalFunctions.set_error("Sketch","polygon","Invalid function argument.");var n=GlobalFunctions.get_color("black"),r=GlobalFunctions.get_color("none"),e=0;if(1<arguments.length&&(void 0!==arguments[1].fill&&(n=GlobalFunctions.get_color(arguments[1].fill)),void 0!==arguments[1].stroke&&(r=GlobalFunctions.get_color(arguments[1].stroke)),"number"==typeof arguments[1].angle&&(e=arguments[1].angle)),0==n.opacity&&0==r.opacity)return!1;for(var o=[],i=0;i<t.length;i++)o.push(x(t[i][0],t[i][1]));var a=l(o);m+="<polygon "+F(a,e)+' points="';for(i=0;i<t.length;i++)m+=(o[i].x-a.x).toFixed(3)+","+(o[i].y-a.y).toFixed(3),m+=i<t.length-1?" ":'" ';m+=y(n,r)+" />"},this.polyline=function(t){if(1!=b)return GlobalFunctions.set_error("Sketch","polyline","Sketch not initialized yet.");if(arguments.length<1)return GlobalFunctions.set_error("Sketch","polyline","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Sketch","polyline","Invalid function argument.");if(t.length<3)return GlobalFunctions.set_error("Sketch","polyline","At least three points required.");if(2!=t[0].length)return GlobalFunctions.set_error("Sketch","polyline","Invalid function argument.");var n=GlobalFunctions.get_color("none"),r=GlobalFunctions.get_color("black");if(1<arguments.length&&void 0!==arguments[1].stroke&&(r=GlobalFunctions.get_color(arguments[1].stroke)),0==n.opacity&&0==r.opacity)return!1;m+='<polyline points="';for(var e=0;e<t.length;e++){var o=x(t[e][0],t[e][1]);m+=o.x.toFixed(3)+","+o.y.toFixed(3),m+=e<t.length-1?" ":'" '}m+=y(n,r)+" />"},this.text=function(t,n,r){if(1!=b)return GlobalFunctions.set_error("Sketch","text","Sketch not initialized yet.");if(arguments.length<3)return GlobalFunctions.set_error("Sketch","text","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Sketch","text","Invalid function argument.");if(1!=GlobalFunctions.is_string(r)&&1!=GlobalFunctions.is_number(r))return GlobalFunctions.set_error("Sketch","text","Invalid function argument.");var e=GlobalFunctions.get_color("black"),o=GlobalFunctions.get_color("none"),i=0,a="middle";if(3<arguments.length&&(void 0!==arguments[3].fill&&(e=GlobalFunctions.get_color(arguments[3].fill)),void 0!==arguments[3].stroke&&(o=GlobalFunctions.get_color(arguments[3].stroke)),"number"==typeof arguments[3].angle&&(i=arguments[3].angle),"string"==typeof arguments[3].align&&("left"==arguments[3].align&&(a="start"),"right"==arguments[3].align&&(a="end"))),0==e.opacity&&0==o.opacity)return!1;var l=x(t,n),z=r;1==GlobalFunctions.is_number(r)&&(z=r.toFixed(Math.abs(r-Math.round(r))<1e-8?0:4)),m+="<text "+F(l,i)+" ",m+='x="0" y="0" ',m+=y(e,o).replace('style="','style="'+v+" text-anchor:"+a+"; dominant-baseline:middle; ")+">",m+=z+"</text>"},this.arrow=function(t,n,r,e){if(1!=b)return GlobalFunctions.set_error("Sketch","arrow","Sketch not initialized yet.");if(arguments.length<4)return GlobalFunctions.set_error("Sketch","arrow","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t)||1!=GlobalFunctions.is_number(n)||1!=GlobalFunctions.is_number(r)||1!=GlobalFunctions.is_number(e))return GlobalFunctions.set_error("Sketch","arrow","Invalid function argument.");var o=GlobalFunctions.get_color("none"),i=GlobalFunctions.get_color("black");if(4<arguments.length&&void 0!==arguments[4].stroke&&(i=GlobalFunctions.get_color(arguments[4].stroke)),0==o.opacity&&0==i.opacity)return!1;var a=x(t,n),l=x(r,e);if(m+='<line x1="'+a.x.toFixed(3)+'" y1="'+a.y.toFixed(3)+'" x2="'+l.x.toFixed(3)+'" y2="'+l.y.toFixed(3)+'" ',m+=y(o,i)+" />",(l.x-a.x)*(l.x-a.x)+(l.y-a.y)*(l.y-a.y)<1)return!1;var z=Math.atan2(a.y-l.y,l.x-a.x),u=30*Math.cos(z),s=30*Math.sin(z),f=[];f.push({x:l.x+35*Math.cos(z)-u,y:l.y-35*Math.sin(z)+s}),f.push({x:l.x+25*Math.cos(z+.15)-u,y:l.y-25*Math.sin(z+.15)+s}),f.push({x:l.x+28*Math.cos(z)-u,y:l.y-28*Math.sin(z)+s}),f.push({x:l.x+25*Math.cos(z-.15)-u,y:l.y-25*Math.sin(z-.15)+s}),m+='<polygon points="';for(var c=0;c<f.length;c++)m+=f[c].x.toFixed(3)+","+f[c].y.toFixed(3),m+=c<f.length-1?" ":'" ';m+=y(i,i)+" />"}},Split=new function(){this.train_test=function(t,n,r){if(arguments.length<3)return GlobalFunctions.set_error("Split","train_test","Invalid number of function arguments.");if("object"!=typeof t||"number"!=typeof t.length||t.length<4)return GlobalFunctions.set_error("Split","train_test","Invalid function argument.");if("number"!=typeof n||n<=0)return GlobalFunctions.set_error("Split","train_test","Invalid function argument.");if("number"!=typeof r||r<=0)return GlobalFunctions.set_error("Split","train_test","Invalid function argument.");var e=Math.floor(1e8*Math.random()),o=!0;3<arguments.length&&("number"==typeof arguments[3].seed&&(e=1e5+Math.round(Math.abs(arguments[3].seed))),"boolean"==typeof arguments[3].random&&(o=arguments[3].random));var i=t.length,a=Math.round(n/(n+r)*i);a<2&&(a=2),i-a<2&&(a=i-2);for(var l=[],z=0;z<i;z++)l.push(z);1==o&&(l=function(t,n){for(var r,e=t,o=[],i=0;i<n.length;i++)o.push(n[i]);for(var a=0;a<100;a++)for(var l=0;l<o.length;l++){var z=(r=o.length,Math.floor(Math.abs(Math.sin(e++))*r)),u=o[l];o[l]=o[z],o[z]=u}return o}(e,l));for(var u=[],s=[],f=0;f<i;f++)f<a?u.push(t[l[f]]):s.push(t[l[f]]);return{train:u,test:s}}},Statistics=new function(){function v(t){for(var n=0,r=0;r<t.length;r++)n+=t[r];return n/t.length}function m(t,n){if(1==t.length)return t[0];if(n<=0)return t[0];if(1<=n)return t[t.length-1];for(var r=[],e=0;e<t.length;e++)r.push(t[e]);r.sort(function(t,n){return t-n});var o,i=(r.length-1)*n;return 1==(o=i,Math.abs(o-Math.round(o))<1e-8)?r[Math.round(i)]:.5*(r[Math.floor(i)]+r[Math.ceil(i)])}function b(t){for(var n=v(t),r=0,e=0;e<t.length;e++){var o=t[e]-n;r+=o*o}return r/(t.length-1)}function l(t,n){for(var r=v(t),e=v(n),o=0,i=0;i<t.length;i++)o+=(t[i]-r)*(n[i]-e);return o/(t.length-1)}function z(t,n){for(var r=v(t),e=v(n),o=0,i=0;i<t.length;i++)o+=(t[i]-r)*(n[i]-e);o/=t.length-1;var a=Math.sqrt(b(t)*b(n));return 0==a?Math.sign(o):o/a}function i(t,n,r){var e,o=[0,0,0,0];0<n&&0<r&&(o=[(e=GlobalFunctions.get_color("blue").rgba)[0],e[1],e[2],Math.round(200*n/r)]);n<0&&t<0&&(o=[(e=GlobalFunctions.get_color("red").rgba)[0],e[1],e[2],Math.round(200*n/t)]);return o}function u(t){for(var n=t.length,r=0,e=0;e<n;e++)for(var o=0;o<n;o++)r=Math.max(r,Math.abs(t[e][o]));Sketch.init([-.5,n+.5],[-.5,n+.5],{width:44*(n+1),background:"lightgrey"});for(e=0;e<n;e++)for(o=0;o<n;o++)Sketch.box(o+.5,n-e-.5,1,{fill:i(-r,t[e][o],r)}),Sketch.text(o+.5,n-e-.5,t[e][o].toFixed(2));Sketch.draw()}this.mean=function(t){return arguments.length<1?GlobalFunctions.set_error("Statistics","mean","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","mean","Invalid function argument."):v(t)},this.median=function(t){return arguments.length<1?GlobalFunctions.set_error("Statistics","median","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","median","Invalid function argument."):function(t){if(1==t.length)return t[0];for(var n=[],r=0;r<t.length;r++)n.push(t[r]);if(n.sort(function(t,n){return t-n}),n.length%2==1)return n[Math.round((n.length-1)/2)];var e=Math.round(n.length/2);return.5*(n[e-1]+n[e])}(t)},this.quantile=function(t,n){return arguments.length<2?GlobalFunctions.set_error("Statistics","quantile","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","quantile","Invalid function argument."):1!=GlobalFunctions.is_number(n)?GlobalFunctions.set_error("Statistics","quantile","Invalid function argument."):m(t,n)},this.range=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","range","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Statistics","range","Invalid function argument.");for(var n=[t[0],t[0]],r=0;r<t.length;r++)n[0]=Math.min(n[0],t[r]),n[1]=Math.max(n[1],t[r]);return n},this.variance=function(t){return arguments.length<1?GlobalFunctions.set_error("Statistics","variance","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","variance","Invalid function argument."):t.length<2?GlobalFunctions.set_error("Statistics","variance","Invalid function argument."):b(t)},this.standard_deviation=function(t){return arguments.length<1?GlobalFunctions.set_error("Statistics","standard_deviation","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","standard_deviation","Invalid function argument."):t.length<2?GlobalFunctions.set_error("Statistics","standard_deviation","Invalid function argument."):Math.sqrt(b(t))},this.covariance=function(t,n){return arguments.length<2?GlobalFunctions.set_error("Statistics","covariance","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","covariance","Invalid function argument."):1!=GlobalFunctions.is_vector(n)?GlobalFunctions.set_error("Statistics","covariance","Invalid function argument."):t.length<2||t.length!=n.length?GlobalFunctions.set_error("Statistics","covariance","Invalid function argument."):l(t,n)},this.covariance_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","covariance_matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Statistics","covariance_matrix","Invalid function argument.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Statistics","covariance_matrix","Invalid function argument.");for(var n=[],r=0;r<t[0].length;r++){n.push([]);for(var e=0;e<t.length;e++)n[r].push(t[e][r])}var o=n.length,i=[];for(e=0;e<o;e++){i.push([]);for(r=0;r<o;r++)i[e].push(0)}for(e=0;e<o;e++)i[e][e]=b(n[e]);for(e=0;e<o;e++)for(r=e+1;r<o;r++)i[e][r]=l(n[e],n[r]),i[r][e]=i[e][r];var a="on";return 1<arguments.length&&"string"==typeof arguments[1].display&&(a=arguments[1].display),"on"==a&&u(i),i},this.correlation=function(t,n){return arguments.length<2?GlobalFunctions.set_error("Statistics","correlation","Invalid number of function arguments."):1!=GlobalFunctions.is_vector(t)?GlobalFunctions.set_error("Statistics","correlation","Invalid function argument."):1!=GlobalFunctions.is_vector(n)?GlobalFunctions.set_error("Statistics","correlation","Invalid function argument."):t.length<2||t.length!=n.length?GlobalFunctions.set_error("Statistics","correlation","Invalid function argument."):z(t,n)},this.correlation_matrix=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","correlation_matrix","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Statistics","correlation_matrix","Invalid function argument.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Statistics","correlation_matrix","Invalid function argument.");for(var n=[],r=0;r<t[0].length;r++){n.push([]);for(var e=0;e<t.length;e++)n[r].push(t[e][r])}var o=n.length,i=[];for(e=0;e<o;e++){i.push([]);for(r=0;r<o;r++)i[e].push(1)}for(e=0;e<o;e++)for(r=e+1;r<o;r++)i[e][r]=z(n[e],n[r]),i[r][e]=i[e][r];var a="on";return 1<arguments.length&&"string"==typeof arguments[1].display&&(a=arguments[1].display),"on"==a&&u(i),i},this.boxplot=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","boxplot","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Statistics","boxplot","Invalid function argument.");if(t.length<8)return GlobalFunctions.set_error("Statistics","boxplot","At least eight data points required.");for(var n=[],r=0;r<t.length;r++)n.push(t[r]);n.sort(function(t,n){return t-n});var e=n.length,o=0,i=[m(n,.25),m(n,.5),m(n,.75)],a=i[2]-i[0],l=[n[0],n[e-1]];for(o=0;l[0]<i[0]-1.5*a;)o++,l[0]=n[o];for(o=e-1;l[1]>i[2]+1.5*a;)o--,l[1]=n[o];var z=GlobalFunctions.get_color("blue").rgba;if(1<arguments.length&&(void 0!==arguments[1].color&&(z=GlobalFunctions.get_color(arguments[1].color).rgba),void 0!==arguments[1].range)){var u=arguments[1].range;1==GlobalFunctions.is_vector(u)&&2==u.length&&(n.push(Math.max(n[n.length-1],u[0],u[1])),n.unshift(Math.min(n[0],u[0],u[1])),e=n.length)}var s=n[e-1]-n[0];if(0==s)return Sketch.init([0,1.2],[-.25,.15],{width:480,background:"lightgrey"}),Sketch.dot(.6,0,{fill:z}),Sketch.line(.6,-.13,.6,-.15),Sketch.text(.6,-.19,n[0].toFixed(4)),void Sketch.draw();Sketch.init([n[0]-.1*s,n[e-1]+.1*s],[-.25*s,.15*s],{width:480,background:"lightgrey"}),Sketch.rect(.5*(i[0]+i[2]),0,a,.16*s,{fill:[z[0],z[1],z[2],Math.round(.5*z[3])],stroke:z}),Sketch.line(l[0],0,i[0],0,{stroke:z}),Sketch.line(l[0],.04*s,l[0],-.04*s,{stroke:z}),Sketch.line(i[2],0,l[1],0,{stroke:z}),Sketch.line(l[1],.04*s,l[1],-.04*s,{stroke:z}),Sketch.line(i[1],.08*s,i[1],-.08*s,{stroke:z});for(r=0;r<t.length;r++)(t[r]<l[0]||t[r]>l[1])&&Sketch.dot(t[r],0,{fill:z});var f,c,h=function(t,n){if(n<=t)return[t];for(var r=[],e=n-t,o=0;e<10;)e*=10,o--;for(;100<=e;)e/=10,o++;r=[];var i=Math.max(Math.floor(e),0);if(i<12)for(var a=1;a<=i;a+=1)r.push(a);else if(i<24)for(a=2;a<=i;a+=2)r.push(a);else if(i<60)for(a=5;a<=i;a+=5)r.push(a);else for(a=10;a<=i;a+=10)r.push(a);var l=r[1]-r[0];r.push(r[r.length-1]+l),r.push(r[r.length-1]+l),r.unshift(r[0]-l),r.unshift(r[0]-l);var z=Math.pow(10,o),u=Math.floor(t*Math.pow(10,-o)/r[0])*Math.pow(10,o)*r[0];for(a=0;a<r.length;a++)r[a]=r[a]*z+u;for(;r[0]<t-.05*(n-t);)r.shift();for(;r[r.length-1]>n+.05*(n-t);)r.pop();return r}(n[0],n[e-1]),d=(f=n[e-1]-n[0],100<=(c=Math.abs(f))?0:1<=c?1:.1<=c?2:.01<=c?3:.001<=c?4:1e-4<=c?5:1e-5<=c?6:7);for(r=0;r<h.length;r++)Sketch.line(h[r],-.13*s,h[r],-.15*s),Sketch.text(h[r],-.19*s,h[r].toFixed(d));Sketch.draw()},this.histogram=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","histogram","Invalid number of function arguments.");if(1!=GlobalFunctions.is_vector(t))return GlobalFunctions.set_error("Statistics","histogram","Invalid function argument.");if(t.length<8)return GlobalFunctions.set_error("Statistics","histogram","At least eight data points required.");var n="blue",r=0,e=10;if(1<arguments.length&&("number"==typeof arguments[1].bins&&(e=Math.max(2,Math.round(arguments[1].bins))),void 0!==arguments[1].color&&(n=arguments[1].color),void 0!==arguments[1].range)){var o=arguments[1].range;1==GlobalFunctions.is_vector(o)&&2==o.length&&(r=[Math.min(o[0],o[1]),Math.max(o[0],o[1])])}Chart.init(480,320,{background:"lightgrey",digits:1,color:n}),Chart.histogram(t,{bins:e,range:r,label:"absolute"}),Chart.draw()},this.explore=function(t){if(arguments.length<1)return GlobalFunctions.set_error("Statistics","explore","Invalid number of function arguments.");if(1!=GlobalFunctions.is_matrix(t))return GlobalFunctions.set_error("Statistics","explore","Invalid function argument.");if(t.length<2||t[0].length<2)return GlobalFunctions.set_error("Statistics","explore","Invalid function argument.");var n="on",r=2;1<arguments.length&&("string"==typeof arguments[1].display&&(n=arguments[1].display),"number"==typeof arguments[1].digits&&(r=Math.max(0,Math.min(arguments[1].digits,8))));for(var e,o,i=[],a=0;a<t[0].length;a++){for(var l=[],z=0;z<t.length;z++)l.push(t[z][a]);i.push((void 0,o=(e=l).length,e.sort(function(t,n){return t-n}),{count:o,mean:v(e),std:Math.sqrt(b(e)),min:e[0],p25:m(e,.25),p50:m(e,.5),p75:m(e,.75),max:e[o-1]}))}if("on"!=n)return i;var u=(150+82*(i.length-1)+30).toFixed(0),s=240..toFixed(0),f='<svg viewBox="0 0 '+u+" "+s+'" style="width:'+u+"px;height:"+s+'px;" xmlns="http://www.w3.org/2000/svg">';f+='<rect x="0" y="0" width="'+u+'" height="'+s+'" style="fill:#f6f6f6;stroke:none;" />';var c="font-size:14px;font-family:sans-serif;fill:#000000;stroke:none;font-weight:bold;",h="font-size:14px;font-family:sans-serif;fill:#000000;stroke:none;text-anchor:end;";f+='<text x="30" y="'+54..toFixed(0)+'" style="'+c+'text-anchor:start;">count</text>',f+='<text x="30" y="'+78..toFixed(0)+'" style="'+c+'text-anchor:start;">mean</text>',f+='<text x="30" y="'+102..toFixed(0)+'" style="'+c+'text-anchor:start;">std</text>',f+='<text x="30" y="'+126..toFixed(0)+'" style="'+c+'text-anchor:start;">min</text>',f+='<text x="30" y="'+150..toFixed(0)+'" style="'+c+'text-anchor:start;">p25</text>',f+='<text x="30" y="'+174..toFixed(0)+'" style="'+c+'text-anchor:start;">p50</text>',f+='<text x="30" y="'+198..toFixed(0)+'" style="'+c+'text-anchor:start;">p75</text>',f+='<text x="30" y="'+222..toFixed(0)+'" style="'+c+'text-anchor:start;">max</text>';for(a=0;a<i.length;a++)f+='<text x="'+(150+82*a).toFixed(0)+'" y="26" style="'+c+'text-anchor:end;">index.'+a.toFixed(0)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+54..toFixed(0)+'" style="'+h+'">'+i[a].count.toFixed(0)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+78..toFixed(0)+'" style="'+h+'">'+i[a].mean.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+102..toFixed(0)+'" style="'+h+'">'+i[a].std.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+126..toFixed(0)+'" style="'+h+'">'+i[a].min.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+150..toFixed(0)+'" style="'+h+'">'+i[a].p25.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+174..toFixed(0)+'" style="'+h+'">'+i[a].p50.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+198..toFixed(0)+'" style="'+h+'">'+i[a].p75.toFixed(r)+"</text>",f+='<text x="'+(150+82*a).toFixed(0)+'" y="'+222..toFixed(0)+'" style="'+h+'">'+i[a].max.toFixed(r)+"</text>";f+="</svg>";var d=document.createElement("div"),g="sid"+(1e10*Math.random()).toFixed(0);return d.setAttribute("id",g),document.body.appendChild(d),document.getElementById(g).style.textAlign="center",document.getElementById(g).innerHTML=f,i}},StopWatch=new function(){var t=0,n=0,r=!1;this.start=function(){t=Date.now(),r=!0},this.stop=function(){return 1!=r?GlobalFunctions.set_warning("StopWatch","stop","StopWatch not started yet."):(n=Date.now()-t,r=!1,n/Math.pow(10,3))},this.result=function(){return n/Math.pow(10,3)}},Webcam=new function(){var l=!1,z="",u="",s=64,f=64;function a(t){document.getElementById(z).srcObject=t,l=!0}function c(t){popup("Sorry :/ No webcam detected, access denied, or some other failure.")}this.init=function(t,n){if(arguments.length<2)return GlobalFunctions.set_error("Webcam","init","Invalid number of function arguments.");if(1!=GlobalFunctions.is_number(t))return GlobalFunctions.set_error("Webcam","init","Invalid function argument.");if(1!=GlobalFunctions.is_number(n))return GlobalFunctions.set_error("Webcam","init","Invalid function argument.");s=Math.max(8,Math.min(Math.round(t),1024)),f=Math.max(8,Math.min(Math.round(n),1024)),z="id"+(1e10*Math.random()).toFixed(0),u="id"+(1e10*Math.random()).toFixed(0);var r=document.createElement("div"),e="id"+(1e10*Math.random()).toFixed(0);r.setAttribute("id",e),document.body.appendChild(r),document.getElementById(e).style.display="none";var o="";o+='<video id="'+z+'" playsinline autoplay></video>',o+='<canvas id="'+u+'" width="'+s+'" height="'+f+'"></canvas>',document.getElementById(e).innerHTML=o;var i={audio:!1,video:{width:s,height:f,aspectRatio:1,facingMode:"user"}};navigator.mediaDevices.getUserMedia(i).then(a).catch(c)},this.get=function(){for(var t=f,n=s,r=new Array(t),e=0;e<t;e++)r[e]=new Array(n);for(e=0;e<t;e++)for(var o=0;o<n;o++)r[e][o]=[0,0,0];if(1!=l)return r;document.getElementById(u).getContext("2d").drawImage(document.getElementById(z),0,0,n,t);for(var i=document.getElementById(u).getContext("2d").getImageData(0,0,n,t),a=(e=0,o=0,0);a<i.data.length;a+=4)r[e][o][0]=i.data[a],r[e][o][1]=i.data[a+1],r[e][o][2]=i.data[a+2],++o==n&&(e++,o=0);return r},this.running=function(){return l}},VersionData=new function(){this.get=function(){return"138"},this.date=function(){return"2024-10-08-10-30"}};